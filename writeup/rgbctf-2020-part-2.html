<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>rgbCTF 2020 Writeup - Part 2 - Just Still</title>
<meta name="description" content="The journey to RGB continues!">


  <meta name="author" content="Emzi0767">
  
  <meta property="article:author" content="Emzi0767">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Just Still">
<meta property="og:title" content="rgbCTF 2020 Writeup - Part 2">
<meta property="og:url" content="https://stillu.cc/writeup/rgbctf-2020-part-2">


  <meta property="og:description" content="The journey to RGB continues!">



  <meta property="og:image" content="https://stillu.cc/assets/images/posts/rgbctf-2020-07-14/pi1-06.webp">



  <meta name="twitter:site" content="@StillAzureH">
  <meta name="twitter:title" content="rgbCTF 2020 Writeup - Part 2">
  <meta name="twitter:description" content="The journey to RGB continues!">
  <meta name="twitter:url" content="https://stillu.cc/writeup/rgbctf-2020-part-2">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://stillu.cc/assets/images/posts/rgbctf-2020-07-14/pi1-06.webp">
  

  



  <meta property="article:published_time" content="2020-07-14T00:00:00+08:00">





  

  


<link rel="canonical" href="https://stillu.cc/writeup/rgbctf-2020-part-2">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Still Hsu",
      "url": "https://stillu.cc/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Just Still Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
<link rel="manifest" href="/assets/icons/manifest.json">
<meta name="msapplication-TileColor" content="#F21368">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#F21368">
  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/avatar-512.png" alt="Just Still"></a>
        
        <a class="site-title" href="/">
          Just Still
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about">About</a>
            </li><li class="masthead__menu-item">
              <a href="/categories">Posts</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style="background-color: #000; background-image: linear-gradient(rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0.75)), url('/assets/images/posts/rgbctf-2020-07-14/pi1-06.webp');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          rgbCTF 2020 Writeup - Part 2

        
      </h1>
      
        <p class="page__lead">The journey to RGB continues!
</p>
      
      

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2020-07-14T00:00:00+08:00">July 14, 2020</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          52 minute read
        
      </span>
    
  </p>


      
      
        <p>
        
          <a href="/writeup/rgbctf-2020-part-1" class="btn btn--light-outline btn--large">Part 1</a>
        
      
    </div>
  
  
</div>




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://stillu.cc/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#writeup" itemprop="item"><span itemprop="name">Writeup</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">rgbCTF 2020 Writeup - Part 2</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="https://avatars0.githubusercontent.com/u/784448?s=460&u=62fe7c245e7df584ce3b52d69ad117a0d78209a7&v=4" alt="Emzi0767" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Emzi0767</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Experienced developer and advanced wheel reinventor.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Poland</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/Emzi0767" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="rgbCTF 2020 Writeup - Part 2">
    <meta itemprop="description" content="The journey to RGB continues!">
    <meta itemprop="datePublished" content="2020-07-14T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#prologue">Prologue</a></li><li><a href="#beginner">Beginner</a><ul><li><a href="#a-basic-challenge-50-points">A Basic Challenge (50 points)</a></li><li><a href="#pieces-50-points">Pieces (50 points)</a></li><li><a href="#rciphers-50-points">r/ciphers (50 points)</a></li></ul></li><li><a href="#cryptography">Cryptography</a><ul><li><a href="#occasionally-tested-protocol-219-points">Occasionally Tested Protocol (219 points)</a></li><li><a href="#n-aes-473-points">N-AES (473 points)</a></li></ul></li><li><a href="#forensicsosint">Forensics/OSINT</a><ul><li><a href="#pi-1-magic-in-the-air-470-points">PI 1: Magic in the air (470 points)</a></li></ul></li><li><a href="#misc">Misc</a><ul><li><a href="#laser-1---factoring-480-points">Laser 1 - Factoring (480 points)</a></li><li><a href="#laser-2---sorting-491-points">Laser 2 - Sorting (491 points)</a></li></ul></li><li><a href="#web">Web</a><ul><li><a href="#tic-tac-toe-50-points">Tic-Tac-Toe (50 points)</a></li><li><a href="#typeracer-119-points">Typeracer (119 points)</a><ul><li><a href="#bonus">Bonus</a></li></ul></li></ul></li></ul>

            </nav>
          </aside>
        
        <h2 id="prologue">Prologue</h2>

<p>This is second part of <a href="/writeup/rgbctf-2020-part-1">the rgbCTF writeup</a>, and contains information about challenges solved by me, Emzi. I strongly suggest starting with the first part of this writeup.</p>

<p>This was my first CTF event, however not the first set of challenges I solved. As I’m new, the methods outlined here might seem somewhat unsophisticated, since I am not used to working on this side of the barricade.</p>

<p>I took part thanks to Still, who asked me to co-participate in this event at the last minute. I was hesitant at first, but decided it might be an educational experience. Through solving the challenges, I learned something new, and in some cases, jogged my memory.</p>

<p>Since categories and structure were outlined in the previous post, I will only focus on the challenges I solved, as well as the methods used to reach the solution.</p>

<h2 id="beginner">Beginner</h2>

<h3 id="a-basic-challenge-50-points">A Basic Challenge (50 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <p><code class="language-plaintext highlighter-rouge">This is a nice and basic challenge.</code></p>
</blockquote>

<p>Attached was a file called <code class="language-plaintext highlighter-rouge">basic_chall.txt</code> with the following contents:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>110100 1100100 100000 110101 110100 100000 110101 111001 100000 110111 111001 100000 110100 111001 100000 110100 110100 100000 110100 110101 100000 110011 110000 100000 110100 1100101 100000 110111 111001 100000 110100 110001 100000 110111 111000 100000 110100 1100101 100000 110100 110100 100000 110100 111001 100000 110110 110111 100000 110100 1100100 100000 110101 110100 100000 110100 110001 100000 110111 1100001 100000 110100 111001 100000 110100 110100 100000 110100 110101 100000 110111 111001 100000 110100 1100101 100000 110100 110011 100000 110100 110001 100000 110111 111000 100000 110100 1100100 100000 110100 110100 100000 110101 111001 100000 110110 110111 100000 110100 1100100 100000 110101 110100 100000 110110 110011 100000 110111 1100001 100000 110100 111001 100000 110100 110100 100000 110100 110101 100000 110011 110000 100000 110100 1100100 100000 110111 111001 100000 110100 110001 100000 110011 110010 100000 110100 1100100 100000 110100 110011 100000 110100 110001 100000 110111 111000 100000 110100 1100101 100000 110101 110100 100000 110101 111001 100000 110110 110111 100000 110100 1100100 100000 110101 110100 100000 110101 110001 100000 110011 110011 100000 110100 111001 100000 110100 110100 100000 110100 110101 100000 110011 110010 100000 110100 1100100 100000 110110 111001 100000 110100 110001 100000 110011 110010 100000 110100 1100101 100000 110100 110011 100000 110100 110001 100000 110111 111000 100000 110100 1100101 100000 110110 1100001 100000 110101 110001 100000 110110 110111 100000 110100 1100100 100000 110101 110100 100000 110101 111001 100000 110111 1100001 100000 110100 111001 100000 110100 110100 100000 110100 110101 100000 110111 1100001 100000 110100 1100101 100000 110111 111001 100000 110100 110001 100000 110011 110010 100000 110100 1100100 100000 110100 110011 100000 110100 110001 100000 110111 111000 100000 110100 1100101 100000 110101 110100 100000 110101 111001 100000 110110 110111 100000 110100 1100100 100000 110101 110100 100000 110100 1100100 100000 110011 110011 100000 110100 111001 100000 110100 110100 100000 110100 110101 100000 110011 110000 100000 110100 1100100 100000 110110 111001 100000 110100 110001 100000 110011 110010 100000 110100 1100100 100000 110111 111001 100000 110100 110001 100000 110111 111000 100000 110100 1100101 100000 110101 110100 100000 110100 110101 100000 110110 110111 100000 110100 1100100 100000 110101 110100 100000 110101 110101 100000 110011 110010 100000 110100 111001 100000 110100 110100 100000 110100 110101 100000 110011 110000 100000 110100 1100101 100000 110111 111001 100000 110100 110001 100000 110111 111000 100000 110100 1100100 100000 110111 1100001 100000 110110 110011 100000 110110 110111 100000 110100 1100100 100000 110101 110100 100000 110100 110001 100000 110111 111001 100000 110100 111001 100000 110100 110100 100000 110101 111001 100000 110011 110000 100000 110100 111001 100000 110100 110100 100000 110100 110101 100000 110111 111001 100000 110100 1100100 100000 110111 111001 100000 110100 110001 100000 110111 111000 100000 110100 1100100 100000 110101 110100 100000 110100 110101 100000 110110 110111 100000 110100 1100100 100000 110101 110100 100000 110100 110001 100000 110111 1100001 100000 110100 111001 100000 110100 110100 100000 110100 110101 100000 110011 110011 100000 110100 1100101 100000 110101 110001 100000 110011 1100100 100000 110011 1100100
</code></pre></div></div>

<p>This challenge proved to be a case of not using something for so long you even forget it exists, and you will soon find out why. But let’s get going. The string in front of me is very obviously a binary-encoded string, meaning that since it’s in the Beginner category, it’s a classic multilayer decoding challenge. I think most people reading this played with various encoding tools when they were younger, so this looks like a very straightforward challenge. I fired up the python REPL and got to work. This challenge is also solvable entirely using online tools, but I figured it’s more fun this way.</p>

<p>I started off by loading the file and parsing the binary.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"basic_chall.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">t2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)]</span>
<span class="n">t2</span>
</code></pre></div></div>

<p>The result was this:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</code></pre></div></div>

<p>That’s a decimal integer array, where all integers were in range 0 ≤ x ≤ 255. Seems like plain ASCII characters to me, so I modified above snippet slightly to get a string.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t2</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">))</span>
<span class="n">t2</span>
</code></pre></div></div>

<p>This time, the output looked like this:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'4d 54 59 79 49 44 45 30 4e 79 41 78 4e 44 49 67 4d 54 41 7a 49 44 45 79 4e 43 41 78 4d 44 59 67 4d 54 63 7a 49 44 45 30 4d 79 41 32 4d 43 41 78 4e 54 59 67 4d 54 51 33 49 44 45 32 4d 69 41 32 4e 43 41 78 4e 6a 51 67 4d 54 59 7a 49 44 45 7a 4e 79 41 32 4d 43 41 78 4e 54 59 67 4d 54 4d 33 49 44 45 30 4d 69 41 32 4d 79 41 78 4e 54 45 67 4d 54 55 32 49 44 45 30 4e 79 41 78 4d 7a 63 67 4d 54 41 79 49 44 59 30 49 44 45 79 4d 79 41 78 4d 54 45 67 4d 54 41 7a 49 44 45 33 4e 51 3d 3d'</span>
</code></pre></div></div>

<p>That’s a hexadecimal string. So we’re past first layer - base2. On to decoding this one.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t3</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t2</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)]</span>
<span class="n">t3</span>
</code></pre></div></div>

<p>The result is, again, an integer array:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">61</span><span class="p">]</span>
</code></pre></div></div>

<p>Let’s modify the snippet again.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t3</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t2</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">))</span>
<span class="n">t3</span>
</code></pre></div></div>

<p>And as an output, we get a base64 string. So we’re past second layer - base16:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'MTYyIDE0NyAxNDIgMTAzIDEyNCAxMDYgMTczIDE0MyA2MCAxNTYgMTQ3IDE2MiA2NCAxNjQgMTYzIDEzNyA2MCAxNTYgMTM3IDE0MiA2MyAxNTEgMTU2IDE0NyAxMzcgMTAyIDY0IDEyMyAxMTEgMTAzIDE3NQ=='</span>
</code></pre></div></div>

<p>So far so good, let’s decode it.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span>
<span class="n">b64decode</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span>
</code></pre></div></div>

<p>After stripping the 3rd layer - base64 - we get an output which is a string of integers:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="sa">b</span><span class="s">'162 147 142 103 124 106 173 143 60 156 147 162 64 164 163 137 60 156 137 142 63 151 156 147 137 102 64 123 111 103 175'</span>
</code></pre></div></div>

<p>However, this time something about them is off, can you see it? Most of these values, if treated as decimal, then converted to characters, would produce unprintable characters, or otherwise garbled text. I tried it regardless.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">t3</span><span class="p">).</span><span class="n">decode</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">))</span>
</code></pre></div></div>

<p>And the output was, predictably, useless:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'¢</span><span class="se">\x93\x8e</span><span class="s">g|j</span><span class="se">\xad\x8f</span><span class="s">&lt;</span><span class="se">\x9c\x93</span><span class="s">¢@¤£</span><span class="se">\x89</span><span class="s">&lt;</span><span class="se">\x9c\x89\x8e</span><span class="s">?</span><span class="se">\x97\x9c\x93\x89</span><span class="s">f@{og¯'</span>
</code></pre></div></div>

<p>I decided to look through all sorts of common text encoding schemes, as well as experiment with shifting or XORing the values, but to no avail. Eventually, one of my friends noticed that the values look surprisingly like octal (base8) numbers. So let’s try it.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">t3</span><span class="p">).</span><span class="n">decode</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">))</span>
</code></pre></div></div>

<p>And indeed, after stripping the 4th layer of encoding, we get our flag as the output:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'rgbCTF{c0ngr4ts_0n_b3ing_B4SIC}'</span>
</code></pre></div></div>

<p>The irony in this is that octal is an encoding a lot of UNIX people use frequently without realizing it (<code class="language-plaintext highlighter-rouge">chmod</code> permission flags are octal, for instance), yet it never occurred to me that it could be something as simple and trivial as this.</p>

<p>Flag:
<code class="language-plaintext highlighter-rouge">rgbCTF{c0ngr4ts_0n_b3ing_B4SIC}</code></p>

<h3 id="pieces-50-points">Pieces (50 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <p><code class="language-plaintext highlighter-rouge">My flag has been divided into pieces :( Can you recover it for me?</code></p>
</blockquote>

<p>Attached was a file called <code class="language-plaintext highlighter-rouge">Main.java</code> with the following contents:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="nc">BufferedReader</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">));</span>
		<span class="nc">String</span> <span class="n">input</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">divide</span><span class="o">(</span><span class="n">input</span><span class="o">).</span><span class="na">equals</span><span class="o">(</span><span class="s">"9|2/9/:|4/7|8|4/2/1/2/9/"</span><span class="o">))</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Congratulations! Flag: rgbCTF{"</span> <span class="o">+</span> <span class="n">input</span> <span class="o">+</span> <span class="s">"}"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Incorrect, try again."</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">divide</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">String</span> <span class="n">ans</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">text</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="n">ans</span> <span class="o">+=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)(</span><span class="n">text</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>
			<span class="n">ans</span> <span class="o">+=</span> <span class="n">text</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="s">"|"</span> <span class="o">:</span> <span class="s">"/"</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">ans</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Analysis of the code reveals that the flag contents have been encoded. The process took every character, halved its ASCII value, and wrote the resulting character out, then appdended either <code class="language-plaintext highlighter-rouge">|</code> or <code class="language-plaintext highlighter-rouge">/</code>, depending on whether the character’s value was divisible by 2 or not. In effect, each character was encoded as a pair of <code class="language-plaintext highlighter-rouge">(div 2, mod 2)</code>.</p>

<p>Reversing this process was simple, and I decided to use C# to achieve this. My program simply took each character pair, multiplied the ASCII value of the first character of each pair by 2, then added 1 if the other character was equal to <code class="language-plaintext highlighter-rouge">/</code>. The source code of the entrypoint of the program can be found below.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">str</span> <span class="p">=</span> <span class="s">"9|2/9/:|4/7|8|4/2/1/2/9/"</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">sts</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">AsSpan</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">str</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span> <span class="p">+=</span> <span class="m">2</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">addone</span> <span class="p">=</span> <span class="n">sts</span><span class="p">[</span><span class="n">i</span> <span class="p">+</span> <span class="m">1</span><span class="p">]</span> <span class="p">==</span> <span class="sc">'/'</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">ch</span> <span class="p">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)((</span><span class="n">sts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">*</span> <span class="m">2</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="n">addone</span> <span class="p">?</span> <span class="m">1</span> <span class="p">:</span> <span class="m">0</span><span class="p">));</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>When ran, the program spit out the string <code class="language-plaintext highlighter-rouge">restinpieces</code>.</p>

<p>Flag: 
<code class="language-plaintext highlighter-rouge">rgbCTF{restinpieces}</code></p>

<h3 id="rciphers-50-points">r/ciphers (50 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RGBsec does not endorse (or really even know at this point) what the content is on that sub reddit.
(It's just the title of the challenge)
</code></pre></div>  </div>
</blockquote>

<p>Attached was a file called <code class="language-plaintext highlighter-rouge">11.txt</code> with the following contents:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Nfwp wp z hkakzudfzoinwj plopnwnlnwka jwdfix, yfwjf jza oi znnzjgit ywnf mxicliajs zazuspwp. Zunfklqf nfwp znnzjg jza oi tkai os fzat, wn'p lplzuus hljf izpwix nk lpi z dxkqxzh nk tk wn mkx skl. Nyk qkkt yiopwnip nfzn ywuu tijxsdn plopnwnlnwka jwdfixp mkx skl zxi zn qlozuuz.ti/plopnwnlnwka-pkuvix zat clwdcwld.jkh. Wm skl fzvia'n nxwit nfih oimkxi, skl pfklut jfijg nfih kln. Fixi'p sklx muzq: xqoJNM{blpn_4pg_nf3_wan3xa3n_n0_t3jxsdn_wn}
Zupk, Zuij oiuwivip wn'p vixs whdkxnzan nfzn skl pii nfwp: fnndp://w.xitt.wn/1d7y8g0272851.bdq
</code></pre></div></div>

<p>The challenge looked like a simple substitution cipher challenge, so my first thought was to find patterns, perform some frequency analysis, then get cracking.</p>

<p>One thing I noticed right off the bat is that only letters were substituted, digits and other characters were left alone. Since the title of the challenge is reddit-related, so the first thing that stood out to me, was this: <code class="language-plaintext highlighter-rouge">fnndp://w.xitt.wn/1d7y8g0272851.bdq</code>. It’s obviously an <code class="language-plaintext highlighter-rouge">i.redd.it</code> link, which makes <code class="language-plaintext highlighter-rouge">.bdq</code> its extension. It’s an image, so it’s either <code class="language-plaintext highlighter-rouge">.gif</code>, <code class="language-plaintext highlighter-rouge">.png</code>, or <code class="language-plaintext highlighter-rouge">.jpg</code>. Another part of the URL, <code class="language-plaintext highlighter-rouge">fnndp://</code> was clearly <code class="language-plaintext highlighter-rouge">https://</code>, meaning that combined with knowing the domain, we now have some letters for the alphabet:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefghijklmnopqrstuvwxyz    original
   ti  fw      d xpn          substituted
</code></pre></div></div>

<p>Looking at this, we notice that <code class="language-plaintext highlighter-rouge">d</code> maps to <code class="language-plaintext highlighter-rouge">p</code>, so <code class="language-plaintext highlighter-rouge">bdq</code> is <code class="language-plaintext highlighter-rouge">_p_</code>. Of the 3 suspect extensions, jpg is the only match, so we now add 2 more letters:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefghijklmnopqrstuvwxyz    original
   ti qfwb     d xpn          substituted
</code></pre></div></div>

<p>Next piece of interest is the flag: <code class="language-plaintext highlighter-rouge">xqoJNM{blpn_4pg_nf3_wan3xa3n_n0_t3jxsdn_wn}</code>. We know it’s in the standard format (<code class="language-plaintext highlighter-rouge">rgbCTF{flag}</code>), so we can map more letters. As this looks like a simple substitution cipher, I assumed that different case of the same letter maps the same, and thus we add the following to our alphabet:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefghijklmnopqrstuvwxyz    original
 ojtimqfwb     d xpn          substituted
</code></pre></div></div>

<p>At this stage, we can perform partial reconstruction of the flag: <code class="language-plaintext highlighter-rouge">rgbCTF{j st_4s _th3_i t3r 3t_t0_d3cr pt_it}</code>. Obvious standout here is the second to last word of the flag, <code class="language-plaintext highlighter-rouge">d3cr pt</code>, as well as the first, <code class="language-plaintext highlighter-rouge">j st</code>. With these 2, we can deduce 2 more letters:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefghijklmnopqrstuvwxyz    original
 ojtimqfwb     d xpnl   s     substituted
</code></pre></div></div>

<p>There are 2 more domains in the text: <code class="language-plaintext highlighter-rouge">qlozuuz.ti/plopnwnlnwka-pkuvix</code> and <code class="language-plaintext highlighter-rouge">clwdcwld.jkh</code>. Decoding the first one yields <code class="language-plaintext highlighter-rouge">gub    .de/substituti  -s   er</code>, while the second one yields <code class="language-plaintext highlighter-rouge">uip uip.c</code>. My guess is that it’s a .com domain, so I added the 2 letters to the map:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefghijklmnopqrstuvwxyz    original
 ojtimqfwb  h kd xpnl   s     substituted
</code></pre></div></div>

<p>And with that, the path of the first domain got updated to <code class="language-plaintext highlighter-rouge">/substitutio -so  er</code>. Given what this challenge is, I filled in the blanks to make it <code class="language-plaintext highlighter-rouge">/substitution-solver</code>, mapping 3 more letters in the process:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefghijklmnopqrstuvwxyz    original
 ojtimqfwb uhakd xpnlv  s     substituted
</code></pre></div></div>

<p>So let’s reconstruct what we’ve got of the flag: <code class="language-plaintext highlighter-rouge">rgbCTF{just_4s _th3_int3rn3t_t0_d3crypt_it}</code>. It looked like <em>Just ask the internet to decrypt it</em>, so I mapped <code class="language-plaintext highlighter-rouge">k</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefghijklmnopqrstuvwxyz    original
 ojtimqfwbguhakd xpnlv  s     substituted
</code></pre></div></div>

<p>At this stage, we have the flag, <code class="language-plaintext highlighter-rouge">rgbCTF{just_4sk_th3_int3rn3t_t0_d3crypt_it}</code>, but I decided to finish decoding the first domain: <code class="language-plaintext highlighter-rouge">gub ll .de/substitution-solver</code>. A quick google search led me right to the rest of the result, <code class="language-plaintext highlighter-rouge">guballa.de</code>:</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/ciphers-00.webp" alt="A Google search revealing guballa.de was the domain" /></p>

<p>At this stage, our alphabet looks like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>abcdefghijklmnopqrstuvwxyz    original
zojtimqfwbguhakd xpnlv  s     substituted
</code></pre></div></div>

<p>Just to confirm my work, I punched the entire text into the solver, and the result matched:</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/ciphers-01.webp" alt="A Google search revealing guballa.de was the domain" /></p>

<p>As a bonus, the i.redd.it link in the text led to this image:</p>

<p><img src="https://i.redd.it/1p7w8k0272851.jpg" alt="A doggo looking at himself in a mirror" /></p>

<p>Flag:
<code class="language-plaintext highlighter-rouge">rgbCTF{just_4sk_th3_int3rn3t_t0_d3crypt_it}</code></p>

<h2 id="cryptography">Cryptography</h2>

<h3 id="occasionally-tested-protocol-219-points">Occasionally Tested Protocol (219 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <p><code class="language-plaintext highlighter-rouge">But clearly not tested enough... can you get the flag?</code></p>
</blockquote>

<p>We were also given an address to connect to using <code class="language-plaintext highlighter-rouge">netcat</code>, and attached was a python script, called <code class="language-plaintext highlighter-rouge">otp.py</code>, with the following contents:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span> <span class="n">randint</span> <span class="k">as</span> <span class="n">w</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>


<span class="n">j</span> <span class="o">=</span> <span class="nb">int</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">j</span><span class="p">.</span><span class="n">to_bytes</span>
<span class="n">s</span> <span class="o">=</span> <span class="mi">73</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">479105856333166071017569</span>
<span class="n">_</span> <span class="o">=</span> <span class="mi">1952540788</span>
<span class="n">s</span> <span class="o">=</span> <span class="mi">7696249</span>
<span class="n">o</span> <span class="o">=</span> <span class="mi">6648417</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">29113321535923570</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">199504783476</span>
<span class="n">_</span> <span class="o">=</span> <span class="mi">7827278</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">435778514803</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">6645876</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">157708668092092650711139</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">2191175</span>
<span class="n">o</span> <span class="o">=</span> <span class="mi">2191175</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">7956567</span>
<span class="n">_</span> <span class="o">=</span> <span class="mi">6648417</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">7696249</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">465675318387</span>
<span class="n">s</span> <span class="o">=</span> <span class="mi">4568741745925383538</span>
<span class="n">s</span> <span class="o">=</span> <span class="mi">2191175</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1936287828</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">1953393000</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">29545</span>

<span class="n">g</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"rgbCTF{REDACTED}"</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">seed</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">()))</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Here's 10 numbers for you: "</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10000</span><span class="p">))</span>

    <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span><span class="n">w</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">)])</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">([</span><span class="n">l</span> <span class="o">^</span> <span class="n">p</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)]),</span> <span class="s">'little'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Here's another number I found: "</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<p>The script turned out to be abridged version of the code running at the specified endpoint. The variables (with the exception of <code class="language-plaintext highlighter-rouge">g</code>) looked rather unimportant, so for local testing, one could’ve simply removed them all. Cursory analysis of the algorithm also reveals the challenge type - PRNG state reversing, with <code class="language-plaintext highlighter-rouge">seed(int(time))</code> being the key to the whole thing.</p>

<p>A little bit of background - Python’s <code class="language-plaintext highlighter-rouge">time.time()</code> function returns the current UNIX timestamp as fractional seconds, e.g. <code class="language-plaintext highlighter-rouge">1594735323.0495105</code>. Had the RNG been seeded using the entire number, this would’ve been a very tedious challenge indeed, as it would require going through a large number of fractions to find the proper seed. Lucky for us, the seed was converted into an integer using <code class="language-plaintext highlighter-rouge">int()</code>. When the input to <code class="language-plaintext highlighter-rouge">int()</code> is a floating-point number, it works much like casting in C - the number is truncated to whole part (as an example, <code class="language-plaintext highlighter-rouge">int(1594735323.0495105)</code> results in <code class="language-plaintext highlighter-rouge">1594735323</code>; note that no rounding is performed - <code class="language-plaintext highlighter-rouge">int(1.9)</code> results in <code class="language-plaintext highlighter-rouge">1</code>).</p>

<p>Armed with that knowledge, I performed a timestamped <code class="language-plaintext highlighter-rouge">netcat</code> connection via <code class="language-plaintext highlighter-rouge">date +%s; nc endpoint port</code>, then disconnected once I got my numbers. Worth noting: most values below are examples rather than exact values used, as the writeup was made after the challenge deadline closed.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/otp-00.webp" alt="Output from the remote server" /></p>

<p>The timestamp is the first line (duh), so the data required to reverse the state was as follows:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cseed</span> <span class="o">=</span> <span class="mi">1594735574</span>
<span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7324</span><span class="p">,</span> <span class="mi">3820</span><span class="p">,</span> <span class="mi">9253</span><span class="p">,</span> <span class="mi">4368</span><span class="p">,</span> <span class="mi">8756</span><span class="p">,</span> <span class="mi">2211</span><span class="p">,</span> <span class="mi">1602</span><span class="p">,</span> <span class="mi">722</span><span class="p">,</span> <span class="mi">2226</span><span class="p">,</span> <span class="mi">4959</span><span class="p">]</span>
<span class="n">flagnum</span> <span class="o">=</span> <span class="mi">7424730967707779449792579718502356899503369464409389298411900681059</span>
</code></pre></div></div>

<p>With this, I could start my search for the seed. I whipped up a script and set it loose.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span> <span class="n">randint</span>


<span class="n">cseed</span> <span class="o">=</span> <span class="mi">1594735574</span>
<span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7324</span><span class="p">,</span> <span class="mi">3820</span><span class="p">,</span> <span class="mi">9253</span><span class="p">,</span> <span class="mi">4368</span><span class="p">,</span> <span class="mi">8756</span><span class="p">,</span> <span class="mi">2211</span><span class="p">,</span> <span class="mi">1602</span><span class="p">,</span> <span class="mi">722</span><span class="p">,</span> <span class="mi">2226</span><span class="p">,</span> <span class="mi">4959</span><span class="p">]</span>


<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">seed</span><span class="p">(</span><span class="n">cseed</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="n">nums</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Seed found:"</span><span class="p">,</span> <span class="n">cseed</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Sequence:"</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">break</span>

    <span class="n">cseed</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>It looks scary and has the potential to iterate indefinitely, but the output of <code class="language-plaintext highlighter-rouge">date</code> was at most a couple seconds away from receiving the input from server, so this would only ever run at a couple iterations at most. At any rate, in this instance, computed seed was <code class="language-plaintext highlighter-rouge">1594735575</code>.</p>

<p>That’s first part of the challenge completed, I now needed to figure out the flag. In order to obtain the flag string, I analyzed these 2 lines:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span><span class="n">w</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">)])</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">([</span><span class="n">l</span> <span class="o">^</span> <span class="n">p</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)]),</span> <span class="s">'little'</span><span class="p">)</span>
</code></pre></div></div>

<p>In the above, <code class="language-plaintext highlighter-rouge">g</code> is the flag string. What occurs here, is that 40 random bytes are generated (after the initial 10 values), and then zipped with the flag string <code class="language-plaintext highlighter-rouge">g</code> variable. Elements of the tuples produced by zip are then XORed together, and resulting bytes are encoded into a huge integer value.</p>

<p>XOR (<code class="language-plaintext highlighter-rouge">^</code> in python) is an interesting operator. It is associative (<code class="language-plaintext highlighter-rouge">(a ^ b) ^ c = a ^ (b ^ c)</code> for every <code class="language-plaintext highlighter-rouge">a</code>, <code class="language-plaintext highlighter-rouge">b</code>, and <code class="language-plaintext highlighter-rouge">c</code>), commutative (<code class="language-plaintext highlighter-rouge">a ^ b = b ^ a</code> for every <code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">b</code>), has an identity element of 0 (<code class="language-plaintext highlighter-rouge">a ^ 0 = a</code> for every <code class="language-plaintext highlighter-rouge">a</code>), is self-inversible (<code class="language-plaintext highlighter-rouge">a ^ a = 0</code> for every <code class="language-plaintext highlighter-rouge">a</code>), but most importantly, for any given <code class="language-plaintext highlighter-rouge">a</code>, <code class="language-plaintext highlighter-rouge">b</code>, and <code class="language-plaintext highlighter-rouge">c</code>, performing <code class="language-plaintext highlighter-rouge">a ^ b = c</code>, you can get the value of <code class="language-plaintext highlighter-rouge">a</code> if you have <code class="language-plaintext highlighter-rouge">b</code> by performing <code class="language-plaintext highlighter-rouge">a = c ^ b</code>, and similarly for <code class="language-plaintext highlighter-rouge">b</code>, given value of <code class="language-plaintext highlighter-rouge">a</code>, via <code class="language-plaintext highlighter-rouge">b = c ^ a</code>. That last property is why it’s commonly-used in cryptography.</p>

<p>That last bit is the key to retrieving the flag for the CTF. In this instance, I’m given a collection of bytes corresponding to <code class="language-plaintext highlighter-rouge">c</code> and <code class="language-plaintext highlighter-rouge">b</code> from above explanation, and I’m looking for <code class="language-plaintext highlighter-rouge">a</code>. The large number contains my <code class="language-plaintext highlighter-rouge">c</code> bytes, the random sequence is my <code class="language-plaintext highlighter-rouge">b</code> bytes. Flag is the <code class="language-plaintext highlighter-rouge">a</code> bytes.</p>

<p>In order to retrieve the flag, I have to generate 10 numbers 5-10000, then 40 bytes, using the seed I computed. Next up, I have to decode the big integer into bytes. Obtaining the flag is trivial afterwards. So I whipped up another script.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span> <span class="n">randint</span>


<span class="n">cseed</span> <span class="o">=</span> <span class="mi">1594735575</span>
<span class="n">flagnum</span> <span class="o">=</span> <span class="mi">7424730967707779449792579718502356899503369464409389298411900681059</span>
<span class="n">flaglen</span> <span class="o">=</span> <span class="p">(</span><span class="n">flagnum</span><span class="p">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span>  <span class="c1"># number of bytes the flag has - in this instance 28
</span>

<span class="n">seed</span><span class="p">(</span><span class="n">cseed</span><span class="p">)</span>
<span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>  <span class="c1"># generate the 10 numbers first
</span><span class="n">b</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">flaglen</span><span class="p">))</span>  <span class="c1"># don't need more bytes
</span><span class="n">c</span> <span class="o">=</span> <span class="n">flagnum</span><span class="p">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">flaglen</span><span class="p">,</span> <span class="s">'little'</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</code></pre></div></div>

<p>That script produced the flag string, which means the challenge is completed.</p>

<p>Flag:
<code class="language-plaintext highlighter-rouge">rgbCTF{random_is_not_secure}</code></p>

<h3 id="n-aes-473-points">N-AES (473 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <p><code class="language-plaintext highlighter-rouge">What if I encrypt something with AES multiple times?</code></p>
</blockquote>

<p>We were also given an address to connect to using <code class="language-plaintext highlighter-rouge">netcat</code>, and attached was a python script, called <code class="language-plaintext highlighter-rouge">n_aes.py</code>, with the following contents:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span><span class="p">,</span> <span class="n">b64decode</span>
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">urandom</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span> <span class="n">randint</span>

<span class="n">BLOCK_SIZE</span> <span class="o">=</span> <span class="mi">16</span>


<span class="k">def</span> <span class="nf">rand_block</span><span class="p">(</span><span class="n">key_seed</span><span class="o">=</span><span class="n">urandom</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
    <span class="n">seed</span><span class="p">(</span><span class="n">key_seed</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">BLOCK_SIZE</span><span class="p">)])</span>


<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">seed_bytes</span><span class="p">):</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">plaintext</span><span class="p">),</span> <span class="n">BLOCK_SIZE</span><span class="p">)</span>
    <span class="n">seed_bytes</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">seed_bytes</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">seed_bytes</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">8</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">seed_bytes</span><span class="p">:</span>
        <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">rand_block</span><span class="p">(</span><span class="n">seed</span><span class="p">),</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="n">encrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">seed_bytes</span><span class="p">):</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
    <span class="n">seed_bytes</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">seed_bytes</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">seed_bytes</span><span class="p">):</span>
        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">rand_block</span><span class="p">(</span><span class="n">byte</span><span class="p">),</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="n">decrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">unpad</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">BLOCK_SIZE</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">gen_chall</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">BLOCK_SIZE</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">rand_block</span><span class="p">(),</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="n">encrypt</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">challenge</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">urandom</span><span class="p">(</span><span class="mi">64</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">gen_chall</span><span class="p">(</span><span class="n">challenge</span><span class="p">).</span><span class="n">decode</span><span class="p">())</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[1] Encrypt"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[2] Decrypt"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[3] Solve challenge"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[4] Give up"</span><span class="p">)</span>

        <span class="n">command</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"&gt; "</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s">'1'</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter text to encrypt, in base64: "</span><span class="p">)</span>
                <span class="n">seed_bytes</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter key, in base64: "</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">encrypt</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">seed_bytes</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s">'2'</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter text to decrypt, in base64: "</span><span class="p">)</span>
                <span class="n">seed_bytes</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter key, in base64: "</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">decrypt</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">seed_bytes</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s">'3'</span><span class="p">:</span>
                <span class="n">answer</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the decrypted challenge, in base64: "</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span> <span class="o">==</span> <span class="n">challenge</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Correct!"</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Here's your flag:"</span><span class="p">)</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"flag"</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Incorrect!"</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s">'4'</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Invalid command!"</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binascii</span><span class="p">.</span><span class="n">Error</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Base64 error!"</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">Exception</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Error!"</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">"Bye!"</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>Much like with the previous challenge, attached script is the abridged source of the program at the given endpoint. Unlike the previous one, however, it appeared to be a codebreaking challenge. Looks can be deceiving however, and so it was in this instance. Again: most values below are examples rather than exact values used, as the writeup was made after the challenge deadline closed.</p>

<p>Upon connecting, the program greeted me with a base64 challenge string. I was a little confused as to where to start at first, so I decided to analyze the source again. Tracing the challenge string generation code revealed interesting things, however, and something I overlooked at first.</p>

<p>The final challenge solve text is also a base64 string, which has been encrypted. My job was to decrypt it, that is, to find the key used to encrypt it. Scanning the imports revealed the encryption to be AES, with PCKS#7 padding.</p>

<p>The padding bit is important, as it lets you determine whether your process was successful. This padding algorithm works by filling the last block of the input, such that its output size is aligned to desired block size. The filler bytes double as a padding size counter, meaning that if the block is missing e.g. 3 bytes, it will be filled with 3 <code class="language-plaintext highlighter-rouge">'\x03'</code> bytes. If the input is already at block size, PKCS#7 appends a new empty block, then fills it with padding.</p>

<p>Further analysis of the program reveals that the AES variant used here is 128-bit, so it uses 16-byte (128-bit) blocks. Looking at the challenge generation code, it generates 64 random bytes, which are then encoded with base64. Base64 emits a character (byte) for every 6 bits of input, meaning the output string is around 133% the size of input. In this case, the base64 string was 88 characters long. As 88 is not divisible by the block size (16), I had to find block-aligned input size that AES would accept. For 88 bytes, that 96 bytes, meaning PKCS#7 would append 8 bytes of padding - <code class="language-plaintext highlighter-rouge">b'\x08' * 8</code>. That’s my sentinel value, of sorts.</p>

<p>The challenge is then passed to the <code class="language-plaintext highlighter-rouge">gen_chall</code> function:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">gen_chall</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">BLOCK_SIZE</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">rand_block</span><span class="p">(),</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="n">encrypt</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></div>

<p>Here, the padding is appended, and the text is then encrypted 128 times, using key which is the output of <code class="language-plaintext highlighter-rouge">rand_block()</code>. The encryption output is then base64-encoded. The key generation function looks as follows:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">rand_block</span><span class="p">(</span><span class="n">key_seed</span><span class="o">=</span><span class="n">urandom</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
    <span class="n">seed</span><span class="p">(</span><span class="n">key_seed</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">BLOCK_SIZE</span><span class="p">)])</span>
</code></pre></div></div>

<p>Which initially seems rather hopeless, as at first glance it seems to generate a different key for every call with the default argument. But that is not, in fact, what happens. Function arguments in python are evaluated at the time of function creation, meaning they are computed exactly once. For this challenge, it means the challenge string is encrypted 128 times, each time with the same exact key. And since the function’s default argument is <code class="language-plaintext highlighter-rouge">urandom(1)</code>, which produces 1 byte, there were exactly 256 possible keys. Great, now we’re getting somewhere.</p>

<p>However before I could proceed, I still had to analyze the remaining parts of the program. I decided to look at the encryption and decryption functions first.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">seed_bytes</span><span class="p">):</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">plaintext</span><span class="p">),</span> <span class="n">BLOCK_SIZE</span><span class="p">)</span>
    <span class="n">seed_bytes</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">seed_bytes</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">seed_bytes</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">8</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">seed_bytes</span><span class="p">:</span>
        <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">rand_block</span><span class="p">(</span><span class="n">seed</span><span class="p">),</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="n">encrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">seed_bytes</span><span class="p">):</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
    <span class="n">seed_bytes</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">seed_bytes</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">seed_bytes</span><span class="p">):</span>
        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">rand_block</span><span class="p">(</span><span class="n">byte</span><span class="p">),</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="n">decrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">unpad</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">BLOCK_SIZE</span><span class="p">))</span>
</code></pre></div></div>

<p>They aren’t conventional encryption and decryption functions, since they take a seed, which is a string of bytes, then perform their respective operation on the input byte string as many times, as there are bytes in the seed, using consecutive bytes from the seed to generate keys.</p>

<p>Looking at the entry point of the program, more specifically, the solve part, also reveals how the challenge is solved.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s">'3'</span><span class="p">:</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter the decrypted challenge, in base64: "</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">b64decode</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span> <span class="o">==</span> <span class="n">challenge</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Correct!"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Here's your flag:"</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"flag"</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Incorrect!"</span><span class="p">)</span>
    <span class="k">break</span>
</code></pre></div></div>

<p>Decrypted challenge is decoded from base64, then compared to challenge string.</p>

<p>To summarize the story so far, my job was to:</p>

<ol>
  <li>Generate 256 128-byte strings, each consisting of one byte</li>
  <li>Get the challenge string from the remote server</li>
  <li>Brute force it using generated keys</li>
</ol>

<p>To achieve all that, I built a Python script, using parts of the challenge program.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span> <span class="n">randint</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span><span class="p">,</span> <span class="n">b64decode</span>
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>


<span class="n">BLOCK_SIZE</span> <span class="o">=</span> <span class="mi">16</span>


<span class="k">def</span> <span class="nf">rand_block</span><span class="p">(</span><span class="n">key_seed</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
    <span class="n">seed</span><span class="p">(</span><span class="n">key_seed</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">BLOCK_SIZE</span><span class="p">)])</span>


<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nb">input</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">).</span><span class="n">decrypt</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">text</span><span class="p">,</span> <span class="n">unpad</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">BLOCK_SIZE</span><span class="p">),</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">unpad</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">BLOCK_SIZE</span><span class="p">)).</span><span class="n">decode</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">challenge</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"Input challenge string: "</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"-"</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">rand_block</span><span class="p">(</span><span class="nb">bytes</span><span class="p">([</span><span class="n">x</span><span class="p">]))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">seed</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">:]</span> <span class="o">!=</span> <span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\x08</span><span class="s">'</span> <span class="o">*</span> <span class="mi">8</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Decrypted:  "</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Unpadded:   "</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Encoded:    "</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Seed:       "</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Key:        "</span><span class="p">,</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">key</span><span class="p">).</span><span class="n">decode</span><span class="p">())</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Seed string:"</span><span class="p">,</span> <span class="n">b64encode</span><span class="p">(</span><span class="nb">bytes</span><span class="p">([</span><span class="n">seed</span><span class="p">]</span> <span class="o">*</span> <span class="mi">128</span><span class="p">)).</span><span class="n">decode</span><span class="p">())</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"-"</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="k">continue</span>
</code></pre></div></div>

<p>All that was left was connecting to the remote server to obtain my challenge string.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/naes-00.webp" alt="Output from the remote server" /></p>

<p>My challenge string in this instance is <code class="language-plaintext highlighter-rouge">5v8Qcgb+LQK8jjiELETTc5Eb22kqpiVshV3q6pZ2MIrSMEQ247l9wqNLXVTRLLkq04yCGQqI62JkgKc8Y97rCn5ubkT8Cak+gb9hXF2D11LujClAsBrN3D2VALKgHiKp</code>. I punched it into my solver script, and got a solution. Highlighted in red is the aforementioned padding.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/naes-01.webp" alt="Solver results, with padding result highlighted" /></p>

<p>I punched the encoded result into <code class="language-plaintext highlighter-rouge">netcat</code>, and the server echoed me a flag.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/naes-02.webp" alt="Flag obtained" /></p>

<p>Flag:
<code class="language-plaintext highlighter-rouge">rgbCTF{i_d0nt_7hink_7his_d03s_wh47_y0u_7hink_i7_d03s}</code></p>

<h2 id="forensicsosint">Forensics/OSINT</h2>

<h3 id="pi-1-magic-in-the-air-470-points">PI 1: Magic in the air (470 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>We are investigating an individual we believe is connected to a group smuggling drugs into the country and selling them on social media. You have been posted on a stake out in the apartment above theirs and with the help of space-age eavesdropping technology have managed to extract some data from their computer. What is the phone number of the suspect's criminal contact?

flag format includes country code so it should be in the format: rgbCTF{+00000000000}
</code></pre></div>  </div>
</blockquote>

<p>Attached was a Bluetooth HCI log in btsnoop format. I was initially unsure what to do with it, but with Still’s advice, I loaded it into Wireshark.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-00.webp" alt="View of the log in Wireshark" /></p>

<p>Inspecting the log revealed it was taken by snooping on nearby Bluetooth traffic, using <code class="language-plaintext highlighter-rouge">Linux version 5.5.0-kali2-amd64 (x86_64)</code>, and <code class="language-plaintext highlighter-rouge">Bluetooth subsystem version 2.22</code>. Device was attached via <code class="language-plaintext highlighter-rouge">hci0</code>, the supporting daemon was <code class="language-plaintext highlighter-rouge">bluetoothd</code>, and the snooper was <code class="language-plaintext highlighter-rouge">btmon</code>. The target device identified itself as G613. A quick conversation with Still and some Google let me identify it as a Logitech™ G613 Wireless Mechanical Keyboard. Fancy stuff.</p>

<p>All this tells me is that I’m looking for information on how do Bluetooth keyboards talk to the target computers. The answer? HID over Bluetooth. Reading the HID specification, I find out that one of the first things a device has to do after it’s initialized is presenting itself, and describing its payloads. Googling around led me to a <a href="https://stackoverflow.com/questions/45478259/decoding-captured-hid-over-gatt-traffic-with-usbpcap-Wireshark">StackOverflow thread</a>, where a similar problem is described. From this thread I found some important pieces of information, HID descriptors, also called Report Maps in HID terminology, tend to begin with <code class="language-plaintext highlighter-rouge">0x05 0x01 0x09</code> and tend to end with <code class="language-plaintext highlighter-rouge">0xc0</code>. I searched for a relevant byte sequence in Wireshark.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-01.webp" alt="Quick search reveals all" /></p>

<p>The descriptor was fragmented due to Bluetooth Low Emission MTUs, so I had to reconstruct it. Using Google, I also found a <a href="https://eleccelerator.com/usbdescreqparser/">HID payload decoder</a>. I punched the reconstructed packet into the website, and let it decode it. The result was less than helpful. It looked like the keyboard description was omitted or stripped from the log.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-02.webp" alt="Descriptor decode result" /></p>

<p>The descriptors found in the log are for system control and vendor-specific applications, neither of which is keyboard. I decided to scroll a little in Wireshark, and reached a block of HID Reports.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-03.webp" alt="A block of reports" /></p>

<p>Per HID specification, a keystroke is sent as a report, so I decided to check out a couple of them to see which bytes were changing. The changing bytes would then have to be keystrokes. <a href="https://www.usb.org/sites/default/files/documents/hut1_12v2.pdf">USB Consortium HID Usage Tables</a>, specifically pages 53-55, have proven to be an invaluable resource in decoding the data stream. I picked some reports at random, and started taking notes.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-04.gif" alt="Changing bytes" /></p>

<p>Notice how the second byte of each payload changes. I noted down consecutive non-zero values: <code class="language-plaintext highlighter-rouge">0f 28 28 17 15 1c</code>. Using the document mentioned earlier, I translated these bytes to <code class="language-plaintext highlighter-rouge">i \n \n try</code>. That looks like words! I now had a potential solution. All I needed to do was to filter out the noise, and export this to something I could filter with Python.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-05.webp" alt="Copy as filter" /></p>

<p>By using the Copy As Filter function in Wireshark, I created the following filter: <code class="language-plaintext highlighter-rouge">bthci_acl.src.bd_addr == f6:3c:91:42:32:28 and btatt.handle == 0x002c and btatt.opcode == 0x1b</code>.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-06.webp" alt="Filtered packets" /></p>

<p>All that’s left now is exporting them. Wireshark supports exporting packets as JSON, which I used to export the filtered packets. I checked to export packet bytes as well, just in case.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-07.webp" alt="Export menu" /></p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-08.webp" alt="Export window" /></p>

<p>So now I have a &gt;5MiB JSON file with an array of JSON packets in it. Each packet was a huge JSON object, but I only needed one part of it.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"_index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"packets-2020-06-27"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"doc"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"_score"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"_source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"layers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"frame_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"012e0e000a0004001b2c0000000000000000"</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">18</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">1</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"frame"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"frame.encap_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"159"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jun 27, 2020 23:49:04.697555000 Central European Daylight Time"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.offset_shift"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000000"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.time_epoch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1593294544.697555000"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.time_delta"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000491000"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.time_delta_displayed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000000"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.time_relative"</span><span class="p">:</span><span class="w"> </span><span class="s2">"32.204526000"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"304"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.len"</span><span class="p">:</span><span class="w"> </span><span class="s2">"18"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.cap_len"</span><span class="p">:</span><span class="w"> </span><span class="s2">"18"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.marked"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.ignored"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"frame.protocols"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bluetooth:hci_mon:bthci_acl:btl2cap:btatt"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"bluetooth_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"012e0e000a0004001b2c0000000000000000"</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">18</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">1</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"bluetooth"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"bluetooth.addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f6:3c:91:42:32:28"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bluetooth.src"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f6:3c:91:42:32:28"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bluetooth.addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00:00:00:00:00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bluetooth.dst"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00:00:00:00:00:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"hci_mon_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"012e0e000a0004001b2c0000000000000000"</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">18</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">1</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"hci_mon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"hci_mon.adapter_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"hci_mon.opcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"bthci_acl_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"012e0e000a0004001b2c0000000000000000"</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">18</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">1</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"bthci_acl"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"bthci_acl.chandle_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"E01"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">2</span><span class="p">,</span><span class="w">
                    </span><span class="mi">4095</span><span class="p">,</span><span class="w">
                    </span><span class="mi">5</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"bthci_acl.chandle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x00000e01"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.pb_flag_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">2</span><span class="p">,</span><span class="w">
                    </span><span class="mi">12288</span><span class="p">,</span><span class="w">
                    </span><span class="mi">5</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"bthci_acl.pb_flag"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.bc_flag_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">2</span><span class="p">,</span><span class="w">
                    </span><span class="mi">49152</span><span class="p">,</span><span class="w">
                    </span><span class="mi">5</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"bthci_acl.bc_flag"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.length_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"0e00"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">2</span><span class="p">,</span><span class="w">
                    </span><span class="mi">2</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">5</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"bthci_acl.length"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.data_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"0a0004001b2c0000000000000000"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">4</span><span class="p">,</span><span class="w">
                    </span><span class="mi">14</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"bthci_acl.data"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.connect_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"69"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.src.bd_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f6:3c:91:42:32:28"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.src.name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"G613"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.src.role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.dst.bd_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00:00:00:00:00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.dst.name"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.dst.role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bthci_acl.mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-1"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"btl2cap_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"0a0004001b2c0000000000000000"</span><span class="p">,</span><span class="w">
                </span><span class="mi">4</span><span class="p">,</span><span class="w">
                </span><span class="mi">14</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">1</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"btl2cap"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"btl2cap.length_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"0a00"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">4</span><span class="p">,</span><span class="w">
                    </span><span class="mi">2</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">5</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"btl2cap.length"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"btl2cap.cid_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"0400"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">6</span><span class="p">,</span><span class="w">
                    </span><span class="mi">2</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">5</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"btl2cap.cid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"btatt_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"1b2c0000000000000000"</span><span class="p">,</span><span class="w">
                </span><span class="mi">8</span><span class="p">,</span><span class="w">
                </span><span class="mi">10</span><span class="p">,</span><span class="w">
                </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="mi">1</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"btatt"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"btatt.opcode_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"1b"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">8</span><span class="p">,</span><span class="w">
                    </span><span class="mi">1</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">4</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"btatt.opcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x0000001b"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"btatt.opcode_tree"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"btatt.opcode.authentication_signature_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                        </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                        </span><span class="mi">8</span><span class="p">,</span><span class="w">
                        </span><span class="mi">1</span><span class="p">,</span><span class="w">
                        </span><span class="mi">128</span><span class="p">,</span><span class="w">
                        </span><span class="mi">2</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="nl">"btatt.opcode.authentication_signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"btatt.opcode.command_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                        </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                        </span><span class="mi">8</span><span class="p">,</span><span class="w">
                        </span><span class="mi">1</span><span class="p">,</span><span class="w">
                        </span><span class="mi">64</span><span class="p">,</span><span class="w">
                        </span><span class="mi">2</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="nl">"btatt.opcode.command"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"btatt.opcode.method_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                        </span><span class="s2">"1B"</span><span class="p">,</span><span class="w">
                        </span><span class="mi">8</span><span class="p">,</span><span class="w">
                        </span><span class="mi">1</span><span class="p">,</span><span class="w">
                        </span><span class="mi">63</span><span class="p">,</span><span class="w">
                        </span><span class="mi">4</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="nl">"btatt.opcode.method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x0000001b"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"btatt.handle_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"2c00"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">9</span><span class="p">,</span><span class="w">
                    </span><span class="mi">2</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">5</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"btatt.handle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0x0000002c"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"btatt.handle_tree"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"btatt.service_uuid16"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6162"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"btatt.uuid16"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10829"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"btatt.value_raw"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"00000000000000"</span><span class="p">,</span><span class="w">
                    </span><span class="mi">11</span><span class="p">,</span><span class="w">
                    </span><span class="mi">7</span><span class="p">,</span><span class="w">
                    </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="mi">30</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"btatt.value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00:00:00:00:00:00:00"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"btatt.value_tree"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"_ws.expert"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"btatt.undecoded"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"_ws.expert.message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Undecoded"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"_ws.expert.severity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4194304"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"_ws.expert.group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"83886080"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>My desired data was under <code class="language-plaintext highlighter-rouge">_source / layers / btatt / btatt.value_raw / [0]</code>, and the characters that interested me were characters 2-6. Next step was to filter the data. I wrote a python script to tell me which keystrokes from the document I needed, and, while at it, filter out all the unnecessary data from it.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">load</span><span class="p">,</span> <span class="n">dump</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"hci.json"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">t1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s">"_source"</span><span class="p">][</span><span class="s">"layers"</span><span class="p">][</span><span class="s">"btatt"</span><span class="p">][</span><span class="s">"btatt.value_raw"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
<span class="n">t2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t1</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s">"00"</span><span class="p">]</span>
<span class="n">t3</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t2</span><span class="p">]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"hci_filtered.json"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">dump</span><span class="p">(</span><span class="n">t3</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Unique keystrokes:"</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">t3</span><span class="p">)))</span>
</code></pre></div></div>

<p>This gave me the list I needed:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="s">'04'</span><span class="p">,</span> <span class="s">'05'</span><span class="p">,</span> <span class="s">'06'</span><span class="p">,</span> <span class="s">'07'</span><span class="p">,</span> <span class="s">'08'</span><span class="p">,</span> <span class="s">'09'</span><span class="p">,</span> <span class="s">'0a'</span><span class="p">,</span> <span class="s">'0b'</span><span class="p">,</span> <span class="s">'0c'</span><span class="p">,</span> <span class="s">'0d'</span><span class="p">,</span> <span class="s">'0e'</span><span class="p">,</span> <span class="s">'0f'</span><span class="p">,</span> <span class="s">'10'</span><span class="p">,</span> <span class="s">'11'</span><span class="p">,</span> <span class="s">'12'</span><span class="p">,</span> <span class="s">'13'</span><span class="p">,</span> <span class="s">'15'</span><span class="p">,</span> <span class="s">'16'</span><span class="p">,</span> <span class="s">'17'</span><span class="p">,</span> <span class="s">'18'</span><span class="p">,</span> <span class="s">'19'</span><span class="p">,</span> <span class="s">'1a'</span><span class="p">,</span> <span class="s">'1b'</span><span class="p">,</span> <span class="s">'1c'</span><span class="p">,</span> <span class="s">'1f'</span><span class="p">,</span> <span class="s">'20'</span><span class="p">,</span> <span class="s">'22'</span><span class="p">,</span> <span class="s">'23'</span><span class="p">,</span> <span class="s">'24'</span><span class="p">,</span> <span class="s">'25'</span><span class="p">,</span> <span class="s">'26'</span><span class="p">,</span> <span class="s">'27'</span><span class="p">,</span> <span class="s">'28'</span><span class="p">,</span> <span class="s">'2a'</span><span class="p">,</span> <span class="s">'2c'</span><span class="p">,</span> <span class="s">'34'</span><span class="p">,</span> <span class="s">'36'</span><span class="p">,</span> <span class="s">'37'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">]</span>
</code></pre></div></div>

<p>Going back to the document, I found what I needed. Range <code class="language-plaintext highlighter-rouge">04..1d</code> mapped to <code class="language-plaintext highlighter-rouge">'a'..'z'</code>, <code class="language-plaintext highlighter-rouge">1e..26</code> mapped to <code class="language-plaintext highlighter-rouge">'1'..'9'</code>, <code class="language-plaintext highlighter-rouge">27</code> mapped to <code class="language-plaintext highlighter-rouge">'0'</code>, <code class="language-plaintext highlighter-rouge">28</code> was <code class="language-plaintext highlighter-rouge">'\n'</code>, <code class="language-plaintext highlighter-rouge">2a</code> was <code class="language-plaintext highlighter-rouge">'\b'</code>, <code class="language-plaintext highlighter-rouge">2c</code> was <code class="language-plaintext highlighter-rouge">' '</code>, <code class="language-plaintext highlighter-rouge">34</code> was <code class="language-plaintext highlighter-rouge">'"'</code> or <code class="language-plaintext highlighter-rouge">'\''</code> (I opted to use quotes), <code class="language-plaintext highlighter-rouge">36</code> was <code class="language-plaintext highlighter-rouge">','</code> or <code class="language-plaintext highlighter-rouge">'&lt;'</code> (I opted to use comma), <code class="language-plaintext highlighter-rouge">37</code> was <code class="language-plaintext highlighter-rouge">'.'</code> or <code class="language-plaintext highlighter-rouge">'&gt;'</code> (I opted to use full stop), and <code class="language-plaintext highlighter-rouge">38</code> was <code class="language-plaintext highlighter-rouge">'/'</code> or <code class="language-plaintext highlighter-rouge">'?'</code> (I opted to use question mark).</p>

<p>With that, I had to build a required keymap.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">keymap</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Letters: 04..1d
</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>  <span class="c1"># There are 26 latin letters
</span>    <span class="n">kidx</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"0"</span><span class="p">)</span>  <span class="c1"># Shifts by 4 (lower boundary is 04), strips 0x prefix, and pads with leading 0s until length is 2: 0 -&gt; 04, 12 -&gt; 0a, etc
</span>    <span class="n">kchr</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>             <span class="c1"># Character
</span>    <span class="n">keymap</span><span class="p">[</span><span class="n">kidx</span><span class="p">]</span> <span class="o">=</span> <span class="n">kchr</span>

<span class="c1"># Numbers 1-9: 1e..26
</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">kidx</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="mh">0x1d</span> <span class="o">+</span> <span class="n">x</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">kchr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">keymap</span><span class="p">[</span><span class="n">kidx</span><span class="p">]</span> <span class="o">=</span> <span class="n">kchr</span>

<span class="c1"># Number 0: 27
</span><span class="n">keymap</span><span class="p">[</span><span class="s">'27'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'0'</span>

<span class="c1"># Other characters
</span><span class="n">keymap</span><span class="p">[</span><span class="s">'28'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
<span class="n">keymap</span><span class="p">[</span><span class="s">'2a'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'</span><span class="se">\b</span><span class="s">'</span>
<span class="n">keymap</span><span class="p">[</span><span class="s">'2c'</span><span class="p">]</span> <span class="o">=</span> <span class="s">' '</span>
<span class="n">keymap</span><span class="p">[</span><span class="s">'34'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'"'</span>
<span class="n">keymap</span><span class="p">[</span><span class="s">'36'</span><span class="p">]</span> <span class="o">=</span> <span class="s">','</span>
<span class="n">keymap</span><span class="p">[</span><span class="s">'37'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'.'</span>
<span class="n">keymap</span><span class="p">[</span><span class="s">'38'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'?'</span>

<span class="c1"># Print out
</span><span class="k">print</span><span class="p">(</span><span class="n">keymap</span><span class="p">)</span>
</code></pre></div></div>

<p>I verified the keymap quickly using a script.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">load</span>


<span class="n">keymap</span> <span class="o">=</span> <span class="p">{</span><span class="s">'04'</span><span class="p">:</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'05'</span><span class="p">:</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'06'</span><span class="p">:</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'07'</span><span class="p">:</span> <span class="s">'d'</span><span class="p">,</span> <span class="s">'08'</span><span class="p">:</span> <span class="s">'e'</span><span class="p">,</span> <span class="s">'09'</span><span class="p">:</span> <span class="s">'f'</span><span class="p">,</span> <span class="s">'0a'</span><span class="p">:</span> <span class="s">'g'</span><span class="p">,</span> <span class="s">'0b'</span><span class="p">:</span> <span class="s">'h'</span><span class="p">,</span> <span class="s">'0c'</span><span class="p">:</span> <span class="s">'i'</span><span class="p">,</span> <span class="s">'0d'</span><span class="p">:</span> <span class="s">'j'</span><span class="p">,</span> <span class="s">'0e'</span><span class="p">:</span> <span class="s">'k'</span><span class="p">,</span> <span class="s">'0f'</span><span class="p">:</span> <span class="s">'l'</span><span class="p">,</span> <span class="s">'10'</span><span class="p">:</span> <span class="s">'m'</span><span class="p">,</span> <span class="s">'11'</span><span class="p">:</span> <span class="s">'n'</span><span class="p">,</span> <span class="s">'12'</span><span class="p">:</span> <span class="s">'o'</span><span class="p">,</span> <span class="s">'13'</span><span class="p">:</span> <span class="s">'p'</span><span class="p">,</span> <span class="s">'14'</span><span class="p">:</span> <span class="s">'q'</span><span class="p">,</span> <span class="s">'15'</span><span class="p">:</span> <span class="s">'r'</span><span class="p">,</span> <span class="s">'16'</span><span class="p">:</span> <span class="s">'s'</span><span class="p">,</span> <span class="s">'17'</span><span class="p">:</span> <span class="s">'t'</span><span class="p">,</span> <span class="s">'18'</span><span class="p">:</span> <span class="s">'u'</span><span class="p">,</span> <span class="s">'19'</span><span class="p">:</span> <span class="s">'v'</span><span class="p">,</span> <span class="s">'1a'</span><span class="p">:</span> <span class="s">'w'</span><span class="p">,</span> <span class="s">'1b'</span><span class="p">:</span> <span class="s">'x'</span><span class="p">,</span> <span class="s">'1c'</span><span class="p">:</span> <span class="s">'y'</span><span class="p">,</span> <span class="s">'1d'</span><span class="p">:</span> <span class="s">'z'</span><span class="p">,</span> <span class="s">'1e'</span><span class="p">:</span> <span class="s">'1'</span><span class="p">,</span> <span class="s">'1f'</span><span class="p">:</span> <span class="s">'2'</span><span class="p">,</span> <span class="s">'20'</span><span class="p">:</span> <span class="s">'3'</span><span class="p">,</span> <span class="s">'21'</span><span class="p">:</span> <span class="s">'4'</span><span class="p">,</span> <span class="s">'22'</span><span class="p">:</span> <span class="s">'5'</span><span class="p">,</span> <span class="s">'23'</span><span class="p">:</span> <span class="s">'6'</span><span class="p">,</span> <span class="s">'24'</span><span class="p">:</span> <span class="s">'7'</span><span class="p">,</span> <span class="s">'25'</span><span class="p">:</span> <span class="s">'8'</span><span class="p">,</span> <span class="s">'26'</span><span class="p">:</span> <span class="s">'9'</span><span class="p">,</span> <span class="s">'27'</span><span class="p">:</span> <span class="s">'0'</span><span class="p">,</span> <span class="s">'28'</span><span class="p">:</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'2a'</span><span class="p">:</span> <span class="s">'</span><span class="se">\x08</span><span class="s">'</span><span class="p">,</span> <span class="s">'2c'</span><span class="p">:</span> <span class="s">' '</span><span class="p">,</span> <span class="s">'34'</span><span class="p">:</span> <span class="s">'"'</span><span class="p">,</span> <span class="s">'36'</span><span class="p">:</span> <span class="s">','</span><span class="p">,</span> <span class="s">'37'</span><span class="p">:</span> <span class="s">'.'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">:</span> <span class="s">'?'</span><span class="p">}</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"hci_filtered.json"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">keymap</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Missing definitions:"</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">difference</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
</code></pre></div></div>

<p>No missing keys, great. Now I could start translating. A thing of note at this stage: every key is 1 byte, yet I exported 2 bytes for each report. This is because I noticed that some keystrokes are sent several times, with the second byte being non-zero. I don’t know what it means, however as this effectively duplicates letters, I used it to discard duplicated or other invalid keystrokes. So to translate the stream, let’s feed it to a python script.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">load</span>


<span class="n">keymap</span> <span class="o">=</span> <span class="p">{</span><span class="s">'04'</span><span class="p">:</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'05'</span><span class="p">:</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'06'</span><span class="p">:</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'07'</span><span class="p">:</span> <span class="s">'d'</span><span class="p">,</span> <span class="s">'08'</span><span class="p">:</span> <span class="s">'e'</span><span class="p">,</span> <span class="s">'09'</span><span class="p">:</span> <span class="s">'f'</span><span class="p">,</span> <span class="s">'0a'</span><span class="p">:</span> <span class="s">'g'</span><span class="p">,</span> <span class="s">'0b'</span><span class="p">:</span> <span class="s">'h'</span><span class="p">,</span> <span class="s">'0c'</span><span class="p">:</span> <span class="s">'i'</span><span class="p">,</span> <span class="s">'0d'</span><span class="p">:</span> <span class="s">'j'</span><span class="p">,</span> <span class="s">'0e'</span><span class="p">:</span> <span class="s">'k'</span><span class="p">,</span> <span class="s">'0f'</span><span class="p">:</span> <span class="s">'l'</span><span class="p">,</span> <span class="s">'10'</span><span class="p">:</span> <span class="s">'m'</span><span class="p">,</span> <span class="s">'11'</span><span class="p">:</span> <span class="s">'n'</span><span class="p">,</span> <span class="s">'12'</span><span class="p">:</span> <span class="s">'o'</span><span class="p">,</span> <span class="s">'13'</span><span class="p">:</span> <span class="s">'p'</span><span class="p">,</span> <span class="s">'14'</span><span class="p">:</span> <span class="s">'q'</span><span class="p">,</span> <span class="s">'15'</span><span class="p">:</span> <span class="s">'r'</span><span class="p">,</span> <span class="s">'16'</span><span class="p">:</span> <span class="s">'s'</span><span class="p">,</span> <span class="s">'17'</span><span class="p">:</span> <span class="s">'t'</span><span class="p">,</span> <span class="s">'18'</span><span class="p">:</span> <span class="s">'u'</span><span class="p">,</span> <span class="s">'19'</span><span class="p">:</span> <span class="s">'v'</span><span class="p">,</span> <span class="s">'1a'</span><span class="p">:</span> <span class="s">'w'</span><span class="p">,</span> <span class="s">'1b'</span><span class="p">:</span> <span class="s">'x'</span><span class="p">,</span> <span class="s">'1c'</span><span class="p">:</span> <span class="s">'y'</span><span class="p">,</span> <span class="s">'1d'</span><span class="p">:</span> <span class="s">'z'</span><span class="p">,</span> <span class="s">'1e'</span><span class="p">:</span> <span class="s">'1'</span><span class="p">,</span> <span class="s">'1f'</span><span class="p">:</span> <span class="s">'2'</span><span class="p">,</span> <span class="s">'20'</span><span class="p">:</span> <span class="s">'3'</span><span class="p">,</span> <span class="s">'21'</span><span class="p">:</span> <span class="s">'4'</span><span class="p">,</span> <span class="s">'22'</span><span class="p">:</span> <span class="s">'5'</span><span class="p">,</span> <span class="s">'23'</span><span class="p">:</span> <span class="s">'6'</span><span class="p">,</span> <span class="s">'24'</span><span class="p">:</span> <span class="s">'7'</span><span class="p">,</span> <span class="s">'25'</span><span class="p">:</span> <span class="s">'8'</span><span class="p">,</span> <span class="s">'26'</span><span class="p">:</span> <span class="s">'9'</span><span class="p">,</span> <span class="s">'27'</span><span class="p">:</span> <span class="s">'0'</span><span class="p">,</span> <span class="s">'28'</span><span class="p">:</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'2a'</span><span class="p">:</span> <span class="s">'</span><span class="se">\x08</span><span class="s">'</span><span class="p">,</span> <span class="s">'2c'</span><span class="p">:</span> <span class="s">' '</span><span class="p">,</span> <span class="s">'34'</span><span class="p">:</span> <span class="s">'"'</span><span class="p">,</span> <span class="s">'36'</span><span class="p">:</span> <span class="s">','</span><span class="p">,</span> <span class="s">'37'</span><span class="p">:</span> <span class="s">'.'</span><span class="p">,</span> <span class="s">'38'</span><span class="p">:</span> <span class="s">'?'</span><span class="p">}</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"hci_filtered.json"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">keymap</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">"00"</span> <span class="k">else</span> <span class="s">""</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
</code></pre></div></div>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-09.webp" alt="Translated text" /></p>

<p>With that, I obtained the required information to construct the flag.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yoo man
sorry for the delay lol

trying to get this keyboard workinn

yea its new. wireless man.

been moving product

speakin of you needed to contact my boy right?

ye

should be fine just say johnny h sent you

alright lemme get you the number

hold up i"m looking for it

its his burner, got it written down somewhere


yeah got it

0736727859

mind it is a swwedish number. he got it on holiday there few months back

yeah you can buy burners super easily there

alright g

yeah its  donny l

remember to tell him i sent you

peace

x
</code></pre></div></div>

<p>The 2 pieces of information pertaining to the flag are the phone number from the transcript, <code class="language-plaintext highlighter-rouge">0736727859</code>, as well as the information that it’s a Swedish number, which means the dialing code is +46. By stripping the leading 0, and prepending the dialing code, I obtained the flag.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/pi1-10.webp" alt="Sweden dialing code" /></p>

<p>Flag:
<code class="language-plaintext highlighter-rouge">rgbCTF{+46736727859}</code></p>

<h2 id="misc">Misc</h2>

<h3 id="laser-1---factoring-480-points">Laser 1 - Factoring (480 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/Quintec/LaserLang

Do you like lasers? I like lasers! Here's a warmup: create a program that factors the one number given as input. Output factors on one line in ascending order (or just leave them on the stack, as Laser has implicit output)

Example
Input: 42
Output: 1 2 3 6 7 14 21 42
</code></pre></div>  </div>
</blockquote>

<p>We were also given an address to connect to using <code class="language-plaintext highlighter-rouge">netcat</code>. When connected, we’d input our code, which would then get tested against several cases. If all tests passed, the flag would be revealed. The <a href="https://github.com/Quintec/LaserLang">GitHub link</a> leads to a git repository, which hosts an interpreter for an esoteric language called Laser. An excerpt from the README paints it as an interesting challenge.</p>

<blockquote>
  <p>Like many 2-D languages, Laser has an instruction pointer that executes the one character instructions it encounters. The instruction pointer starts at the top left and initially points right. The pointer can wrap around the program and termination only occurs on error or the termination character #. The memory structure is a list of stacks. There are only two types in Laser: String and Number. Numbers are java Longs.</p>
</blockquote>

<p>This means I will have to think differently than in all the other cases, however this is a rather simple problem. My implementation was more or less a translation of a simple C factoring program to this language, adjusted for its constraints.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">i</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">j</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">"%d "</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This implementation, when translated to Laser, looks like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>UirrrrsUrD&gt;⌜%uruu⌜\
           U     pp
           P     UU
           P     wp
                 D
           #     w
                 U
                 v/
                 (
                 r
                 r
                 w
                 D
          \      &lt;
</code></pre></div></div>

<p>The program uses the initial (bottom) stack as the result stack. It’s implicitly printed out when the program finishes its execution. The whole code works as follows:</p>

<ol>
  <li>Create a new stack and set it as active (move from stack 0 to stack 1)</li>
  <li>Take first input arguments and push it on top of current stack (in the C implementation that’s <code class="language-plaintext highlighter-rouge">i</code>)</li>
  <li>Make 4 additional copies of that value</li>
  <li>Shift one copy to a new stack above the current one</li>
  <li>Set the new stack as active (move from stack 1 to stack 2)</li>
  <li>Make a copy of its only value (the input number)</li>
  <li>Set the stack below as active (move from stack 2 to stack 1)</li>
  <li>Set the execution direction to right.</li>
  <li>If the top value on the current stack (in the C implementation, that’s <code class="language-plaintext highlighter-rouge">j</code>) is equal to 0, change the direction of the instruction pointer to start moving down, otherwise keep it moving left
    <ul>
      <li>If the direction was changed, set the stack above the current one as active (move from stack 1 to stack 2)</li>
      <li>Pop currently-active stack, then the next active stacks (this destroys stacks 2 and 1)</li>
      <li>Finish execution of the program</li>
    </ul>
  </li>
  <li>If the execution direction was not changed, perform modulo of the 2nd top element by the 1st top element, and store the result on the stack</li>
  <li>Rotate the stack “up” (meaning the bottom element becomes the top)</li>
  <li>Duplicate the now-top element</li>
  <li>Rotate the stack “up” 2 times again</li>
  <li>If the now-top element (modulo result) is equal to 0, change direction to down, otherwise keep it as left</li>
  <li>The false branch is then also redirected down, such that it runs in parallel to the true branch</li>
  <li>Both branches pop the modulo result</li>
  <li>Both branches set the stack above as active (move from stack 1 to stack 2)</li>
  <li>Operation here depends on the modulo result
    <ul>
      <li>False branch pops the top item from the current stack</li>
      <li>True branch moves the top item down one stack (from stack 2 to stack 1)</li>
    </ul>
  </li>
  <li>True branch changes active stack to the stack below (from stack 2 to stack 1)</li>
  <li>True branch moves top item from the active stack down one stack (from stack 1 to stack 0) - effectively pushing it on top of the result stack</li>
  <li>True branch sets the stack above as active (from stack 1 to stack 2)</li>
  <li>Both branches are merged at this point</li>
  <li>The top value on the stack (<code class="language-plaintext highlighter-rouge">j</code> from C implementation) is decremented by 1</li>
  <li>It’s then duplicated twice</li>
  <li>Next, the top copy is shifted down one stack (from stack 2 to stack 1)</li>
  <li>The stack below is then set as active (from stack 2 to stack 1)</li>
  <li>The program then redirects the execution so that it returns to point 9</li>
</ol>

<p>When the program finishes execution, the result stack is typed out, resulting in the factors of given number being typed out in ascending order.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/lasers1-00.webp" alt="Some test cases" /></p>

<p>In the program above, you should notice that the program termination is separated by a blank space from popping the 2 stacks. That’s because initially there was a “print current stack” instruction in there, but due to a bug, the test cases didn’t accept its output. As the language types the current stack out implicitly when execution finishes, it’s not necessary anyway. After the code, I also put in 3 newlines, to make the remote server recognize the end of code properly.</p>

<p>The testing program, however, had an interesting bug, where using the stack print instruction caused the output to be echoed back to sender, which allowed for limited debugging of inputted code.</p>

<p>After my testing concluded, I sent the program for testing. Test case 8 took a little while, probably because it was a large number, but once I passed, I got the flag.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/lasers1-01.webp" alt="Testing" /></p>

<p>Flag:
<code class="language-plaintext highlighter-rouge">rgbCTF{l4s3rs_4r3_c00l_r1ght}</code></p>

<h3 id="laser-2---sorting-491-points">Laser 2 - Sorting (491 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/Quintec/LaserLang
Here's a harder Laser challenge. Given an input stack of numbers, sort them in descending order.

Input: 1 2 7 3 down the rockefeller street
Output: 7 3 2 1
</code></pre></div>  </div>
</blockquote>

<p>Like with previous challenge, we were also given an address to connect to using <code class="language-plaintext highlighter-rouge">netcat</code>, in order to input our code.</p>

<p>This challenge was much more difficult than previous one, as it basically required swapping elements, something Laser lacks built-in facilities for. The algorithm I devised worked more or less like so:</p>

<ol>
  <li>Push all inputs onto one stack</li>
  <li>Create another stack for sorted output</li>
  <li>Pick the smallest value from input stack, push it on the sorted stack, pop it from input stack</li>
  <li>If any numbers are remaining on the input stack, go to point 3</li>
  <li>Print out the output</li>
</ol>

<p>If implemented in C++, the program would look more or less like this:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;algorithm&gt;
#include &lt;string&gt;
#include &lt;stringstream&gt;
#include &lt;deque&gt;
#include &lt;iostream&gt;
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span><span class="p">[]</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">input</span><span class="p">,</span> <span class="n">sorted</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">ss</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">t</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">argc</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ss</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">ss</span> <span class="o">&gt;&gt;</span> <span class="n">t</span><span class="p">;</span>
        <span class="n">input</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="k">auto</span> <span class="n">minel</span> <span class="o">=</span> <span class="n">min_element</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">input</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
        <span class="n">sorted</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">*</span><span class="n">minel</span><span class="p">);</span>
        <span class="n">input</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">minel</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">sorted</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">sorted</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In Laser, the implementation looks like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>v          vdD     r&lt;      &lt;
                    p      U
\UI&gt;sUrDc)w&gt;D(⌝UrsUg⌟pwDdsu^
   p    vDpUUp&lt;
   "    c
   =    ⌞Pc(⌝p#
   ^"  p&lt;   &gt;p#
</code></pre></div></div>

<p>This is a lot to unwrap, so I’ll do it in 2 stages - a general overview of the program’s operation, and a detailed breakdown.</p>

<p>The program uses 3 stacks - the top one is the sorted stack, middle one is the input stack, and the bottom one is a counter stack (used to count loop iterations). The program works by essentially putting the current input stack size in the counter stack, top value from the input stack at the output stack, then it compares the top input value with top sorted value. If the input one is smaller, they are swapped. The value on the counter stack is then decremented. The compare-swap operation is repeated as many times, as there are elements in the input stack (including the shifted one). After one such cycle of operations, the sorted stack now has the smallest value from the input stack pushed to the top.</p>

<p>For inputs like <code class="language-plaintext highlighter-rouge">1 4 2 3</code>, the stacks would look like so after every cycle</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cycle = 0
input  [1 4 2 3]
sorted []

cycle = 1
input  [4 2 3]
sorted [1]

cycle = 2
input  [4 3]
sorted [2 1]

cycle = 3
input  [4]
sorted [3 2 1]

cycle = 4
input  []
sorted [4 3 2 1]
</code></pre></div></div>

<p>The sorted stack is set as active at the end of the program, which causes it to be printed out.</p>

<p>In greater detail, the program works as follows:</p>

<ol>
  <li>Reflect the execution such that it occurs 2 lines down</li>
  <li>Initialize a new stack above the current one (move from 0 to 1)</li>
  <li>Push all input arguments onto current stack</li>
  <li>Set execution direction to right</li>
  <li>Create a new stack above the current one, and push the current top value on the stack (first input) one stack up (from 1 to 2)</li>
  <li>Set the stack above (sorted) as the active one (move from 1 to 2)</li>
  <li>Duplicate the value on top of current stack</li>
  <li>Move down 1 stack (from 2 to 1 - input)</li>
  <li>Count the elements on the current stack and push the count on top</li>
  <li>Increment the top value (so that for n elements the compare-swap cycle is done <code class="language-plaintext highlighter-rouge">n</code> times, not <code class="language-plaintext highlighter-rouge">n-1</code> times)</li>
  <li>Move the top value (count) down 1 stack (from 1 to 0 - counter)</li>
  <li>Set execution direction to right</li>
  <li>Move down 1 stack (from 1 to 0 - counter)</li>
  <li>Decrements the top value by 1</li>
  <li>If the current top value (remaining compare-swap iteration count) is 0, change execution direction to down (jump to point 36), otherwise keep executing to the left.</li>
  <li>Move up 1 stack (from 0 to 1 - input)</li>
  <li>Duplicate the top value (next processed input)</li>
  <li>Move the new value up 1 stack (from 1 to 2 - sorted)</li>
  <li>Set the stack above as active (from 1 to 2 - sorted)</li>
  <li>Check if the 2nd top element is greater than the top element (if the currently-inspected element is smaller than already-sorted element)</li>
  <li>If that is not the case, change execution direction to up and pop the comparison result (then go to point 30)</li>
  <li>If it is, meaning we have to swap the two values, pop the comparison result</li>
  <li>Move the top element down one stack (from 2 to 1 - input)</li>
  <li>Set the stack below as active (from 2 to 1 - input)</li>
  <li>Rotate the stack down (place the top value at the bottom)</li>
  <li>Move the top value up one stack (from 1 to 2 - sorted) - the elements are now swapped</li>
  <li>Set execution direction to up</li>
  <li>Set the stack above as active (from 1 to 2 - sorted)</li>
  <li>Set the execution direction to left</li>
  <li>Set the execution direction to left</li>
  <li>Duplicate the top value</li>
  <li>Set the stack below as active (from 2 to 1 - input)</li>
  <li>Rotate the stack down (place the top element at the bottom)</li>
  <li>Set the execution direction to down then left</li>
  <li>Go to point 12</li>
  <li>Set the execution direction to left</li>
  <li>Pop the top value (counter) e from the current stack</li>
  <li>Set the stack 2 above as the current (from 0 to 2 - sorted)</li>
  <li>Pop the top value (duplicate of the just sorted value)</li>
  <li>Set the stack below as the active one (from 2 to 1)</li>
  <li>Set execution direction to down</li>
  <li>Count the input elements, if they’re 0, change execution direction to right (jump to point 47), otherwise keep going down</li>
  <li>Change execution direction to left and pop the top item (input count)</li>
  <li>Push = string on the stack, while changing execution direction to up</li>
  <li>Pop the top item (for debugging, this can be replaced with <code class="language-plaintext highlighter-rouge">o</code>, which prints the top stack item; the character is used to separate compare-swap cycles)</li>
  <li>Go to point 4</li>
  <li>Pop the entire stack (input), which sets the current stack to sorted</li>
  <li>Count the elements (this is used for debugging) and decrement the count</li>
  <li>In either case, pop the count, and stop the execution</li>
</ol>

<p>The output is sorted in descending order.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/lasers2-00.webp" alt="Some test cases" /></p>

<p>Using the bug I described above, I used to debug this program, as I had a glitch initially, where for some inputs the program didn’t sort properly. It got stuck on case 2, so I made it print the stack out when there was more than 1 input. This was removed for the final version. Again, at the end of the program, there were 3 empty lines.</p>

<p>After my testing concluded, I sent the program for testing. After ironing out the kinks, all tests passed, and I got the flag.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/lasers2-01.webp" alt="Testing" /></p>

<p>Flag:
<code class="language-plaintext highlighter-rouge">rgbCTF{1_f33l_y0ur_p41n_trust_m3}</code></p>

<h2 id="web">Web</h2>

<h3 id="tic-tac-toe-50-points">Tic-Tac-Toe (50 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <p><code class="language-plaintext highlighter-rouge">Hello there, I invite you to one of the largest online global events in history ... the Tic Tac Toe World Championships!</code></p>
</blockquote>

<p>We were also given a link to the application we were meant to exploit.</p>

<p>The challenge is a classic - a tic-tac-toe game. In order to obtain the flag, all you had to do was defeat the AI. I should mention that when I solved it, the challenge was broken, and any win counted as a loss, which got fixed after I solved the challenge. It did not, however, stop me.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/tictactoe-00.webp" alt="The web application" /></p>

<p>I decided that the best place to start was the JavaScript code powering the application. Unfortunately, it was heavily obfuscated, so analysis wasn’t easy. Using Firefox dev tools’ pretty print feature made it somewhat more readable, but it still couldn’t be analyzed in a nice manner.</p>

<p>While analyzing, however, I noticed a certain variable, which in my instance was called <code class="language-plaintext highlighter-rouge">_0x517520</code>, defined as <code class="language-plaintext highlighter-rouge">const</code>. It was an array of three-element arrays, and since it was a <code class="language-plaintext highlighter-rouge">const</code>, I could not change its value directly, but I knew I could change its contents. With a bit of inspect element and deduction, I reached the conclusion that it held the winning combinations. My first thought was to try and remove some of them, but that only caused the application to crash.</p>

<p>My next idea was inspired by Star Trek, specifically James T. Kirk’s approach to an unwinnable scenario simulation - I decided to change win conditions, and see what comes out.</p>

<p>I fired up the console, and punched the following snippet in:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">_0x517520</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="nx">_0x517520</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</code></pre></div></div>

<p>Then I placed my mark in the top-left corner. Sure enough, the application spilled out a base64-encoded string: <code class="language-plaintext highlighter-rouge">cmdiQ1RGe2g0aDRfajR2NDJjcjFwN19ldjNuNzJfQVIzX2MwMEx9</code>.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/tictactoe-01.webp" alt="I win!" /></p>

<p>After decoding it, I obtained the flag. Judging by its contents, I am pretty sure this was not the intended way of solving this challenge.</p>

<p>Flag:
<code class="language-plaintext highlighter-rouge">rgbCTF{h4h4_j4v42cr1p7_ev3n72_AR3_c00L}</code></p>

<h3 id="typeracer-119-points">Typeracer (119 points)</h3>

<blockquote>
  <p>Challenge description</p>

  <p><code class="language-plaintext highlighter-rouge">I AM SPEED! Beat me at TypeRacer and the flag is all yours!</code></p>
</blockquote>

<p>We were once again given a link to an application we were meant to defeat - a typeracer clone.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/typeracer-00.webp" alt="The web application" /></p>

<p>The way this application worked was rather simple. You press start, wait 5 seconds, and then a list of words appears in the top box. You are meant to type them in the order you can see them. If your typing speed is above certain (very high) threshold, the flag is revealed.</p>

<p>I’m a relatively fast typer (around 100-120 WPM touch-typing), so I tried the classic approach first, just to get a feel for the application. Obviously, I didn’t win. But it gave me an idea - only a robot can beat a robot.</p>

<p>I got to work trying to automate the typing. My first thought was to create a script, which automatically starts typing, once the words appear. The DOM has a useful feature for this - <a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver">MutationObservers</a>. You can attach an observer to an element, specify what kind of changes to look for, and it will automatically fire a callback you specify once the change occurs. So begins the adventure.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Get the field wherein the text will appear</span>
<span class="kd">var</span> <span class="nx">ttext</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="dl">'</span><span class="s1">card mt-0</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="dl">'</span><span class="s1">card-body</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>

<span class="c1">// Create an observer</span>
<span class="kd">var</span> <span class="nx">obs</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MutationObserver</span><span class="p">(</span><span class="nx">m</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Disconnect so it doesn't fire multiple times</span>
    <span class="nx">obs</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>

    <span class="c1">// Retrieve the text</span>
    <span class="kd">var</span> <span class="nx">txt</span> <span class="o">=</span> <span class="nx">ttext</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">txt</span><span class="p">);</span>

    <span class="c1">// Do work</span>
<span class="p">});</span>
<span class="nx">obs</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">ttext</span><span class="p">,</span> <span class="p">{</span> <span class="na">characterData</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">attributes</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">childList</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span> <span class="c1">// observe text changes</span>
</code></pre></div></div>

<p>But that didn’t work. A quick inspect element later, I figured out why. The text was appended as a collection of spans, so instead of watching for text changes, I had to watch for child changes.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span> <span class="nl">characterData</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">attributes</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">childList</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span>
</code></pre></div></div>

<p>Ok, so now I got the text (at the time it was incorrect, which I didn’t notice), I have to type it somehow. Since a typeracer is a typing speed challenge, I decided decided to look around how to simulate keyboard events using JavaScript. One Google later, I found <a href="https://stackoverflow.com/questions/596481/is-it-possible-to-simulate-key-press-events-programmatically">this StackOverflow thread</a>, and combined it with a set of <code class="language-plaintext highlighter-rouge">setTimeout()</code>-based delays, in order to send the characters in order. This, however, did not work! It turned out that for some reason, the application didn’t understand or purposefully rejected any keystrokes generated from within JS. I had to take another approach.</p>

<p>I had several options here, first one being using a web driver like Selenium. However, I didn’t want to download and install Selenium just for this challenge. I know I could achieve something similar using VBA macros in Microsoft Excel, in order to automate Internet Explorer interactions, but that seemed too crazy. Eventually it hit me, I could automate a keyboard using an external program.</p>

<p>In order to communicate with the program, I had to use WebSocket protocol, as that is the only protocol I can use directly in JavaScript without any weird proxies. Since C# is my primary language, I fired up Visual Studio, and created a new WindowsForms application.</p>

<p>In C#, there exists a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.sendkeys?view=netframework-4.7.2">class called SendKeys</a>, which allows you to send keystrokes to other applications. For diagnostic purposes, I gave the window a label, which would print out any received text. I then added a hosted WebSocket server to the application, using <a href="https://www.nuget.org/packages/WebSocketSharp-NonPreRelease/">WebSocketSharp</a> library. Finally, I made the server start when the window was loaded. The whole code-behind for the application looked like this:</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Forms</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp.Server</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">AutoSendKeys</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">Form1</span> <span class="p">:</span> <span class="n">Form</span>
    <span class="p">{</span>
        <span class="n">WebSocketServer</span> <span class="n">_ws</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">Form1</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span>

            <span class="k">this</span><span class="p">.</span><span class="n">_ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocketServer</span><span class="p">(</span><span class="n">IPAddress</span><span class="p">.</span><span class="n">Loopback</span><span class="p">,</span> <span class="m">5690</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="n">_ws</span><span class="p">.</span><span class="nf">AddWebSocketService</span><span class="p">(</span><span class="s">"/typer"</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">DeusEx</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">StartTyping</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">StartTyping</span><span class="p">(</span><span class="kt">string</span> <span class="n">s</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="k">new</span> <span class="nf">Action</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">label2</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">s</span><span class="p">));</span>
            <span class="n">_</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="nf">Run</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="n">SendKeys</span><span class="p">.</span><span class="nf">SendWait</span><span class="p">(</span><span class="n">s</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Form1_Load</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">_ws</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">DeusEx</span> <span class="p">:</span> <span class="n">WebSocketBehavior</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">Action</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">_callback</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">DeusEx</span><span class="p">(</span><span class="n">Action</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">ac</span><span class="p">)</span>
            <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">_callback</span> <span class="p">=</span> <span class="n">ac</span><span class="p">;</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnMessage</span><span class="p">(</span><span class="n">MessageEventArgs</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nf">_callback</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>I then had to make the JavaScript code send the string to my application. I added a WebSocket connection to the mutation observer.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">ttext</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="dl">'</span><span class="s1">card mt-0</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="dl">'</span><span class="s1">card-body</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">obs</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MutationObserver</span><span class="p">(</span><span class="nx">m</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">obs</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">txt</span> <span class="o">=</span> <span class="nx">ttext</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">txt</span><span class="p">);</span>

    <span class="c1">// Connect to our SendKeys app and tell it to type the string</span>
    <span class="kd">var</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="dl">"</span><span class="s2">ws://localhost:5690/typer</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">ws</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">open</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">txt</span><span class="p">);</span> <span class="nx">ws</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span> <span class="p">});</span>
<span class="p">});</span>
<span class="nx">obs</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">ttext</span><span class="p">,</span> <span class="p">{</span> <span class="na">characterData</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">attributes</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">childList</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
</code></pre></div></div>

<p>I started my typer application, ran the snippet on the typeracer application, pressed start, and waited. When the typing began, it was all wrong.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/typeracer-01.webp" alt="The text is all wrong" /></p>

<p>Cursory analysis revealed the words were not in the correct order. But how could that be? I decided to inspect the upper box again, and found a curiosity. The elements were placed out-of-order, and for display purposes, were reordered using a CSS <code class="language-plaintext highlighter-rouge">order</code> rule. I had to modify the text retrieval part of my script to account for that.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">ttext</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="dl">'</span><span class="s1">card mt-0</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="dl">'</span><span class="s1">card-body</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">obs</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MutationObserver</span><span class="p">(</span><span class="nx">m</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">obs</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>

    <span class="c1">// Get the child spans and order them</span>
    <span class="kd">var</span> <span class="nx">els</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ttext</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="dl">'</span><span class="s1">span</span><span class="dl">'</span><span class="p">));</span>
    <span class="kd">var</span> <span class="nx">txt</span> <span class="o">=</span> <span class="nx">els</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">a</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">order</span> <span class="o">-</span> <span class="nx">b</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">order</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">.</span><span class="nx">textContent</span><span class="p">.</span><span class="nx">trim</span><span class="p">()).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> </span><span class="dl">"</span><span class="p">);</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">txt</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="dl">"</span><span class="s2">ws://localhost:5690/typer</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">ws</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">open</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">txt</span><span class="p">);</span> <span class="nx">ws</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span> <span class="p">});</span>
<span class="p">});</span>
<span class="nx">obs</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">ttext</span><span class="p">,</span> <span class="p">{</span> <span class="na">characterData</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">attributes</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">childList</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
</code></pre></div></div>

<p>I reran the snippet, this time with a much better result. The application spilled out a base64-encoded string: <code class="language-plaintext highlighter-rouge">cmdiQ1RGe3c0MHdfajR2NDJjcjFwN18xMl80bm4weTFuZ30=</code>.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/typeracer-02.webp" alt="Victory!" /></p>

<p>Decoding the string yielded the flag. End of story</p>

<p>Flag:
<code class="language-plaintext highlighter-rouge">rgbCTF{w40w_j4v42cr1p7_12_4nn0y1ng}</code></p>

<h4 id="bonus">Bonus</h4>

<p>I mentioned that one way of beating this challenge is automating Internet Explorer via VBA Macros in Excel (which is a truly wonderful tool). If you read this far, you’re probably interested in learning how to do this. As a starting point, I recommend <a href="https://www.automateexcel.com/vba/automate-internet-explorer-ie-using/">this article on the subject</a>.</p>

<p>One prerequisite for this is enabling the developer tab in Excel. One can do this, by going to File &gt; Options &gt; Customize Ribbon, and checking Developer in the right pane.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/typeracer-03.webp" alt="Enabling Developer tab in Excel" /></p>

<p>That will enable the tab, and access to Visual Basic editor. Before we do that, however, we have to insert a button that will trigger this chain of unfortunate events using the Insert dropdown. In there, select a Button under Form Controls, draw it on the workbook, and when asked about the assigned macro, press New.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/typeracer-04.webp" alt="Enabling Developer tab in Excel" /></p>

<p>This will open the Visual Basic editor, with autogenerated method signature. Into that method, paste the following code. You need to add a COM reference to <code class="language-plaintext highlighter-rouge">Microsoft Internet Controls</code>, <code class="language-plaintext highlighter-rouge">Microsoft HTML Object Library</code>, and <code class="language-plaintext highlighter-rouge">Microsoft XML, v6.0</code> using Tools &gt; References.</p>

<p><img src="/assets/images/posts/rgbctf-2020-07-14/typeracer-05.webp" alt="Adding references" />
<img src="/assets/images/posts/rgbctf-2020-07-14/typeracer-06.webp" alt="Adding references" /></p>

<p>Then it’s a matter of committing some crimes against humanity to get the thing working. You can find the incantation to summon dark forces below.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Public</span> <span class="k">Declare</span> <span class="n">PtrSafe</span> <span class="k">Function</span> <span class="nf">SetForegroundWindow</span> <span class="k">Lib</span> <span class="s">"user32"</span> <span class="p">(</span><span class="k">ByVal</span> <span class="n">HWND</span> <span class="ow">As</span> <span class="n">LongPtr</span><span class="p">)</span> <span class="ow">As</span> <span class="n">LongPtr</span>

<span class="k">Sub</span> <span class="nf">CommitTerribleSins</span><span class="p">()</span>
    <span class="c1">' As VBA does not support inline initialization, declare variables first</span>
    <span class="k">Dim</span> <span class="nv">IE</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">InternetExplorer</span>

    <span class="c1">' Begin by creating an Internet Explorer handle and making the window visible</span>
    <span class="c1">'Set IE = CreateObject("InternetExplorer.Application")</span>
    <span class="n">IE</span><span class="p">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="k">True</span>
    <span class="n">IE</span><span class="p">.</span><span class="n">Navigate</span> <span class="s">"http://challenge.rgbsec.xyz:8973/"</span>

    <span class="c1">' Set IE as foreground</span>
    <span class="k">Dim</span> <span class="nv">HWND</span>
    <span class="n">HWND</span> <span class="o">=</span> <span class="n">IE</span><span class="p">.</span><span class="n">HWND</span>
    <span class="n">SetForegroundWindow</span> <span class="n">HWND</span>

    <span class="c1">' Wait for the page to load</span>
    <span class="c1">' Navigation may not be instant, so first wait until ready expires, then</span>
    <span class="c1">' wait until it's ready</span>
    <span class="k">Do</span> <span class="k">While</span> <span class="n">IE</span><span class="p">.</span><span class="n">ReadyState</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">DoEvents</span>
    <span class="k">Loop</span>
    <span class="k">Do</span> <span class="n">Until</span> <span class="n">IE</span><span class="p">.</span><span class="n">ReadyState</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">DoEvents</span>
    <span class="k">Loop</span>
    <span class="c1">' I CBA to do this using events</span>

    <span class="c1">' Add observer</span>
    <span class="n">IE</span><span class="p">.</span><span class="n">document</span><span class="p">.</span><span class="n">parentWindow</span><span class="p">.</span><span class="n">execScript</span> <span class="n">code</span><span class="p">:</span><span class="o">=</span><span class="s">"var ttext=document.getElementsByClassName('card mt-0')[0].getElementsByClassName('card-body')[0],obs=new MutationObserver(function(){obs.disconnect();var t=[].slice.call(ttext.getElementsByTagName('span')).sort(function(t,e){return t.style.order-e.style.order}).map(function(t){return t.textContent.trim()}).join(' ');console.log(t),document.location.hash=t});obs.observe(ttext,{characterData:!1,attributes:!1,childList:!0});"</span>

    <span class="c1">' Trigger</span>
    <span class="k">Dim</span> <span class="nv">activator</span>
    <span class="k">Set</span> <span class="n">activator</span> <span class="o">=</span> <span class="n">IE</span><span class="p">.</span><span class="n">document</span><span class="p">.</span><span class="n">getElementsByClassName</span><span class="p">(</span><span class="s">"btn-outline-dark"</span><span class="p">)</span>
    <span class="n">activator</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Click</span>

    <span class="c1">' Target</span>
    <span class="k">Dim</span> <span class="nv">target</span>
    <span class="k">Set</span> <span class="n">target</span> <span class="o">=</span> <span class="n">IE</span><span class="p">.</span><span class="n">document</span><span class="p">.</span><span class="n">getElementsByTagName</span><span class="p">(</span><span class="s">"textarea"</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">' Continue doing events</span>
    <span class="k">Do</span> <span class="n">Until</span> <span class="n">InStr</span><span class="p">(</span><span class="n">IE</span><span class="p">.</span><span class="n">LocationURL</span><span class="p">,</span> <span class="s">"#"</span><span class="p">)</span>
        <span class="n">DoEvents</span>
    <span class="k">Loop</span>

    <span class="c1">' Extract the fragment</span>
    <span class="k">Dim</span> <span class="nv">fragment</span>
    <span class="k">Dim</span> <span class="nv">words</span>
    <span class="n">fragment</span> <span class="o">=</span> <span class="n">IE</span><span class="p">.</span><span class="n">LocationURL</span>
    <span class="n">fragment</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">fragment</span><span class="p">,</span> <span class="s">"#"</span><span class="p">)</span>
    <span class="n">fragment</span> <span class="o">=</span> <span class="n">fragment</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">fragment</span><span class="p">,</span> <span class="s">" "</span><span class="p">)</span>

    <span class="c1">' Counter</span>
    <span class="k">Dim</span> <span class="nv">counter</span> <span class="ow">As</span> <span class="kt">Integer</span>
    <span class="k">Dim</span> <span class="nv">maxcount</span> <span class="ow">As</span> <span class="kt">Integer</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">maxcount</span> <span class="o">=</span> <span class="n">UBound</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">-</span> <span class="n">LBound</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="c1">' Yeah, arbitrary indexing; also don't add 1</span>

    <span class="c1">' Set the control value</span>
    <span class="n">Cells</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="n">fragment</span>

    <span class="c1">' Type it out</span>
    <span class="n">target</span><span class="p">.</span><span class="n">Focus</span>
    <span class="k">For</span> <span class="k">Each</span> <span class="n">word</span> <span class="ow">In</span> <span class="n">words</span>
        <span class="k">If</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">maxcount</span> <span class="k">Then</span>
            <span class="n">Application</span><span class="p">.</span><span class="n">SendKeys</span> <span class="n">word</span><span class="p">,</span> <span class="k">True</span>
        <span class="k">Else</span>
            <span class="n">Application</span><span class="p">.</span><span class="n">SendKeys</span> <span class="n">word</span> <span class="o">&amp;</span> <span class="s">" "</span><span class="p">,</span> <span class="k">True</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">Next</span>

    <span class="c1">' Wait for flag to appear</span>
    <span class="n">Cells</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="s">"Please wait..."</span>
    <span class="n">Application</span><span class="p">.</span><span class="n">Wait</span> <span class="n">Now</span> <span class="o">+</span> <span class="n">TimeValue</span><span class="p">(</span><span class="s">"00:00:03"</span><span class="p">)</span>

    <span class="c1">' Extract flag</span>
    <span class="k">Dim</span> <span class="nv">flag</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">IE</span><span class="p">.</span><span class="n">document</span><span class="p">.</span><span class="n">body</span><span class="p">.</span><span class="n">textContent</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">Split</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="s">":"</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">LTrim</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
    <span class="c1">'Cells(13, 3).Value = flag</span>

    <span class="c1">' Decode flag</span>
    <span class="c1">' ...using Microsoft XML</span>
    <span class="k">Dim</span> <span class="nv">objXML</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">MSXML2</span><span class="p">.</span><span class="n">DOMDocument60</span>
    <span class="k">Dim</span> <span class="nv">objNode</span> <span class="ow">As</span> <span class="n">MSXML2</span><span class="p">.</span><span class="n">IXMLDOMElement</span>
    <span class="k">Set</span> <span class="n">objNode</span> <span class="o">=</span> <span class="n">objXML</span><span class="p">.</span><span class="n">createElement</span><span class="p">(</span><span class="s">"b64"</span><span class="p">)</span>
    <span class="n">objNode</span><span class="p">.</span><span class="n">DataType</span> <span class="o">=</span> <span class="s">"bin.base64"</span>
    <span class="n">objNode</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">flag</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">StrConv</span><span class="p">(</span><span class="n">objNode</span><span class="p">.</span><span class="n">nodeTypedValue</span><span class="p">,</span> <span class="n">vbUnicode</span><span class="p">)</span>
    <span class="k">Set</span> <span class="n">objNode</span> <span class="o">=</span> <span class="k">Nothing</span>
    <span class="k">Set</span> <span class="n">objXML</span> <span class="o">=</span> <span class="k">Nothing</span>

    <span class="c1">' Set flag</span>
    <span class="n">Cells</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="n">flag</span>

    <span class="c1">' Close IE</span>
    <span class="n">IE</span><span class="p">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="k">False</span>
    <span class="k">Set</span> <span class="n">IE</span> <span class="o">=</span> <span class="k">Nothing</span>

    <span class="c1">' You are now going straight to hell. You are also on every list imaginable. ggwp no re</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<p>And with that, we have a fully-functional, fully-automated CTF solver, all in Microsoft Excel. Microsoft Excel can do everything. It can replace you. Do not joke about Excel. It will come for you.</p>

<!-- Courtesy of embedresponsively.com //-->

<div class="responsive-video-container">
    <iframe src="https://www.youtube-nocookie.com/embed/XCZcIeowsrA" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
  </div>

<p>The result of this unholy union can be <a href="/assets/attachments/posts/rgbctf-2020-07-14/typeracer.xlsm">downloaded here</a>.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#en-us" class="page__taxonomy-item" rel="tag">en-us</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#writeup" class="page__taxonomy-item" rel="tag">writeup</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-07-14T00:00:00+08:00">July 14, 2020</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=StillAzureH&text=rgbCTF+2020+Writeup+-+Part+2%20https%3A%2F%2Fstillu.cc%2Fwriteup%2Frgbctf-2020-part-2" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fstillu.cc%2Fwriteup%2Frgbctf-2020-part-2" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fstillu.cc%2Fwriteup%2Frgbctf-2020-part-2" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/writeup/rgbctf-2020-part-1" class="pagination--pager" title="rgbCTF 2020 Writeup - Part 1
">Previous</a>
    
    
      <a href="/infosec/2020/07/19/closer-look-at-capa/" class="pagination--pager" title="A Closer Look at CAPA
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Leave a comment</h4>
      <section id="utterances-comments"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ida-tips/2022/01/22/saved-desktops-across-32bit-64bit/" rel="permalink">IDA Trickeries #1: Using Saved Desktop Across IDAs
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2022-01-22T00:00:00+08:00">January 22, 2022</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">So like… who at Hex-rays implemented this?
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/threat-spotlight/2021/11/13/domain-fronting-fastly/" rel="permalink">Threat Spotlight - Domain Fronting
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-11-13T00:00:00+08:00">November 13, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Fast(ly) but deadly.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/personal/2021/10/29/barinsta-and-facebook/" rel="permalink">Facebook, Monopoly, and Barinsta
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-10-29T00:00:00+08:00">October 29, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Facebook and its anti-competitive strategy.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/personal/2021/07/12/lockdown-taiwan-2021/" rel="permalink">Lockdown, Taiwan, 2021
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2021-07-12T00:00:00+08:00">July 12, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Impact of lockdown in Taiwan and my personal life.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Still Hsu. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-N6FGTZBMTZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-N6FGTZBMTZ', { 'anonymize_ip': false});
</script>






    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'Still34/landing');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('theme', 'github-dark');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  





  </body>
</html>
